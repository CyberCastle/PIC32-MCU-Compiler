2012-12-03  Julian Brown  <julian@codesourcery.com>

	Issue #14123

	gas/testsuite/
	* gas/all/sleb128-2.d: Don't require sections to be padded with
	zeros.
	* gas/all/sleb128-3.d: Likewise.
	* gas/all/sleb128-4.d: Likewise.
	* gas/all/sleb128-5.d: Likewise.
	* gas/all/sleb128-7.d: Likewise.
	* gas/all/gas.exp: Only run sleb128-6 on MIPS.
	
2012-11-29  Catherine Moore  <clm@codesourcery.com>

	gas/
	* dw2gencfi.c (output_compact_unwind_data):  Remove
	special processing for the compact personality routines.

2012-11-29  Julian Brown  <julian@codesourcery.com>

	Issue #14086

	Backport from FSF mainline:

	gas/
	* config/tc-arm.c (md_apply_fix): Fix conversion of BL to BLX for
	local targets in Thumb mode.

	gas/testsuite/
	* gas/arm/bl-local-2.s: New test.
	* gas/arm/bl-local-2.d: New.

2012-11-28  Julian Brown  <julian@codesourcery.com>

	Issue #14123

	gas/
	* read.c (convert_to_bignum): Add sign parameter. Use it
	instead of X_unsigned to determine sign of resulting bignum.
	(emit_expr): Pass extra argument to convert_to_bignum.
	(emit_leb128_expr): Use X_extrabit instead of X_unsigned. Pass
	X_extrabit to convert_to_bignum.
	(parse_bitfield_cons): Set X_extrabit.
	* expr.c (make_expr_symbol, expr_build_uconstant, operand):
	Initialise X_extrabit field as appropriate.
	(add_to_result): New.
	(subtract_from_result): New.
	(expr): Use above.
	* expr.h (expressionS): Add X_extrabit field.

	gas/testsuite/
	* gas/all/sleb128-2.s: New test.
	* gas/all/sleb128-3.s: Likewise.
	* gas/all/sleb128-4.s: Likewise.
	* gas/all/sleb128-5.s: Likewise.
	* gas/all/sleb128-6.s: Likewise.
	* gas/all/sleb128-7.s: Likewise.
	* gas/all/sleb128-2.d: New.
	* gas/all/sleb128-3.d: New.
	* gas/all/sleb123-4.d: New.
	* gas/all/sleb123-5.d: New.
	* gas/all/sleb123-6.d: New.
	* gas/all/sleb123-7.d: New.
	* gas/all/gas.exp (sleb128-2, sleb128-3, sleb128-4, sleb128-5)
	(sleb128-6, sleb128-7): Run new tests.

2012-11-13  Meador Inge  <meadori@codesourcery.com>

	issue13979

	bfd/
	* elflink.c (bfd_elf_gc_sections): Skip non-ELF BFDs when parsing
	EH frame sections.

2012-10-31  Yao Qi  <yao@codesourcery.com>

	Backport from upstreams:

	bfd/
	2012-10-30  Yao Qi  <yao@codesourcery.com>
		    H.J. Lu  <hongjiu.lu@intel.com>

	* configure.in: Set CORE_HEADER to hosts/x86-64linux.h for
	'i[3-7]86-*-linux-*' if x86_64-*linux is enabled.
	* configure: Regenerated.

	* elf64-x86-64.c (elf_x86_64_write_core_note): Replace type
	'prpsinfo_t' and 'prstatus_t' with 'prpsinfo64_t' and
	'prstatus64_t' respectively.

	* hosts/x86-64linux.h (a8_uint64_t): New.
	(user_regsx32_struct): Renamed to ...
	(user_regs64_struct): This.  Replace uint64_t with a8_uint64_t.
	(elf_gregx32_t): Renamed to ...
	(elf_greg64_t): This.  Replace uint64_t with a8_uint64_t.
	(ELF_NGREGX32): Removed.
	(ELF_NGREG64): New.
	(elf_gregx32_t): Removed.
	(elf_greg64_t): New.
	(struct prstatus64_timeval): New.
	(elf_prstatusx32): Replace elf_gregsetx32_t with elf_gregset64_t.
	(elf_prstatus64): New.
	(elf_prpsinfo64): New.
	(prstatus64_t, prpsinfo64_t): New typedef.

	bfd/
	2012-10-30  H.J. Lu  <hongjiu.lu@intel.com>

	* configure.in: Also handle --enable-64-bit-bfd when setting
	(CORE_HEADER for 'i[3-7]86-*-linux-*'.

2012-10-24  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #13983

	Backport 622be081292dba7cfd1a1d6182e3cefe10ab326f from upstream:

	binutils/testsuite/
	2012-10-24  H.J. Lu  <hongjiu.lu@intel.com>

	* binutils-all/ar.exp (bfdtest1): Remove findfile.

2012-10-23  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13942
	Issue #13959
	* release-notes-csl.xml (Assembler bug fixes): New.

2012-10-23  Chao-ying Fu  <fu@mips.com>

	Issue #13959

	gas/
	* config/tc-mips.c (append_insn): Set fx_no_overflow for 16-bit
	microMIPS branch relocations.

	gas/testsuite/
	* gas/mips/micromips-b16.d: New test.
	* gas/mips/micromips-b16.s: New test source.
	* gas/mips/mips.exp: Run the new test.

2012-10-23  Maciej W. Rozycki  <macro@codesourcery.com>
            Chao-ying Fu  <fu@mips.com>

	Issue #13942

	gas/
	* config/tc-mips.c (is_delay_slot_valid): Don't accept macros
	in 16-bit delay slots.
	(macro_build_jalr): Emit 32-bit JALR if placed in a 32-bit delay
	slot.
	(macro) <M_JAL_2>: Likewise

	gas/testsuite/
	* gas/mips/micromips-branch-delay.l: Update messages for 16-bit
	delay slot changes.
	* gas/mips/micromips-warn-branch-delay.d: New test.
	* gas/mips/micromips-warn-branch-delay.l: Stderr output for the
	new test.
	* gas/mips/micromips-warn-branch-delay-1.d: New test.
	* gas/mips/micromips-warn-branch-delay.s: New test source.
	* gas/mips/micromips-warn-branch-delay-1.s: New test source.
	* gas/mips/mips.exp: Run the new tests.

2012-10-23  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_ip) <'u'>: Only accept O_subtract and
	in-range O_constant expressions.

	gas/testsuite/
	* gas/mips/lui.d: New test.
	* gas/mips/micromips@lui.d: New test.
	* gas/mips/lui-1.l: New list test.
	* gas/mips/lui-2.l: New list test.
	* gas/mips/lui.s: New test source.
	* gas/mips/lui-1.s: New test source.
	* gas/mips/lui-2.s: New test source.
	* gas/mips/mips.exp: Run the new tests.

2012-10-22  Meador Inge  <meadori@codesourcery.com>

	Backport from FSF:

	bfd/
	2012-10-13  H.J. Lu  <hongjiu.lu@intel.com>

	* Makefile.am (LIBDL): Replace -ldl with @lt_cv_dlopen_libs@.
	* configure.in (lt_cv_dlopen_libs): AC_SUBST.
	* Makefile.in: Regenerated.
	* configure: Likewise.

2012-10-22  Meador Inge  <meadori@codesourcery.com>

	Revert:

	2012-09-26  Meador Inge  <meadori@codesourcery.com>

	bfd/
	* Makefile.am (LIBDL): Use @plugin_libs@.
	* Makefile.in: Regenerated.
	* doc/Makefile.in: Likewise.
	* configure.in (plugin_libs): New variable.
	* configure: Regenerated.

2012-10-08  Joe Seymour  <jseymour@codesourcery.com>

	Backport from upstream:

	2012-10-08  Joe Seymour  <jseymour@codesourcery.com>

	* ld-scripts/sane1.d: Sort output from nm. Allow for other symbols in
	output.

2012-09-26  Meador Inge  <meadori@codesourcery.com>

	bfd/
	* Makefile.am (LIBDL): Use @plugin_libs@.
	* Makefile.in: Regenerated.
	* doc/Makefile.in: Likewise.
	* configure.in (plugin_libs): New variable.
	* configure: Regenerated.

2012-09-26  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #13896

	* gas/testsuite/gas/mips/mips.exp (mips32-dsp, mips32-dspr2, mcu):
	Tag as not suitable for XLP.

2012-09-20  Maciej W. Rozycki  <macro@codesourcery.com>

	opcodes/
	* micromips-opc.c (micromips_opcodes): Correct register access
	mask for "sbe", "she", "swe", "swle" and "swre".

2012-09-19  Maciej W. Rozycki  <macro@codesourcery.com>

	opcodes/
	* mips-opc.c (mips_builtin_opcodes): Correct register access
	mask for "sbe", "she", "swe", "swle" and "swre".

	* release-notes-csl.xml (EVA instruction assembler bug fix): New.

2012-09-18  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13735
	gas/testsuite/
	* gas/mips/hilo-diff-eb.d: New test.
	* gas/mips/hilo-diff-eb-n32.d: New test.
	* gas/mips/hilo-diff-eb-n64.d: New test.
	* gas/mips/hilo-diff-el.d: New test.
	* gas/mips/hilo-diff-el-n32.d: New test.
	* gas/mips/hilo-diff-el-n64.d: New test.
	* gas/mips/mips16@hilo-diff-eb.d: New test.
	* gas/mips/mips16@hilo-diff-eb-n32.d: New test.
	* gas/mips/mips16@hilo-diff-eb-n64.d: New test.
	* gas/mips/mips16@hilo-diff-el.d: New test.
	* gas/mips/mips16@hilo-diff-el-n32.d: New test.
	* gas/mips/mips16@hilo-diff-el-n64.d: New test.
	* gas/mips/micromips@hilo-diff-eb.d: New test.
	* gas/mips/micromips@hilo-diff-eb-n32.d: New test.
	* gas/mips/micromips@hilo-diff-eb-n64.d: New test.
	* gas/mips/micromips@hilo-diff-el.d: New test.
	* gas/mips/micromips@hilo-diff-el-n32.d: New test.
	* gas/mips/micromips@hilo-diff-el-n64.d: New test.
	* gas/mips/hilo-diff.s: New test source.
	* gas/mips/mips.exp: Run the new tests.

2012-09-18  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13735
	gas/
	* config/tc-mips.c (md_apply_fix): Complain about missed fixups.

2012-09-18  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13735
	gas/
	* config/tc-mips.c (append_insn) <BFD_RELOC_MIPS_JMP>: Don't
	mark as incomplete for constant expressions.
	<BFD_RELOC_MIPS16_JMP>: Likewise.

2012-09-18  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13735
	gas/
	* gas/config/tc-mips.c (md_apply_fix)
	<BFD_RELOC_HI16_S, BFD_RELOC_MIPS16_HI16_S,
	BFD_RELOC_MICROMIPS_HI16_S>: Handle completed fixups.
	<BFD_RELOC_LO16, BFD_RELOC_MIPS16_LO16, BFD_RELOC_MICROMIPS_LO16>:
	Remove embedded PIC checks, correct the handling of completed
	MIPS16 fixups.

	* release-notes-csl.xml
	(Assembler %hi and %lo operator bug fixes): New.

2012-09-18  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13735

	gas/
	* config/tc-mips.c (md_assemble): Add a call to mips_mark_labels.

	gas/testsuite/
	* gas/mips/branch-swap-2.s: Make sure the ISA bit is clear in
	the label used for calculation.

2012-09-13  Catherine Moore  <clm@codesourcery.com>

	gas/
	* dw2gencif.h (CFI_epilogue_begin): Rename from CFI_prologue_end.
	* dw2gencfi.c (cfi_pseudo_table): Rename cfi_prologue_end to
	cfi_epilogue_begin.
	(dot_cfi): Likewise.
	(output_cfi_insn): Likewise.
	(select_cie_for_fde): Likewise.
	* config/tc-mips.c (mips_cfi_endproc): Rename CFI_prologue_end
	to CFI_epilogue_begin.  Return when encountering unrecognized
	CFI insns.
	* doc/as.texinfo (.cfi_epilogue_begin): Document.

2012-09-12  Thomas Schwinge  <thomas@codesourcery.com>

	* gas/testsuite/gas/mips/mips.exp: Invoke mips_arch_create for
	xlp.

2012-09-12  Iain Sandoe  <iain@codesoucery.com>

	Revert r385120 & r385139.

2012-09-06  Chao-ying Fu  <fu@mips.com>
            Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13869

	opcodes/
	* micromips-opc.c (micromips_opcodes): Correct the encoding of
	the "swxc1" instruction.

	gas/testsuite/
	* gas/mips/micromips.d: Correct the disassembly of SWXC1.
	* gas/mips/micromips-trap.d: Likewise.
	* gas/mips/micromips-insn32.d: Likewise.
	* gas/mips/micromips-noinsn32.d: Likewise.
	* gas/mips/micromips@24k-triple-stores-1.d: Likewise.
	* gas/mips/micromips@mips4-fp.d: Likewise.

	* release-notes-csl.xml
	(microMIPS SWXC1 instruction encoding bug fix): New

2012-09-05  Maciej W. Rozycki  <macro@codesourcery.com>

	* release-notes-csl.xml: Add missing newline.

2012-09-04  Julian Brown  <julian@codesourcery.com>

	gas/
	* doc/as.texinfo (.cfi_prologue_end): Document.
	* config/tc-mips.c (mips_cfi_endproc): Handle .cfi_prologue_end.
	* dw2gencfi.c (cfi_pseudo_table): Add cfi_prologue_end.
	(dot_cfi): Handle CFI_prologue_end.
	(output_cfi_insn): (Null) output CFI_prologue_end.
	(select_cie_for_fde): Ignore CFI_prologue_end.
	(cfi_pseudo_table): Add .cfi_prologue_end (dummy).
	* dw2gencfi.h (CFI_prologue_end): Define.

2012-09-04  Thomas Schwinge  <thomas@codesourcery.com>

	* gas/config/tc-mips.c (mips_ip) <'#'>: Use correct mask value in
	the non-microMIPS case.

2012-09-03  Iain Sandoe  <iain@codesoucery.com>

	* gas/config/tc-mips.c (mips_cpu_info): Adjust case of XLP/R comments.
	Remove redundant XLP definition.
	* include/opcode/mips.h (cpu_is_member): Handle XLP.

2012-08-31  Iain Sandoe  <iain@codesoucery.com>

	* ld/testsuite/ld-gc/dummy.c: Add missed commit.

2012-08-31  Iain Sandoe  <iain@codesoucery.com>

	* ld/testsuite/lib/ld-lib.exp (run_dump_test): Allow test code to
	be 'c'.  Invoke $CC to compile it.
	* ld/testsuite/ld-gc/dummy.c: New empty file.
	* ld/testsuite/ld-gc/pr11218.d: Use a 'c' dummy file for the test.
	* ld/testsuite/ld-gc/pr13683.d: Likewise.
	* ld/testsuite/ld-gc/pr14265.d: Likewise.

2012-08-31  Iain Sandoe  <iain@codesoucery.com>

	* ld/testsuite/ld-elf/indirect.exp: Provide target-specific cflags.
	Skip the tests for targets that cannot produce a shared library.
	Use cflags for compiles and also pass to build tests.

2012-08-31  Iain Sandoe  <iain@codesoucery.com>

	* bfd/section.c (sec_info_type): Rename ELF_INFO_TYPE_EH_FRAME_ENTRY
	to SEC_INFO_TYPE_EH_FRAME_ENTRY.
	* bfd/bfd-in2.h: Regenerate.
	* bfd/elf-eh-frame.c (_bfd_elf_parse_eh_frame_entry): Use renamed.
	(_bfd_elf_write_section_eh_frame_entry): Likewise.
	* bfd/elflink.c (elf_link_input_bfd): Likewise.

2012-08-31  Iain Sandoe  <iain@codesoucery.com>

	Merged from upstream binutils 2.23.51-20120829.

	* release-notes-csl.xml: New note.

2012-08-15  Meador Inge  <meadori@codesourcery.com>

	CB-1354

	* bfd/elf-eh-frame.c (_bfd_elf_maybe_strip_eh_frame_hdr): Look for
	'.eh_frame_entry' sections if dealing with a type 2 EH frame header.

2012-07-27  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13685

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Fix the handling
	of protected symbols.

	* release-notes-csl.xml (Linker assertion failure bug fix): New.

2012-07-26  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13581
	Issue #13709

	ld/
	* ld/emultempl/beos.em (gld_${EMULATION_NAME}_set_symbols):
	Update call to exp_assign.
	* ld/emultempl/pe.em ((gld_${EMULATION_NAME}_set_symbols):
	Likewise.
	* ld/emultempl/pep.em (gld_${EMULATION_NAME}_set_symbols):
	Likewise.
	* ld/emultempl/spuelf.em (spu_place_special_section): Likewise.
	* ld/emultempl/xtensaelf.em (ld_xtensa_insert_page_offsets):
	Likewise.

2012-07-12  Thomas Schwinge  <thomas@codesourcery.com>
	    Maxim Kuvyrkov  <maxim@codesourcery.com>
	    NetLogic

	NetLogic's XLP support patch, based on our repository's r343556,
	r345131, r345132, r350550.  Pushing this upstream should be
	NetLogic's duty.

	* include/opcode/mips.h <microMIPS>: Describe '#' instead of 'B'
	for 10-bit syscall/wait/breakpoint function code.
	* gas/config/tc-mips.c (validate_micromips_insn): Change
	accordingly.
	(mips_ip) <'B'>: Only handle non-microMIPS 20-bit case.
	(mips_ip) <'#'>: Handle microMIPS 10-bit case.
	* opcodes/micromips-opc.c (mips_opcodes): Change sdbbp, syscall,
	wait accordingly.
	* opcodes/mips-dis.c (print_insn_args) <'#'>: Handle case.
	(print_insn_micromips): Change accordingly.
	* bfd/aoutx.h: Update for XLP.
	* bfd/archures.c: Likewise.
	* bfd/cpu-mips.c: Likewise.
	* bfd/elfxx-mips.c: Likewise.
	* binutils/readelf.c: Likewise.
	* gas/config/tc-mips.c: Likewise.
	* gas/doc/c-mips.texi: Likewise.
	* include/elf/mips.h: Likewise.
	* include/opcode/mips.h: Likewise.
	* opcodes/mips-dis.c: Likewise.
	* opcodes/mips-opc.c: Likewise.
	* bfd/bfd-in2.h: Regenerate.

2012-07-10  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13562

	gas/
	* config/tc-mips.c (append_insn): Also handle moving delay-slot
	instruction across frags for fixed branches.

	gas/testsuite/
	* gas/mips/branch-swap-2.l: New list test.
	* gas/mips/branch-swap-2.s: New test source.
	* gas/mips/mips.exp: Run the new test.

	* release-notes-csl.xml (Assembler internal error bug fix): New.

2012-07-06  Andrew Stubbs  <ams@codesourcery.com>

	* bfd/elflink.c (elf_link_add_object_symbols): Initialize orig_sec.

2012-07-05  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13581

	ld/
	* emulparams/elf32bmip.sh: Make _gp hidden.
	* emulparams/elf32bmipn32-defs.sh: Likewise.
	* emulparams/elf32mipswindiss.sh: Likewise.
	* ld/scripttempl/mips.sc: Likewise.

	ld/testsuite/
	* ld-mips-elf/rel32-o32.d: Adjust section VMAs after the removal
	of _gp from the global scope.

	* release-notes-csl.xml
	(Linker _gp special symbol ABI conformance bug fix): New.

2012-07-05  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13581

	bfd/
	* elflink.c (bfd_elf_record_link_assignment): Remove --defsym
	symbols special case.

	ld/
	* ldexp.h (etree_union): Add defsym member to the assign member
	structure.
	(exp_assign): Add hidden argument to prototype.
	* ldexp.c (exp_fold_tree_1): Use the defsym member to handle
	--defsym symbols.
	(exp_assop): Add defsym argument, initialize the defsym member
	of the assign structure.
	(exp_assign): Handle hidden symbols.
	(exp_defsym): Update to use the defsym argument to exp_assop.
	(exp_provide): Update to handle the defsym argument to exp_assop.
	* ldlex.l (HIDDEN): New token.
	* ldgram.y (HIDDEN): Likewise.
	(assignment, section): Update calls to exp_assign.
	* ldctor.c (ldctor_build_sets): Likewise.
	* mri.c (mri_format): Likewise.
	* ldlang.c (lang_insert_orphan, lang_leave_overlay): Likewise.
	(open_input_bfds): Remove --defsym symbols special case.
	* ld.texinfo (Assigning Values to Symbols): Add HIDDEN.
	(HIDDEN): New subsection.

	* release-notes-csl.xml (Linker script symbols): New.

2012-07-05  Thomas Schwinge  <thomas@codesourcery.com>

	Backport from upstream:

	opcodes/
	2012-07-05  Thomas Schwinge  <thomas@codesourcery.com>

	* mips-dis.c: Remove gratuitous newline.

2012-07-04  Sandra Loosemore <sandra@codesourcery.com>

	Revert:

	2010-08-03  Daniel Jacobowitz  <dan@codesourcery.com>
		    Sandra Loosemore <sandra@codesourcery.com>

	Issue #9152

	* release-notes-csl.xml (C++ code bloat with -g): New note.

	gas/
	* dw2gencfi.c (CFI_EMIT_eh_frame, CFI_EMIT_debug_frame)
	(cfi_sections): Move earlier.
	(dot_cfi_personality): Do not create a symbol unless generating
	.eh_frame.

2012-06-28  Sandra Loosemore <sandra@codesourcery.com>

	gas/
	* dw2gencfi.c [!TARGET_USE_CFIPOP] (cfi_pseudo_table): Don't
	reference dot_cfi_inline_lsda here.

2012-06-15  Maciej W. Rozycki  <macro@codesourcery.com>

	opcodes/
	* Makefile.am (TARGET_LIBOPCODES_CFILES): Remove duplicate
	micromips-opc.c.
	* Makefile.in: Regenerate.

2012-06-05  Catherine Moore  <clm@codesourcery.com>
	    Chao-Ying Fu  <fu@mips.com>
	
	* release-notes-csl.xml: New note.

	gas/testsuite/
	* gas/mips/mips.exp: Run new tests.
	* gas/mips/eva.d: New.
	* gas/mips/eva.s: New.
	* gas/mips/micromips@eva.d: New.

	gas/
	* config/tc-mips.c (mips_set_options): Add ase_eva.
 	(mips_set_options mips_opts): Add ase_eva.
	(file_ase_eva): Declare.
	(ISA_SUPPORTS_EVA_ASE): Define.
	(IS_SEXT_9BIT_NUM): Define.
	(MIPS_CPU_ASE_EVA): Define.
	(is_opcode_valid): Add support for ase_eva.
	(macro_build): Likewise.
	(macro): Likewise.
	(validate_mips_insn): Likewise.
	(validate_micromips_insn): Likewise.
	(mips_ip): Likewise.
	(options): Add OPTION_EVA and OPTION_NO_EVA.
	(md_longopts): Add -meva and -mno-eva.
	(md_parse_option): Process new options.
	(mips_after_parse_args): Check for valid EVA combinations.

	include/
	* opcode/mips.h (OP_SH_EVAOFFSET): Define.
	(OP_MASK_EVAOFFSET): Define.
	(INSN_ASE_MASK): Set EVA bit.
	(INSN_EVA): Define.
	(M_CACHEE_AB, M_CACHEE_OB): New.
	(M_LBE_OB, M_LBE_AB): New.
	(M_LBUE_OB, M_LBUE_AB): New.
	(M_LHE_OB, M_LHE_AB): New.
	(M_LHUE_OB, M_LHUE_AB): New.
	(M_LLE_AB, M_LLE_OB): New.
	(M_LWE_OB, M_LWE_AB): New.
	(M_LWLE_AB, M_LWLE_OB): New.
	(M_LWRE_AB, M_LWRE_OB): New.
	(M_PREFE_AB, M_PREFE_OB): New.
	(M_SCE_AB, M_SCE_OB): New.
	(M_SBE_OB, M_SBE_AB): New.
	(M_SHE_OB, M_SHE_AB): New.
	(M_SWE_OB, M_SWE_AB): New.
	(M_SWLE_AB, M_SWLE_OB): New.
	(M_SWRE_AB, M_SWRE_OB): New.
	(MICROMIPSOP_SH_EVAOFFSET): Define.
	(MICROMIPSOP_MASK_EVAOFFSET): Define.

	opcodes/
	* micromips-opc.c (EVA): Define.
	(micromips_opcodes): Add EVA opcodes.
	* mips-dis.c (mips_arch_choices): Update for INSN_EVA.
	(print_insn_args): Handle EVA offsets.
	(print_insn_micromips): Likewise.
	* mips-opc.c (EVA): Define.
	(mips_builtin_opcodes): Add EVA opcodes.

2012-05-24  Iain Sandoe  <iain@codesoucery.com>

	Issue #13349

	* release-notes-csl.xml (Linker --gc-sections bug fix): New note.

	Backport from upstream:

	bfd/
	2011-10-19  Alan Modra <amodra@gmail.com>
	* elflink.c (elf_link_output_extsym): Correct test for warning when
	forced local executable syms are referenced from shared libraries.

	2011-09-15  H.J. Lu  <hongjiu.lu@intel.com>
	* elflink.c (elf_gc_sweep_symbol): Also hide symbols without PLT
	nor GOT references.

2012-04-19  Catherine Moore  <clm@codesoucery.com>

	ld/
	* emultemp/elf32.em (gld${EMULATION_NAME}_after_open): Fix typo.

2012-04-19  Thomas Schwinge  <thomas@codesourcery.com>

	Backport from upstream:

	bfd/
	2012-04-19  Thomas Schwinge  <thomas@codesourcery.com>

	* elf32-sh.c (elf_sh_link_hash_entry): Specify an enum identifier for
	got_type.
	(allocate_dynrelocs, sh_elf_relocate_section, sh_elf_check_relocs): Use
	it.

	Issue #12917

	Backport from upstream:

	bfd/
	2012-04-17  Kaz Kojima  <kkojima@rr.iij4u.or.jp>

	* elf32-sh.c (allocate_dynrelocs): Don't allocate dynamic
	relocations when LE conversion happens on the IE tls symbol.

2012-04-18  Meador Inge  <meadori@codesourcery.com>

	CB-1090

	* release-notes-csl.xml (Linker --gc-sections option bug fix): New note.

	Backport from upstream:

	2011-09-29  Alan Modra  <amodra@gmail.com>

 	PR ld/13233
 	* elflink.c (_bfd_elf_gc_mark_extra_sections): Mark single member
 	debug and special section groups.

2012-04-13  Meador Inge  <meadori@codesourcery.com>

	Issue #8217

	Reverted:

	2010-04-06  Jie Zhang  <jie@codesourcery.com>

	Issue #8217

	gas/
	* config/tc-arm.c (only_one_reg_in_list): New.
	(do_ldmstm): Use different encodings when push or pop only one
	register.

	gas/testsuite/
	* gas/arm/push-pop.d: New test.
	* gas/arm/push-pop.s: New test.

	and backported what actually got committed upstream:

	gas/
	2012-04-12  Jie Zhang  <jie@codesourcery.com>
                    Meador Inge  <meadori@codesourcery.com>

	* config/tc-arm.c (only_one_reg_in_list): New function.
	(encode_ldmstm): Ditto.
	(do_ldmstm): Use a different encoding when pushing or poping
	a single register.
	(A_COND_MASK): New macro.
	(A_PUSH_POP_OP_MASK): Ditto.
	(A1_OPCODE_PUSH): Ditto.
	(A2_OPCODE_PUSH): Ditto.
	(A2_OPCODE_POP): Ditto.

	gas/testsuite/

	2012-04-12  Jie Zhang  <jie@codesourcery.com>
                    Meador Inge  <meadori@codesourcery.com>

	* gas/arm/push-pop.d: New testcase.
	* gas/arm/push-pop.s: Ditto.
	* gas/arm/stm-ldm.d: Ditto.
	* gas/arm/stm-ldm.s: Ditto.

2012-03-22  James Lemke  <jwlemke@codesourcery.com>

	gas/testsuite/gas/m68k/
	* all.exp: Exclude pr11676 for fido-*-*.

2012-03-21  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #12921

	Backport from upstream:

	gas/
	2012-03-21  Thomas Schwinge  <thomas@codesourcery.com>

	[SH] Support the .uaquad and .8byte directives also for non-sh64
	configurations.

	* config/tc-sh.c (sh_cons_fix_new, md_apply_fix) [!HAVE_SH64]: Handle
	BFD_RELOC_64.
	* doc/c-sh64.texi (SH64 Machine Directives): Move .uaquad
	description...
	* doc/c-sh.texi (SH Machine Directives): ... here.

2012-03-19  James Lemke  <jwlemke@codesourcery.com>

	gas/testsuite/gas/m68k/
	* all.exp: Exclude pr11676 for fido-*-*.

2012-03-08  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #13040
	bfd/
	* elfxx-mips.c (_bfd_mips_elf_check_relocs): Only set need_mips
	PLT entry flag for R_MIPS_26 relocs.
	(_bfd_mips_elf_adjust_dynamic_symbol): Default to microMIPS PLT
	entries if producing output with any microMIPS code included.

	* release-notes-csl.xml (microMIPS PLT linker bug fix): New.

2012-02-17  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Linker COMDAT optimization bug fix): New note.

	bfd/
	* elflink.c (is_comdat_symbol): Remove static keyword.
	* elf-bfd.h (is_comdat_symbol): Declare.
	* elf32-arm.c (elf32_arm_adjust_dynamic_symbol): Test for comdat
	symbols that didn't turn out to need PLT entries after all.

2012-02-07 Paul Brook <paul@codesourcery.com>

	bfd/
	* elf-bfd.h (eh_frame_hdr_info): Add allocated_entries, entries,
	v2_entry.
	(elf_backend_data): Add compact_eh_encoding.
	(bfd_elf_section_data): Add eh_frame_entry.
	(elf_section_eh_frame_entry): Define.
	(_bfd_elf_parse_eh_frame_entry, _bfd_elf_end_eh_frame_parsing,
	_bfd_elf_write_section_eh_frame_entry, _bfd_elf_fixup_eh_frame_hdr):
	Add/update prototypes.
	* elf-eh-frame.c (bfd_elf_remember_eh_frame_entry,
	_bfd_elf_parse_eh_frame_entry, cmp_eh_frame_hdr,
	add_eh_frame_hdr_terminator): New functions.
	(_bfd_elf_end_eh_frame_parsing): Sort and terminate compact frame
	header entries.
	(_bfd_elf_discard_section_eh_frame_hdr): Compact frame header
	generation.
	(_bfd_elf_maybe_strip_eh_frame_hdr): Parse .eh_frame_entry sections.
	Provide __GNU_EH_FRAME_HDR.
	(_bfd_elf_write_section_eh_frame_entry, _bfd_elf_fixup_eh_frame_hdr):
	New functions.
	(_bfd_elf_write_section_eh_frame_hdr): Write compact EH frame headers.
	* elflink.c (elf_link_input_bfd): Handle ELF_INFO_TYPE_EH_FRAME_ENTRY.
	(bfd_elf_final_link): Add magic for compact EH frames.
	(_bfd_elf_gc_mark): Mark EH tables from text sections.
	(bfd_elf_gc_sections): Parse .eh_frame_entry sections.
	(bfd_elf_discard_info): Parse .eh_frame_entry sections.
	* elfxx-mips.c (_bfd_mips_elf_compact_eh_encoding): New function.
	* elfxx-mips.h (_bfd_mips_elf_compact_eh_encoding): Add prototype.
	(elf_backend_compact_eh_encoding): Define.
	* elfxx-target.h (elf_backend_compact_eh_encoding): Define default.
	(elfNN_bed): Add elf_backend_compact_eh_encoding.
	(section.c): Define ELF_INFO_TYPE_EH_FRAME_ENTRY.
	* bfd-in2.h: Regenerate.

	include/
	* bfdlink.h (bfd_link_info): Make eh_frame_hdr a 2-bit field.

	ld/
	* emultempl/elf32.em (gld${EMULATION_NAME}_after_open):
	Search for compact frame headers.
	* scripttempl/elf.sc: Add .eh_frame.*, .eh_frame_entry and .gnu_extab.

2012-02-07 Paul Brook <paul@codesourcery.com>

	gas/
	* config/tc-mips.c (md_apply_fix): Handle BFD_RELOC_NONE.
	(mips_make_debug_seg): New function.
	(mips_unwind_reg_from_dwarf, mips_cfi_endproc, mips_cfi_fix_eh_ref,
	mips_cfi_emit_expr): New functions.
	* config/tc-mips.h (DWARF2_FDE_RELOC_SIZE): Use compact_eh.
	(DWARF2_FDE_RELOC_ENCODING): Define.
	(tc_make_debug_seg, tc_cfi_endproc, tc_cfi_emit_expr,
	tc_cfi_fix_eh_ref): Define.
	* dw2gencfi.c (EH_FRAME_LINKONCE): Define.
	(last_fde): New variable.
	(tc_cfi_emit_expr, tc_cfi_special_encoding): Provide defaults.
	(compact_eh): New variable.
	(FRAME_NAME): Use .gnu.extab for compact frames.
	(get_debugseg_name): Suffix all EH sections except for .text.
	(is_now_linkonce_segment): Do not squich regular compact EH
	sections together.
	(make_debug_seg): Use tc_make_debug_seg.
	(cie_entry): Add fde_encoding.
	(cfi_pseudo_table): Add "cfi_inline_lsda".
	(dot_cfi_personality, dot_cfi_lsda): Use tc_cfi_special_encoding.
	(dot_cfi_sections): Accept .eh_frame_entry.
	(dot_cfi_startproc): Set last_fde.  Call tc_cfi_endproc for compact EH.
	(get_cfi_seg): Move higher in file.
	(output_compact_unwind_data, dot_cfi_inline_lsda): New functions.
	(output_cie): Use tc_cfi_special_encoding and
	DWARF2_FDE_RELOC_ENCODING.
	(output_fde): Use tc_cfi_special_encoding.
	(cfi_emit_eh_header, output_eh_header): New functions.
	(cfi_finish): Handle compact EH frame generation.
	* dw2gencfi.h (SUPPORT_COMPACT_EH, MULTIPLE_FRAME_SECTIONS): Define.
	(EH_COMPACT_*): Define.
	(fde_entry): Add eh_header_type, eh_data_size, eh_data, eh_loc.
	* doc/as.texinfo: Document .cfi_sections .eh_frame_header and
	.cfi_inline_lsda.

2012-02-07 Paul Brook <paul@codesourcery.com>

	bfd/
	* reloc.c (BFD_RELOC_MIPS_EH): Add.
	* elfxx-mips.c (mips_elf_link_hash_table): Add eh_reloc_type.
	(mips_elf_real_reloc): New funtion.
	(mips_elf_calculate_relocation): Handle R_MIPS_EH.  Use
	mips_elf_real_reloc.
	(_bfd_mips_elf_check_relocs, mips_elf_adjust_addend): Ditto.
	(_bfd_mips_elf_relocate_section): Ditto.
	(_bfd_mips_elf_insn32): Rename...
	(_bfd_mips_elf_linker_flags): To this.  Add eh_reloc.
	* elfxx-mips.h (_bfd_mips_elf_linker_flags): Update prototype.
	* elf64-mips.c (elf_mips_eh_howto): New.
	(bfd_elf64_bfd_reloc_type_lookup, bfd_elf64_bfd_reloc_name_lookup,
	mips_elf64_rtype_to_howto): Handle R_MIPS_PC64.
	* elf64-mips.c (elf_mips_eh_howto): New.
	(bfd_elf64_bfd_reloc_type_lookup, bfd_elf64_bfd_reloc_name_lookup,
	mips_elf64_rtype_to_howto): Handle R_MIPS_PC32.
	* elfn32-mips.c (elf_mips_gnu_pcrel32): New.
	(bfd_elfn32_bfd_reloc_type_lookup, bfd_elfn32_bfd_reloc_name_lookup,
	mips_elfn32_rtype_to_howto): Handle R_MIPS_PC32.
	* bfd-in2.h: Regenerate.
	* libbfd.h: Regenerate.

	gas/
	* config/tc-mips.c (s_ehword): New functon.
	(mips_pseudo_table): Add "ehword".

	include/elf/
	* mips.h: Add R_MIPS_EH.

	ld/
	* emultempl/mipself.em (eh_reloc_type): New.
	(mips_create_output_section_statements): Use eh_reloc_type.
	(OPTION_PCREL_EH_RELOC): Define.
	(PARSE_AND_LIST_LONGOPTS): Add "pcrel-eh-reloc".
	(PARSE_AND_LIST_ARGS_CASES): Handle OPTION_PCREL_EH_RELOC.
	* ld.texinfo: Document --pcrel-eh-reloc.

2012-02-07 Paul Brook <paul@codesourcery.com>

	bfd/
	* elf64-mips.c (elf_mips_gnu_pcrel32): New.
	(bfd_elf64_bfd_reloc_type_lookup, bfd_elf64_bfd_reloc_name_lookup,
	mips_elf64_rtype_to_howto): Handle R_MIPS_PC32.
	* elfn32-mips.c (elf_mips_gnu_pcrel32): New.
	(bfd_elfn32_bfd_reloc_type_lookup, bfd_elfn32_bfd_reloc_name_lookup,
	mips_elfn32_rtype_to_howto): Handle R_MIPS_PC32.

	gas/
	* config/tc-mips.c (md_pcrel_from): Handle BFD_RELOC_32_PCREL.
	(md_apply_fix, mips_fix_adjustable, tc_gen_reloc): Ditto.

	include/elf/
	* mips.h (R_MIPS_PC32): Update comment.

2012-02-07 Paul Brook <paul@codesourcery.com>

	gas/
	* dw2gencfi.c (all_cfi_sections): new.
	(dot_cfi_personality, dot_cfi_startproc, cfi_finish): Use
	all_cfi_sections and per-fde section flags.
	* dw2gencfi.h (fde_entry): Add sections.

2012-02-03  James Lemke  <jwlemke@codesourcery.com>

	Back port from FSF.

	* release-notes-csl.xml: New note.

	2011-09-05  Richard Sandiford  <rdsandiford@googlemail.com>

	PR gas/13024
	* dwarf2dbg.c (pending_lines, pending_lines_tail): New variables.
	(dwarf2_gen_line_info_1): Delete.
	(dwarf2_push_line, dwarf2_flush_pending_lines): New functions.
	(dwarf2_gen_line_info, dwarf2_emit_label): Use them.
	(dwarf2_consume_line_info): Call dwarf2_flush_pending_lines.
	(dwarf2_directive_loc): Push previous .locs instead of generating
	them immediately.

2011-12-22  Sandra Loosemore  <sandra@codesourcery.com>

	Merge from mips-comdat-linker branch:

	2011-11-02  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Linker COMDAT group code size optimization):
	New note.

	ld/
	* emultempl/elf32.em (gld${EMULATION_NAME}_after_open):
	Call find_shared_comdat_symbols before returning.
	(OPTION_SHARED_COMDAT): Define.
	(gld${EMULATION_NAME}_add_options): Make it know about new option.
	(gld${EMULATION_NAME}_handle_option): Likewise.
	(gld${EMULATION_NAME}_list_options): Likewise.
	* ld.texinfo (--shared-comdat): Document new option.

	include/
	* bfdlink.h (struct bfd_link_info): Add shared_comdat flag.

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_check_relocs): Don't require static
	relocs for .pdr references, since they may be optimized away.
	* elflink.c (section_signature): Add forward declaration.
	(struct elf_shared_comdat_symbol): Declare.
	(struct elf_shared_comdat_group): Declare.
	(struct elf_shared_comdat_library): Declare.
	(elf_shared_comdat_group_list): New.
	(elf_shared_comdat_library_list): New.
	(is_comdat_symbol): New.
	(record_shared_comdat_group_symbol): New.
	(record_shared_comdat_library_symbol): New.
	(replace_shared_comdat_group): New.
	(find_shared_comdat_symbols): New.
	(_bfd_elf_symbol_refs_local_p): Return FALSE for comdat symbols
	that may be optimized away.
	(elf_link_add_object_symbols): Record group and library symbols
	for shared comdat analysis.
	(bfd_elf_reloc_symbol_deleted_p): Also check for symbols with no
	regular definition.
	* elf-bfd.h (find_shared_comdat_symbols): Declare.

	2011-11-14  Sandra Loosemore  <sandra@codesourcery.com>

	ld/testsuite/
	* ld-elf/comdat.exp: New.
	* ld/testsuite/ld-elf/comdat.H: New.
	* ld/testsuite/ld-elf/comdat0.C: New.
	* ld/testsuite/ld-elf/comdat1a.C: New.
	* ld/testsuite/ld-elf/comdat1b.C: New.
	* ld/testsuite/ld-elf/comdat-main.C: New.

2011-12-19  Joseph Myers  <joseph@codesourcery.com>

	ld/
	* emulparams/elf32bmip.sh (OTHER_SECTIONS): Put .mdebug.* sections
	at address 0.

2011-11-15  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/mips.exp (has_newabi): Also set for mips*-sde-elf*.
	* gas/mips/elf-rel-got-n32.s: Adjust padding.
	* gas/mips/elf-rel-got-n64.s: Likewise.
	* gas/mips/elf-rel23.s: Likewise.
	* gas/mips/n32-consec.s: Likewise.
	* gas/mips/elf-rel-xgot-n32.d: Update accordingly.
	* gas/mips/elf-rel-xgot-n64.d: Likewise.
	* gas/mips/elf-rel23.d: Likewise.
	* gas/mips/elf-rel23a.d: Likewise.
	* gas/mips/elf-rel23b.d: Likewise.

2011-11-14  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Backport trivial fix from mainline:

	bfd/
	2011-11-14  Maxim Kuvyrkov  <maxim@codesourcery.com>
	* elfxx-mips.c (mips_n64_exe_plt0_entry): Use 64-bit move.

2011-11-04  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #10951

	Revert:

	2011-05-03  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_symbol_processing): Replace
	assertions with warning messages.

	Backport from FSF:

	2011-10-24  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_symbol_processing): Remove
	assertions.

2011-11-04  Sandra Loosemore  <sandra@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Don't use la25 stub
	for mips16->mips16 calls.

2011-10-27  Meador Inge  <meadori@codesourcery.com>

	CB-555

	Backport from FSF:

	2011-10-18  Julian Brown  <julian@codesourcery.com>

        ld/testsuite/
        * ld-arm/cortex-a8-fix-b-plt.d: Adjust.
        * ld-arm/cortex-a8-fix-bcc-plt.d: Adjust.
        * ld-arm/cortex-a8-fix-bl-plt.d: Adjust.
        * ld-arm/cortex-a8-fix-bl-rel-plt.d: Adjust.
        * ld-arm/cortex-a8-fix-blx-plt.d: Adjust.
        * ld-arm/ifunc-1.dd: Adjust.
        * ld-arm/ifunc-2.dd: Adjust.
        * ld-arm/ifunc-3.dd: Adjust.
        * ld-arm/ifunc-4.dd: Adjust.
        * ld-arm/ifunc-5.dd: Adjust.
        * ld-arm/ifunc-6.dd: Adjust.
        * ld-arm/ifunc-7.dd: Adjust.
        * ld-arm/ifunc-8.dd: Adjust.
        * ld-arm/ifunc-9.dd: Adjust.
        * ld-arm/ifunc-10.dd: Adjust.
        * ld-arm/ifunc-14.dd: Adjust.
        * ld-arm/ifunc-15.dd: Adjust.
        * ld-arm/ifunc-16.dd: Adjust.

2011-10-25  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #12354

	gas/
	* config/tc-m68k.c (m68k_cpus): Add 51jg.

2011-10-21  Catherine Moore  <clm@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation):  Add check for 
	(h != NULL).

2011-10-20  Chung-Lin Tang  <cltang@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_pseudo_table): Add tprelword/tpreldword
	entries.
	(mips16_percent_op): Add MIPS16 TLS relocation ops.
	(md_apply_fix): Add BFD_RELOC_MIPS16_TLS_* switch cases.
	(s_tls_rel_directive): Rename from s_dtprel_internal(). Abstract out
	directive string and reloc type as function parameters. Update
	comments.
	(s_dtprelword,s_dtpreldword): Change to use s_tls_rel_directive().
	(s_tprelword,s_tpreldword): New functions.

	include/
	* elf/mips.h (elf_mips_reloc_type): Add R_MIPS16_TLS_* entries.

	bfd/
	* reloc.c (BFD_RELOC_MIPS16_TLS_GD,BFD_RELOC_MIPS16_TLS_LDM,
	BFD_RELOC_MIPS16_TLS_DTPREL_HI16,BFD_RELOC_MIPS16_TLS_DTPREL_LO16,
	BFD_RELOC_MIPS16_TLS_GOTTPREL,BFD_RELOC_MIPS16_TLS_TPREL_HI16,
	BFD_RELOC_MIPS16_TLS_TPREL_LO16): New relocations for MIPS16 TLS.
	* bfd-in2.h (bfd_reloc_code_real): Regenerate.
	* libbfd.h (bfd_reloc_code_real_names): Regenerate.
	* elf32-mips.c (elf_mips16_howto_table_rel): Add R_MIPS16_TLS_*
	entries.
	(mips16_reloc_map): Add BFD_RELOC_MIPS16_TLS_* to R_MIPS16_TLS_*
	mappings.
	* elfn32-mips.c (elf_mips16_howto_table_rel,
	elf_mips16_howto_table_rela): Add R_MIPS16_TLS_* entries.
	(mips16_reloc_map): Add BFD_RELOC_MIPS16_TLS_* to R_MIPS16_TLS_*
	mappings.
	* elf64-mips.c (mips16_elf64_howto_table_rel,
	mips16_elf64_howto_table_rela): Add R_MIPS16_TLS_* entries.
	(mips16_reloc_map): Add BFD_RELOC_MIPS16_TLS_* to R_MIPS16_TLS_*
	mappings.
	* elfxx-mips.c (TLS_RELOC_P,mips16_reloc_p,
	_bfd_mips_elf_check_relocs): Add cases for R_MIPS16_TLS_* relocations.
	(tls_gd_reloc_p): Add R_MIPS16_TLS_GD case.
	(tls_ldm_reloc_p): Add R_MIPS16_TLS_LDM case.
	(tls_gottprel_reloc_p): Add R_MIPS16_TLS_GOTTPREL case.
	(mips_elf_calculate_relocation): Add cases for R_MIPS16_TLS_*,
	R_MIPS_TLS_DTPREL32/64, and R_MIPS_TLS_TPREL32/64 relocations.

2011-10-20  Chung-Lin Tang  <cltang@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_elf_local_pic_function_p): Return true when
	H is a MIPS16 function with a kept 32-bit stub. Update comments.
	(mips_elf_add_la25_intro): Use MIPS16 stub section as place of
	insertion when it exists.
	(mips_elf_add_la25_stub): Always use LUI/ADDIU prepending for
	MIPS16 stubs. Update comments.
	(mips_elf_calculate_relocation): Redirect relocation to point to
	the LA25 stub if it exists, instead of the MIPS16 stub.
	(mips_elf_create_la25_stub): Change $25 target calculation to
	base on MIPS16 stub if it exists.

2011-10-20  Chung-Lin Tang  <cltang@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Correct
	R_MIPS16_LO16 handling of two cleared lower bits.

2011-10-19  Meador Inge  <meadori@codesourcery.com>

	CB-372

	Trivial configure patch that was meant to be a part
	of the binutils 2.21 merge.

	* configure.ac (configdirs): Add convert for mips-sde-elf.
	* configure: Regenerate.

2011-10-18  Meador Inge  <meadori@codesourcery.com>

	CB-372

	Merged upstream binutils 2.21.

	* release-notes-csl.xml: New note.

2011-10-07  Meador Inge  <meadori@codesourcery.com>

	Reverting the following changeset until the binutils 2.21 merge is
	finished.  I cleared this with Maxim first:

	2011-10-07  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge XLP support patch from NetLogic.
	Do not spend time pushing this upstream as it should be NetLogic's work.

	ld/
	* configure.tgt: Add mips*-nlm-elf* targets.
	gas/
	* doc/c-mips.texi: Add xlp.
	* config/tc-mips.c: Add definitions for XLP.
	* configure.tgt: Handle mips*-nlm-elf* targets.
	./
	* include/elf/mips.h (E_MIPS_MACH_XLP): Define.
	* include/opcode/mips.h (INSN_XLP): Define.
	(OPCODE_IS_MEMBER): Update.
	binutils/
	* readelf.c (get_machine_flags): Update.
	bfd/
	* archures.c: Update for XLP.
	* cpu-mips.c: Update for XLP.
	* config.bfd: Handle mips*-nlm-elf* targets.
	* aoutx.h: Update for XLP.
	* elfxx-mips.c: Update for XLP.
	* bfd-in2.h: Update for XLP.
	opcodes/
	* mips-dis.c: Update for XLP.
	* mips-opc.c: Add XLP-specific instructions.

2011-10-07  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #11914
	Issue #12259

	gas/
	* config/tc-m68k.c (m68k_cpus): Add 51jf and 51qm.

2011-10-07  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Merge XLP support patch from NetLogic.
	Do not spend time pushing this upstream as it should be NetLogic's work.

	ld/
	* configure.tgt: Add mips*-nlm-elf* targets.
	gas/
	* doc/c-mips.texi: Add xlp.
	* config/tc-mips.c: Add definitions for XLP.
	* configure.tgt: Handle mips*-nlm-elf* targets.
	./
	* include/elf/mips.h (E_MIPS_MACH_XLP): Define.
	* include/opcode/mips.h (INSN_XLP): Define.
	(OPCODE_IS_MEMBER): Update.
	binutils/
	* readelf.c (get_machine_flags): Update.
	bfd/
	* archures.c: Update for XLP.
	* cpu-mips.c: Update for XLP.
	* config.bfd: Handle mips*-nlm-elf* targets.
	* aoutx.h: Update for XLP.
	* elfxx-mips.c: Update for XLP.
	* bfd-in2.h: Update for XLP.
	opcodes/
	* mips-dis.c: Update for XLP.
	* mips-opc.c: Add XLP-specific instructions.

2011-10-05  Meador Inge  <meadori@codesourcery.com>

	Issue #12260

	gas/
	* config/tc-arm.c (create_neon_reg_alias): Mark 'nameend' with
	ATTRIBUTE_UNUSED since it is unused on some conditional compile paths.

	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Delete unused
	variables 'in_list', 'out_list', and 'out_listp'.

2011-10-03  Meador Inge  <meadori@codesourcery.com>

	Issue #12249

	Backport from FSF:

	2010-10-11  Dave Korn  <dave.korn.cygwin@gmail.com>

	* elflink.c (_bfd_elf_link_output_relocs): Delete unused variable
	"output_rel_hdr".

2011-09-16  Julian Brown  <julian@codesourcery.com>

	Issue #12129

	bfd/
	* elf32-arm.c (arm_allocate_glue_section_space): Undo exclusion of
	zero-sized section if we are called subsequently with non-zero-sized
	section.

	ld/testsuite/
	* ld-arm/thumb1-got-glue.s: New.
	* ld-arm/thumb1-got-glue.d: New.
	* ld-arm/arm-elf.exp: Add above test.

2011-08-23  Meador Inge  <meadori@codesourcery.com>

	CB-258

	* release-notes-csl.xml: Revert CB-118 release note.

	Revert the following FSF backport that was done for CB-118:

	2010-11-25  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* ld-arm/arm-elf.exp (armeabitests): Replace --defsym argument in
	jump-reloc-veneers* tests with --section-start .text=0x8000.

	2010-11-03  Nick Clifton  <nickc@redhat.com>

	PR ld/12001
	* ldlang.c (ldlang_def_chain_list): New variable.  Contains a list
	of symbols defined via the --defsym command line option and
	currently waiting assignment.
	(insert_defined): Add a defined symbol to the symbol table.
	(ldlang_add_def): Add a entry to the ldlang_def_chain_list.
	(lang_place_defineds): Walk ldlang_def_chain_list defining the
	symbols.
	(lang_process): Call lang_place_defineds.
	(lang_add_assignment): If the assignment has come from a --defsym
	command line option then call lang_add_def.

2011-08-18  Maciej W. Rozycki  <macro@codesourcery.com>

	* release-notes-csl.xml
	(Binutils support for 32-bit microMIPS instructions): New.
	(Support for pure microMIPS objects): New.

2011-08-18  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.h (_bfd_mips_elf_insn32): New prototype.
	* elfxx-mips.c (mips_elf_link_hash_table): Add insn32 member.
	(MICROMIPS_P): Document.
	(STUB_LW_MICROMIPS): New macro.
	(STUB_MOVE_MICROMIPS, STUB_MOVE32_MICROMIPS): Likewise.
	(STUB_LUI_MICROMIPS): Likewise.
	(STUB_JALR_MICROMIPS, STUB_JALR32_MICROMIPS): Likewise.
	(STUB_LI16U_MICROMIPS, STUB_LI16S_MICROMIPS): Likewise.
	(MICROMIPS_FUNCTION_STUB_NORMAL_SIZE): Likewise.
	(MICROMIPS_FUNCTION_STUB_BIG_SIZE): Likewise.
	(MICROMIPS_INSN32_FUNCTION_STUB_NORMAL_SIZE): Likewise.
	(MICROMIPS_INSN32_FUNCTION_STUB_BIG_SIZE): Likewise.
	(micromips_o32_exec_plt0_entry): Rename variable to...
	(micromips_insn32_o32_exec_plt0_entry): ... this.
	(micromips_o32_exec_plt0_entry): New variable.
	(micromips_insn32_o32_exec_plt_entry): Likewise.
	(_bfd_mips_elf_create_dynamic_sections): Don't set PLT header
	size here.  Reverse a negative conditional.
	(_bfd_mips_elf_adjust_dynamic_symbol): Adjust size calculation
	for PLT header handling change.
	(mips_elf_estimate_stub_size): Handle microMIPS stubs.
	(mips_elf_allocate_lazy_stub): Likewise.
	(mips_elf_lay_out_lazy_stubs): Likewise.  Define a _MIPS_STUBS_
	magic symbol.
	(_bfd_mips_elf_size_dynamic_sections): Set PLT header size here.
	Handle microMIPS annotation of the _PROCEDURE_LINKAGE_TABLE_
	magic symbol.
	(_bfd_mips_elf_finish_dynamic_symbol): Fix PLT header's ISA mode
	bit calculation.  Handle insn32 mode microMIPS PLT entries.
	Simplify ADDIUPC overflow check.  Handle microMIPS stubs.
	(mips_finish_exec_plt): Handle both variants of microMIPS PLT
	header.
	(_bfd_mips_elf_finish_dynamic_sections): Handle result from
	mips_finish_exec_plt.
	(_bfd_mips_elf_relax_section): Disable 16-bit microMIPS
	relaxation options if in the insn32 mode.  Handle 32-bit
	delay-slot NOPs in compact branch relaxation.
	(_bfd_mips_elf_link_hash_table_create): Preinitialize insn32.
	(_bfd_mips_elf_insn32): New function.
	(_bfd_mips_elf_get_synthetic_symtab): Synthesize a
	_PROCEDURE_LINKAGE_TABLE_ magic symbol.  Handle microMIPS PLT
	headers.  Handle insn32-mode PLT entries.

	opcodes/
	* mips-dis.c (is_micromips_mode_p): Correct ELF symbol attribute
	check.

	ld/
	* emultempl/mipself.em (insn32): New variable.
	(mips_create_output_section_statements): Handle insn32 mode.
	(PARSE_AND_LIST_PROLOGUE): New macro.
	(PARSE_AND_LIST_LONGOPTS): Likewise.
	(PARSE_AND_LIST_OPTIONS): Likewise.

	* gen-doc.texi: Set MIPS.
	* ld.texinfo: Likewise.
	(Options specific to MIPS targets): New section.
	(ld and MIPS family): Likewise.

	ld/testsuite/
	* ld-mips-elf/jalx-2.dd: Update for microMIPS PLT header.
	* ld-mips-elf/pic-and-nonpic-3a.dd: Update for the _MIPS_STUBS_
	magic symbol.
	* ld-mips-elf/pic-and-nonpic-3b.dd: Likewise.
	* ld-mips-elf/pic-and-nonpic-6-n32.dd: Likewise.
	* ld-mips-elf/pic-and-nonpic-6-n64.dd: Likewise.
	* ld-mips-elf/pic-and-nonpic-6-o32.dd: Likewise.
	* ld-mips-elf/stub-dynsym-1-10000.d: Likewise.
	* ld-mips-elf/stub-dynsym-1-2fe80.d: Likewise.
	* ld-mips-elf/stub-dynsym-1-7fff.d: Likewise.
	* ld-mips-elf/stub-dynsym-1-8000.d: Likewise.
	* ld-mips-elf/stub-dynsym-1-fff0.d: Likewise.
	* ld-mips-elf/tlslib-o32.d: Likewise.

	* ld-mips-elf/pic-and-nonpic-3b.dd: Add missing escapes.

2011-08-18  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_relax_section): Preserve the
	in-place addend in JAL->JALS relaxation.

2011-08-18  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.c (LA25_LUI_MICROMIPS_1, LA25_LUI_MICROMIPS_2):
	Remove and fold macros into...
	(LA25_LUI_MICROMIPS): ... this new macro.
	(LA25_J_MICROMIPS_1, LA25_J_MICROMIPS_2): Likewise into...
	(LA25_J_MICROMIPS): ... this.
	(LA25_ADDIU_MICROMIPS_1, LA25_ADDIU_MICROMIPS_2): Likewise
	into...
	(LA25_ADDIU_MICROMIPS): ... this.
	(bfd_put_micromips_32, bfd_get_micromips_32): New functions.
	(mips_elf_create_la25_stub): Use them.
	(check_br32_dslot, check_br32, check_bzc): Likewise.
	(_bfd_mips_elf_relax_section): Likewise.
	(_bfd_mips_elf_get_synthetic_symtab): Likewise.

2011-08-18  Maciej W. Rozycki  <macro@codesourcery.com>

	include/opcode/
	* mips.h: Add M_JRADDIUSP, M_JRC and M_MOVEP anonymous enum
	values.

	opcodes/
	* micromips-opc.c (micromips_opcodes): Add "jraddiusp", "jrc" and
	"movep" macros.

	gas/
	* config/tc-mips.c (mips_set_options): Add insn32 member.
	(mips_opts): Initialize it.
	(NOP_INSN): Handle the insn32 mode.
	(is_opcode_valid): Likewise.
	(macro_build_jalr, move_register): Likewise.
	(options): Add OPTION_INSN32 and OPTION_NO_INSN32 enum values.
	(md_longopts): Add "minsn32" and "mno-insn32" options.
	(md_parse_option): Handle OPTION_INSN32 and OPTION_NO_INSN32.
	(s_mipsset): Handle "insn32" and "noinsn32" pseudo-ops.
	(mips_handle_align): Handle the insn32 mode.
	(md_show_usage): Add -minsn32 and -mno-insn32.
	(micromips_macro_build) <'c'>: New case to handle 32-bit "break"
	encoding.
	(micromips_macro): Handle the insn32 mode.
	<M_JRADDIUSP>, <M_JRC>, <M_MOVEP>: New cases to handle the
	"jraddiusp", "jrc" and "movep" macros.

	* doc/as.texinfo (Target MIPS options): Add -minsn32 and
	-mno-insn32 options.
	(-minsn32, -mno-insn32): New options.
	* doc/c-mips.texi (MIPS Opts): Add -minsn32 and -mno-insn32
	options.
	(MIPS assembly options): New node.  Document .set insn32 and
	.set noinsn32.
	(MIPS-Dependent): List the new node.

	gas/testsuite/
	* gas/mips/micromips-insn32.d: New test.
	* gas/mips/micromips-noinsn32.d: Likewise.
	* gas/mips/micromips.l: Rename to...
	* gas/mips/micromips-warn.l: ... this.
	* gas/mips/micromips.d: Update accordingly.
	* gas/mips/micromips-trap.d: Likewise.
	* gas/mips/micromips.l: New list test.
	* gas/mips/micromips.s: Add conditionals.
	* gas/mips/mips.exp: Run the new tests.

2011-07-26  Paul Brook  <paul@codesourcery.com>

	bfd/
	* elfxx-mips.c (MICROMIPS_P): Define.
	(micromips_o32_exec_plt0_entry): New.
	(mips_elf_got_page): Use MICROMIPS_P.
	(mips_elf_calculate_relocation): Ditto.
	(_bfd_mips_elf_symbol_processing): Ditto.
	(_bfd_mips_elf_create_dynamic_sections): Ditto.
	(_bfd_mips_elf_finish_dynamic_symbol): Set low it of address of
	micrmips plt0.
	(mips_finish_exec_plt): Use micromips plt header if all references are
	also micromips.

2011-07-26  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #11778

	gas/
	* dwarf2dbg.c (out_debug_line): Ignore non-normal segments, with a
	warning.
	* doc/as.texinfo (Offset): Document .offset directive.

	gas/testsuite/
	* gas/all/warn-2.s: New.

	* release-notes-csl.xml: Document.

2010-07-20  Meador Inge  <meadori@codesourcery.com>

	CB-118

	* release-notes-csl.xml: New note.

	Backport from FSF:

	2010-11-25  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* ld-arm/arm-elf.exp (armeabitests): Replace --defsym argument in
	jump-reloc-veneers* tests with --section-start .text=0x8000.

	2010-11-03  Nick Clifton  <nickc@redhat.com>

	PR ld/12001
	* ldlang.c (ldlang_def_chain_list): New variable.  Contains a list
	of symbols defined via the --defsym command line option and
	currently waiting assignment.
	(insert_defined): Add a defined symbol to the symbol table.
	(ldlang_add_def): Add a entry to the ldlang_def_chain_list.
	(lang_place_defineds): Walk ldlang_def_chain_list defining the
	symbols.
	(lang_process): Call lang_place_defineds.
	(lang_add_assignment): If the assignment has come from a --defsym
	command line option then call lang_add_def.

2011-07-08  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #6233
	Issue #6234
	Issue #9116

	gas/
	* config/tc-m68k.c (m68k_cpus): Add 51ag, 51je and 51mm.

2011-06-22  Julian Brown  <julian@codesourcery.com>

	Issue #10390

	Backport from FSF:

	2010-09-19  Richard Sandiford  <rdsandiford@googlemail.com>

	bfd/
	* elfxx-mips.c (mips_got_entry): Adjust commentary.
	(mips_elf_create_local_got_entry): If given a symbol, check that it
	has been assigned to the local part of the GOT.
	(mips_elf_count_got_symbols): Take the bfd_link_info as argument
	instead of the master GOT.  Put all locally-binding symbols in
	the local area.
	(mips_elf_make_got_per_bfd): Use global_got_area to decide whether
	a symbol lives in the local or global area.
	(mips_elf_local_relocation_p): Remove check_forced argument and
	retain only the !check_forced behavior.
	(mips_elf_calculate_relocation): Adjust call accordingly.
	Use global_got_area to decide whether an output relocation
	should be local or global.  Explicitly decay R_MIPS_GOT_PAGE
	into R_MIPS_GOT_DISP where appropriate.  Fix selection of
	local vs. global semantics for R_MIPS*_26.  Remove redundant
	reevaluation of what is stored in was_local_p.
	(mips_elf_create_dynamic_relocation): Use global_got_area to decide
	whether the relocation should be against a global or local symbol.
	(mips_elf_lay_out_got): Update the GOT traversal after the above
	change to mips_elf_count_got_symbols.
	(mips_elf_adjust_addend): Adjust call to mips_elf_local_relocation_p.
	(_bfd_mips_elf_relocate_section): Likewise.
	(_bfd_mips_elf_finish_dynamic_symbol): Use global_got_area to decide
	whether the symbol has a global got entry.
	(_bfd_mips_vxworks_finish_dynamic_symbol): Likewise.

	ld/testsuite/
	* ld-mips-elf/elf-rel-got-n32.d: Swap two local GOT entries
	and remove some duplication between the global and local GOT
	entries.  Adjust GP offsets accordingly.
	* ld-mips-elf/elf-rel-got-n64-linux.d: Likewise.
	* ld-mips-elf/elf-rel-xgot-n32.d: Reorder GOT entries and update
	GP offsets accordingly.
	* ld-mips-elf/elf-rel-xgot-n64-linux.d: Likewise.
	* ld-mips-elf/mips16-pic-1.gd: Move all global GOT entries to
	the local GOT.
	* ld-mips-elf/mips16-pic-1.dd: Update GP offsets accordingly.
	* ld-mips-elf/multi-got-no-shared.d: Adjust GP setup for
	smaller GOT sizes.

2011-06-16  Catherine Moore  <clm@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_cpu_info_table): Add "m14ke" and "m14kec".
	* doc/c-mips.texi (MIPS architecture options): Add "m14ke" and
	"m14kec" to the list of -march options.

2011-05-16  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #10746

	gas/
	* config/tc-mips.c (mips_fix_adjustable): On REL targets reject
	all microMIPS HI16/GOT16/LO16 relocations.

	gas/testsuite/
	* gas/mips/micromips@lb-svr4pic-ilocks.d: Adjust according to
	HI16/GOT16/LO16 relocation conversion changes.

2011-05-13  Joseph Myers  <joseph@codesourcery.com>

	* release-notes-csl.xml (microMIPS linker code size optimization
	bug fix): Restrict release note to MIPS targets.

2011-05-12  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #10746
	bfd/
	* elfxx-mips.c (_bfd_mips_elf_relax_section): Exclude microMIPS
	symbols from ADDIUPC relaxation.

2011-05-12  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #10746

	bfd/
	* elfxx-mips.c (mips_elf_release_contents): New function.
	(mips_elf_write_rel_addend): Likewise.
	(mips_elf_relax_reloc_adjust_addend): Likewise.
	(mips_elf_relax_delete_bytes): Also adjust addends of relocs
	against the section being handled.  Remove upper limit checks.
	(find_match): Check the first entry too.
	(b_insns_32): Match the change to find_match.  Make static.
	(bzc_insns_32, bz_insns_16, move_insns_32): Likewise.
	(bz_insns_32): Likewise.  Rename to...
	(bz_rs_insns_32): ... this new variable.
	(bz_rt_insns_32): New variable.
	(bc_insn_32, bz_insn_32, bzal_insn_32): Make static.
	(beq_insn_32, b_insn_16): Likewise.
	(jal_insn_32_bd16, jal_insn_32_bd32): Likewise.
	(j_insn_32, jalr_insn_32): Likewise.
	(jalr_insn_16_bd16, jalr_insn_16_bd32, jr_insn_16): Likewise.
	(lui_insn, addiu_insn, addiupc_insn, move_insn_16): Likewise.
	(nop_insn_32, nop_insn_16): Likewise.
	(bz_insn_16): Likewise.  Fix the opcode mask.
	(ds_insns_32_bd16): Merge entries.  Match the change to
	find_match.  Make static.
	(ds_insns_32_bd32, ds_insns_16_bd16): Likewise.
	(jalr_insns_32_bd16, jalr_insns_32_bd32): Remove variables.
	(jalx_insn_32_bd32, lwgp_insn_32, lwgp_insn_16): Likewise.
	(BZ32_REG, LWGP32_REG, LWGP16_REG_FIELD): Remove macros.
	(BZ32_REG_FIELD): Rename to...
	(BZC32_REG_FIELD): ... this new macro.
	(BZ16_REG_FIELD, ADDIUPC_REG_FIELD): Fix formatting.
	(relax_delay_slot): Remove function.
	(check_br16_dslot, check_br32_dslot): New functions.
	(check_br16, check_br32, check_bzc): Likewise.
	(IS_BITSIZE): Simplify calculation.
	(relax_phase_1): New macro.
	(_bfd_mips_elf_relax_section): Don't relax IRIX objects.  Split
	handling into two phases.  Reimplement ADDIUPC relaxation.
	Recalculate and retain in-place addends of instructions relaxed.

	gas/
	* config/tc-mips.c (mips_fix_adjustable): On REL targets reject
	microMIPS HI16/LO16 relocation pairs too.

	* release-notes-csl.xml
	(microMIPS linker code size optimization bug fix): New.

2011-05-11  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #10746
	bfd/
	* elfxx-mips.h (_bfd_mips_elf_relax_section): New prototype.
	* elf32-mips.c
	(elf32_mips_relax_delete_bytes, elf32_mips_relax_section):
	Move over to...
	* elfxx-mips.c
	(mips_elf_relax_delete_bytes, _bfd_mips_elf_relax_section):
	... these new functions.
	* elf32-mips.c (bfd_elf32_bfd_relax_section): Adjust
	accordingly.
	(opcode_descriptor, RA, OP32_SREG, OP32_TREG, OP16_VALID_REG)
	(b_insns_32, bc_insn_32, bz_insn_32, bzal_insn_32, beq_insn_32)
	(b_insn_16, bz_insn_16, BZ32_REG, BZ32_REG_FIELD, bz_insns_32)
	(bzc_insns_32, bz_insns_16, BZ16_REG, BZ16_REG_FIELD)
	(jal_insn_32_bd16, jal_insn_32_bd32, j_insn_32, jalr_insn_32)
	(jalr_insns_32_bd16, jalr_insns_32_bd32, ds_insns_32_bd16)
	(ds_insns_32_bd32, jalx_insn_32_bd32, jalr_insn_16_bd32)
	(jr_insn_16, JR16_REG, ds_insns_16_bd16, lui_insn, addiu_insn)
	(addiupc_insn, ADDIUPC_REG_FIELD, lwgp_insn_32, lwgp_insn_16)
	(LWGP32_REG, LWGP16_REG_FIELD, MOVE32_RD, MOVE32_RS)
	(MOVE16_RD_FIELD, MOVE16_RS_FIELD, move_insns_32, move_insn_16)
	(nop_insn_32, nop_insn_16, MATCH, find_match, relax_delay_slot)
	(IS_BITSIZE): Move over to...
	* elfxx-mips.c
	(opcode_descriptor, RA, OP32_SREG, OP32_TREG, OP16_VALID_REG)
	(b_insns_32, bc_insn_32, bz_insn_32, bzal_insn_32, beq_insn_32)
	(b_insn_16, bz_insn_16, BZ32_REG, BZ32_REG_FIELD, bz_insns_32)
	(bzc_insns_32, bz_insns_16, BZ16_REG, BZ16_REG_FIELD)
	(jal_insn_32_bd16, jal_insn_32_bd32, j_insn_32, jalr_insn_32)
	(jalr_insns_32_bd16, jalr_insns_32_bd32, ds_insns_32_bd16)
	(ds_insns_32_bd32, jalx_insn_32_bd32, jalr_insn_16_bd32)
	(jr_insn_16, JR16_REG, ds_insns_16_bd16, lui_insn, addiu_insn)
	(addiupc_insn, ADDIUPC_REG_FIELD, lwgp_insn_32, lwgp_insn_16)
	(LWGP32_REG, LWGP16_REG_FIELD, MOVE32_RD, MOVE32_RS)
	(MOVE16_RD_FIELD, MOVE16_RS_FIELD, move_insns_32, move_insn_16)
	(nop_insn_32, nop_insn_16, MATCH, find_match, relax_delay_slot)
	(IS_BITSIZE): ... here.

2011-05-03  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #10951
	bfd/
	* elfxx-mips.c (_bfd_mips_elf_symbol_processing): Replace
	assertions with warning messages.

2011-04-22  Catherine Moore  <clm@codesourcery.com>

	* release-notes-csl.xml: Fix typo in last note.

2011-04-20  Catherine Moore  <clm@codesourcery.com>

	Issue #10594

	* release-notes-csl.xml: New note.

	gas/
	* config/mips.c (mips_cl_insn): Add new field complete_p.
	(create_insn): Initialize complete_p to zero.
	(BASE_REG_EQ): New.
	(fix_24k_align_to): New.
	(fix_24k_store_info): Declare.
	(fix_24k_sort): New.
	(fix_24k_record_store_info): New.
	(nops_for_24k): New.
	(nops_for_insn): Call nops_for_24k.
	(append_insn): Move O_constant expression handling.
	
	gas/testsuite/
	* gas/mips/24k-branch-delay-1.d: New.
	* gas/mips/micromips@24k-branch-delay-1.d: New.
	* gas/mips/24k-branch-delay-1.s: New.
	* gas/mips/24k-triple-stores-1.d: New.
	* gas/mips/micromips@24k-triple-stores-1.d: New.
	* gas/mips/24k-triple-stores-1.s: New.
	* gas/mips/24k-triple-stores-2.d: New.
	* gas/mips/micromips@24k-triple-stores-2.d: New.
	* gas/mips/24k-triple-stores-2.s: New.
	* gas/mips/24k-triple-stores-3.d: New.
	* gas/mips/micromips@24k-triple-stores-3.d: New.
	* gas/mips/24k-triple-stores-3.s: New.
	* gas/mips/24k-triple-stores-4.d: New.
	* gas/mips/micromisp@24k-triple-stores-4.d: New.
	* gas/mips/24k-triple-stores-4.s: New.
	* gas/mips/24k-triple-stores-5.d: New.
	* gas/mips/micromips@24k-triple-stores-5.d: New.
	* gas/mips/24k-triple-stores-5.s: New.
	* gas/mips/24k-triple-stores-6.d: New.
	* gas/mips/micromips@24k-triple-stores-6.d: New.
	* gas/mips/24k-triple-stores-6.s: New.
	* gas/mips/24k-triple-stores-7.d: New.
	* gas/mips/micromips@24k-triple-stores-7.d: New.
	* gas/mips/24k-triple-stores-7.s: New.
	* gas/mips/24k-triple-stores-8.d: New.
	* gas/mips/micromips@24k-triple-stores-8.d: New.
	* gas/mips/24k-triple-stores-8.s: New.
	* gas/mips/micromips@24k-triple-stores-9.d: New.
	* gas/mips/24k-triple-stores-9.s: New.
	* gas/mips/micromips@24k-triple-stores-10.d: New.
	* gas/mips/24k-triple-stores-10.s: New.
	* gas/mips/24k-triple-stores-11.d: New.
	* gas/mips/micromips@24k-triple-stores-11.d: New.
	* gas/mips/24k-triple-stores-11.s: New.
	* gas/mips/mips.exp: Invoke new tests.

2011-04-15  Bernd Schmidt  <bernds@codesourcery.com>

	gas/
	* config/tc-arm.c (m_profile_p): New function.
	(parse_psr, do_t_mrs, do_t_msr): Use m_profile_p.

2011-04-15  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (do_t_swi): Do not require OS extension on ARMv7.

	gas/testsuite/
	* gas/arm/arch7m.d: New test.
	* gas/arm/arch7m.s: New test.

2011-04-12  Paul Carroll<pcarroll@codesourcery.com>

	Issue #8363

	Backport from FSF:

	binutils/testsuite/binutils-all/arm/
	* simple.s: Demo issue with objdump with multiple input files, 
	modified to build with COFF.

2011-04-08  Paul Carroll<pcarroll@codesourcery.com>

	Issue #8363

	Backport from FSF:

	include/
	* dis-asm.h: Reverting to previous version, removing ARM
	initialization function.


	opcodes/
	* disassemble.c (disassembler): Reverting to previous version,
	removing ARM initialization call.
	* arm-dis.c (print_insn): init vars moved into private_data structure.

	binutils/testsuite/binutils-all/arm/
	* binutils-all/arm/simple.s: Demo issue with objdump with
	multiple input files.
	* binutils-all/arm/objdump.exp: added new ARM test case code.


2011-04-05  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (arm_cpus): Add Cortex-R5.
	(arm_extensions): Allow idiv on ARMv7-R.
	* doc/c-arm.text: Update idiv extension restrictions.

	include/
	* opcode/arm.h (ARM_ARCH_V7R_IDIV): Define.

2011-04-04  Julian Brown  <julian@codesourcery.com>

	Issue #10874

	gas/
	* config/tc-arm.c (parse_psr): Add LHS argument. Add APSR support,
	including bitmasks for same.
	(operand_parse_code): Replace OP_PSR with OP_wPSR and OP_rPSR.
	Remove OP_RVC_PSR.
	(parse_operands): Likewise.
	(do_mrs): Tweak error message for constraint.
	(do_t_mrs): Update constraints for changes to APSR support.
	(do_t_msr): Likewise. Don't set PSR_f flag here.
	(insns): Tweak entries for msr and mrs instructions.

	opcodes/
	* arm-dis.c (psr_name): Fix typo for BASEPRI_MAX.
	(print_insn_thumb32): Add APSR bitmask support.

	gas/testsuite/
	* gas/arm/mrs-msr-thumb-v7-m.s: New.
	* gas/arm/mrs-msr-thumb-v7-m.d: New.
	* gas/arm/mrs-msr-thumb-v7-m-bad.d: New.
	* gas/arm/mrs-msr-thumb-v7-m-bad.l: New.
	* gas/arm/mrs-msr-thumb-v7-m-bad.s: New.
	* gas/arm/mrs-msr-thumb-v7e-m.d: New.
	* gas/arm/mrs-msr-thumb-v7e-m.s: New.
	* gas/arm/mrs-msr-arm-v7-a-bad.d: New.
	* gas/arm/mrs-msr-arm-v7-a-bad.l: New.
	* gas/arm/mrs-msr-arm-v7-a-bad.s: New.
	* gas/arm/mrs-msr-arm-v7-a.d: New.
	* gas/arm/mrs-msr-arm-v7-a.s: New.
	* gas/arm/mrs-msr-arm-v6.d: New.
	* gas/arm/mrs-msr-arm-v6.s: New.
	* gas/arm/mrs-msr-thumb-v6t2.d: New.
	* gas/arm/mrs-msr-thumb-v6t2.s: New.
	* gas/arm/arch7.d: Fix typo in disassembly for BASEPRI_MAX.
	* gas/arm/arch7.s: Specify bitmask for APSR writes.
	* gas/arm/archv6m.s: Likewise.

2011-04-04  Paul Brook  <paul@codesourcery.com>

	Backport from FSF:

	2010-11-15  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	PR gas/12198
	gas/
	* config/tc-arm.c (arm_arch_v6m_only): New variable.
	(aeabi_set_public_attributes): Ensure we only set the Operating System
	Extension when we are on an M-profile core.

	gas/testsuite/
	* gas/arm/pr12198-1.d: New test.
	* gas/arm/pr12918-1.s: Likewise.
	* gas/arm/pr12198-2.d: Likewise.
	* gas/arm/pr12918-2.s: Likewise.

	incude/opcode/
	* arm.h (ARM_AEXT_V6M_ONLY): New define.
	(ARM_AEXT_V6M): Rewrite in terms of ARM_AEXT_V6M_ONLY.
	(ARM_ARCH_V6M_ONLY): New define.

2011-04-04  Paul Brook   <paul@codesourcery.com>

	Backport from FSF:

	ld/testsuite/

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* ld-arm/attr-merge-6.attr: Update for Security Extensions.
	* ld-arm/attr-merge-7.attr: Likewise.

	bfd/

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* bfd-in2.h (BFD_RELOC_ARM_HVC): New enum value.

	2010-10-09  John Tytgat  <john@bass-software.com>

	* reloc.c (BFD_RELOC_ARM_HVC): Add.
	* libbfd.h: Regenerate.

	opcodes/

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	(thumb32_opcodes): Likewise.
	(banked_regname): New function.
	(print_insn_arm): Add Virtualization Extensions support.
	(print_insn_thumb32): Likewise.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm-dis.c (arm_opcodes): Support disassembly of UDIV and SDIV in
	ARM state.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm-dis.c (arm_opcodes): SMC implies Security Extensions.
	(thumb32_opcodes): Likewise.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm-dis.c (arm_opcodes): Add support for pldw.
	(thumb32_opcodes): Likewise.

	include/

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm.h (ARM_EXT_V6Z): Remove.
	(ARM_EXT_SEC): New define.
	(ARM_AEXT_V6Z): Use Security Extensions.
	(ARM_AEXT_V6ZK): Likeiwse.
	(ARM_AEXT_V6ZT2): Likewise.
	(ARM_AEXT_V6ZKT2): Likewise.
	(ARM_AEXT_V7_ARM): Base v7 does not have Security Extensions.
	(ARM_ARCH_V7A_SEC): New define.
	(ARM_ARCH_V7A_MP): Rename...
	(ARM_ARCH_V7A_MP_SEC): ...to this and add Security Extensions.

	include/opcode/

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm.h (ARM_EXT_VIRT): New define.
	(ARM_ARCH_V7A_IDIV_MP_SEC): Rename...
	(ARM_ARCH_V7A_IDIV_MP_SEC_VIRT): ...to this and include Virtualization
	Extensions.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm.h (ARM_AEXT_ADIV): New define.
	(ARM_ARCH_V7A_IDIV_MP_SEC): Likewise.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm.h (ARM_EXT_OS): New define.
	(ARM_AEXT_V6SM): Likewise.
	(ARM_ARCH_V6SM): Likewise.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* arm.h (ARM_EXT_MP): Add.
	(ARM_ARCH_V7A_MP): Likewise.

	teastsuite/

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* gas/arm/armv7-a+virt.d: New test.
	* gas/arm/armv7-a+virt.s: Likewise.
	* gas/arm/attr-march-all.d: Update for Virtualization Extensions.
	* gas/arm/attr-march-armv7-a+sec+virt.d: New test.
	* gas/arm/attr-march-armv7-a+virt.d: Likewise.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* gas/arm/armv7-a+idiv.d: New test.
	* gas/arm/armv7-a+idiv.s: Likewise.
	* gas/arm/attr-march-all.d: Update for Integer divide extension.
	* gas/arm/attr-march-armv7-a+idiv.d: New test.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* gas/arm/archv6s-m-bad.d: New test.
	* gas/arm/archv6s-m-bad.l: Likewise.
	* gas/arm/archv6s-m.d: Likewise.
	* gas/arm/archv6s-m.s: Likewise.
	* gas/arm/attr-march-armv6-m+os.d: Likewise.
	* gas/arm/attr-march-armv6s-m.d: Likewise.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* gas/arm/attr-march-all.d: Update for Security Extensions..
	* gas/arm/attr-march-armv6k+sec.d: New test.
	* gas/arm/attr-march-armv6z.d: Update for Security Extensions.
	* gas/arm/attr-march-armv6zk.d: Likewise.
	* gas/arm/attr-march-armv6zkt2.d: Likewise.
	* gas/arm/attr-march-armv6zt2.d: Likewise.
	* gas/arm/attr-march-armv7-a+sec.d: New test.
	* gas/arm/attr-mcpu.d: Update for Security Extensions.
	* gas/arm/thumb32.d: Likewise.
	* gas/arm/thumb32.s: Likewise.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* gas/arm/arch7a-mp.d: Add.
	* gas/arm/arch7ar-mp.s: Likewise.
	* gas/arm/arch7r-mp.d: Likewise.
	* gas/arm/armv2-mp-bad.d: Likewise.
	* gas/arm/armv2-mp-bad.l: Likewise.
	* gas/arm/attr-march-all.d: Update for MP extension.
	* gas/arm/attr-march-armv7-a+mp.d: Add.
	* gas/arm/attr-march-armv7-r+mp.d: Likewise.

	gas/

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* config/tc-arm.c (arm_ext_virt): New variable.
	(arm_reg_type): Add REG_TYPE_RNB for banked registers.
	(reg_entry): Allow registers to be larger than a byte.
	(reg_alias): Fix type warning.
	(parse_operands): Parse banked registers when appropriate.
	(do_mrs): Add support for Virtualization Extensions.
	(do_hvc): New function.
	(do_t_mrs): Add support for Virtualization Extensions.
	(do_t_msr): Likewise.
	(do_t_hvc): New function.
	(SPLRBANK): New define.
	(reg_names): Add banked registers.
	(insns): Add support for Virtualization Extensions.
	(md_apply_fixup): Likewise.
	(arm_cpus): -mcpu=cortex-a15 implies the Virtualization Extensions.
	(arm_extensions): Add 'virt' extension.
	(aeabi_set_public_attributes): Add support for Virtualization
	Extensions.
	* doc/c-arm.texi: Document 'virt' extension.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* config/tc-arm.c (arm_ext_adiv): New variable.
	(do_div): New function.
	(insns): Accept UDIV and SDIV in ARM state.
	(arm_cpus): The cortex-a15 option has all current v7-A extensions.
	(arm_extensions): Add 'idiv' extension.
	(aeabi_set_public_attributes): Update Tag_DIV_use values for the
	Integer Divide extension.
	* doc/c-arm.texi: Document the idiv extension.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* config/tc-arm.c (arm_ext_v6m): New variable.
	(arm_ext_m): Add support for OS extension.
	(arm_ext_os): New variable.
	(do_t_swi): In v6-M ensure we have the OS extension.
	(arm_cpus): The cortex-m1 and cortex-m0 options have the OS 
	extension by default.
	(arm_archs): Add armv6s-m.
	(arm_extensions): Add 'os' extension.
	(cpu_arch_ver): Add support for v6S-M.
	* doc/c-arm.texi: Document the OS Extension, and v6-m and v6s-m
	architecture options.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* config/tc-arm.c (arm_ext_v6z): Remove.
	(arm_ext_sec): New variable.
	(do_t_smc): In Thumb state SMC requires v7-A.
	(insns): Make SMC depend on Security Extensions.
	(arm_cpus): All -mcpu=cortex-a* options have the Security Extensions.
	(arm_extensions): Add 'sec' extension.
	(cpu_arch_ver): Reorder.
	(aeabi_set_public_attributes): Emit Tag_Virtualization_use as
	appropriate.
	* doc/c-arm.texi: Document Security Extensions.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* config/tc-arm.c (arm_ext_mp): Add.
	(do_pld): Update comment.
	(insns): Add support for pldw.
	(arm_cpus): Update cortex-a5, cortex-a9, and cortex-a15 to support
	MP extension.
	(arm_extensions): Add 'mp' extension.
	(aeabi_set_public_attributes): Emit correct build attribute when
	MP extension is enabled.
	* doc/c-arm.texi: Update for MP extensions.

	2010-09-23  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* config/tc-arm.c (md_pseduo_table): Add .arch_extension directive.
	(arm_option_extension_value_table): Add.
	(arm_extensions): Change type.
	(arm_option_cpu_table): Rename...
	(arm_option_fpu_table): ...to this.
	(arm_fpus): Change type.
	(arm_parse_extension): Enforce alphabetical order.  Allow 
	extensions to be removed.
	(arm_parse_arch): Allow extensions to be specified with -march.
	(s_arm_arch_extension): Add.
	(s_arm_fpu): Update for type changes.
	* doc/c-arm.texi: Document changes to infrastructure.

2011-04-04  Paul Brook   <paul@codesourcery.com>

	Backport from FSF:

	2010-09-20  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	gas/
	* config/tc-arm.c (arm_cpus): Correct canonical names for Cortex CPUs.

	gas/testsuite/
	* gas/arm/attr-cpu-directive.d: Update test for change in canonical
	CPU name.
	* gas/arm/attr-mcpu.d: Likewise.

	ld/
	* ld-arm/attr-merge-6.attr: Update test for change in canonical CPU
	name.
	* ld-arm/attr-merge-7.attr: Likewise.
	* ld-arm/attr-merge-2.attr: Likewise.
	* ld-arm/attr-merge-arch-2.attr: Likewise.

2011-04-04  Paul Brook   <paul@codesourcery.com>

	Backport from FSF:

	2010-09-09  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* config/tc-arm.c (arm_cpus): Add cortex-a15 entry.
	* doc/c-arm.texi: Document -mcpu=cortex-a15.

2011-04-04  Paul Brook   <paul@codesourcery.com>
 
	Revert Marvell binutils support
	gas/
	* config/tc-arm.c (arm_ext_marvell_f, do_marvell_div): Remove
	(insns): Remove ARM mode udiv/sdiv.
	(arm_cpus): Remove marvell-f.
	(arm_archs): Remove marvell-f.

	gas/testsuite/
	* gas/arm/attr-march-marvell-f.d: Remove.
	* gas/arm/marvell-f-div.d: Remove.
	* gas/arm/marvell-f-div.s: Remove.

	include/opcode/
	* arm.h (ARM_CEXT_MARVELL_F, ARM_ARCH_MARVELL_F): Remove.

2011-03-30  Catherine Moore  <clm@codesourcery.com>

	Issue #10835

	* release-notes-csl.xml: Document addr2line bug fix.

2011-03-30  Catherine Moore  <clm@codesourcery.com>

	Issue #10835

	* addr2line.c (translate_addresses): Sign extend the pc
	if sign_extend_vma is enabled.

2011-03-29 Catherine Moore  <clm@codesourcery.com>

	Issue #10144

	gas/testsuite/
	* gas/mips/micromips@mips32-dsp.d: Add \ to dots.
	* gas/mips/micromips@mips32-dspr2.d: Likewise.

2011-03-29 Catherine Moore  <clm@codesourcery.com>

	Issue #10144

	gas/testsuite/
	* gas/mips/micromips@mips32-dsp.d: New.
	* gas/mips/micromips@mips32-dspr2.d: New.
	* gas/mips/mips32-dsp.d: Remove -mips32r2.
	* gas/mips/mips32-dspr2.d: Likewise.
	* gas/mips/mips.exp: (mips_create_arch): Use -mips64r2
	for micromips.gedit
	Use run_dump_test_arches to run dsp tests.

2011-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #10166

	ld/
	* emulparams/{elf64btsmip_sym32.sh, elf64ltsmip_sym32.sh}: New
	emulations which are compatible with 32-bit symbols.
	* configure.tgt: Enable new emulations for mips*-*-linux-*.
	* Makefile.am: Update.
	* Makefile.in: Regenerate.

2011-03-22  Chao-Ying Fu <fu@mips.com>
            Catherine Moore <clm@codesourcery.com>

	Issue #10144

	* release-notes-csl.xml: New note.

	gas/
	* config/tc-mips.c (micromips_ip): Support microMIPS
	DSP instructions.
	(micromips_macro_build): Likewise.
	(micromips_macro): Likewise.

	include/
	* opcode/mips.h (MICROMIPSOP_SH_DSPACC): Define.
	MICROMIPSOP_MASK_DSPACC: Define.
	MICROMIPSOP_SH_WRDSP): Define.
	MICROMIPSOP_MASK_WRDSP): Define.
	MICROMIPSOP_SH_BP): Define.
	MICROMIPSOP_MASK_BP): Define.
	MICROMIPSOP_SH_IMM10): Define.
	(MICROMIPSOP_MASK_IMM10): Define.
	(MICROMIPSOP_SH_IMM8): Define.
	(MICROMIPSOP_MASK_IMM8): Define.
	(MICROMIPSOP_SH_DSPSFT): Define.
	(MICROMIPSOP_MASK_DSPSFT): Define.
	(MICROMIPSOP_SH_SA4): Define.
	(MICROMIPSOP_MASK_SA4): Define.
	(MICROMIPSOP_SH_SA3): Define.
	(MICROMIPSOP_MASK_SA3): Define.

	opcodes/
	* micromips-opc.c (WR_a): Define.
	(RD_a): Define.
	(MOD_a): Define.
	(DSP_VOLA): Define.
	(D32): Define.
	(D33): Define.
	(micromips_opcodes): Add microMIPS DSP opcodes.
	* micromips-dis.c (print_insn_micromips): Disassemble
	microMIPS DSP instructions.

2011-03-22  Joseph Myers  <joseph@codesourcery.com>

	* release-notes-csl.xml (Objdump fix for multiple input files):
	Restrict release note to ARM targets.

2011-03-08  Paul Carroll <pcarroll@codesourcery.com>

	Issue #8363

	include/
	* dis-asm.h: Added extern for new arm disassembler initialization

	opcodes/
	* disassemble.c (disassembler): Added call to initialize the ARM
	disassembler so it can process a new input file
	* arm-dis.c (initialize_arm_disassemble): New routine to initialize
	some variables that are used during disassembly of an input file

	binutils/testsuite/binutils-all/arm/
	* simple.s: Simple ARM test case for testing multiple input files
	* objdump.exp: Added test for passing objdump multiple input files

2011-02-03  Paul Carroll <pcarroll@codesourcery.com>

	Issue #6163

	gas/
	* config/tc-arm.c
	(encode_thumb32_shifted_operand): Added constraint for shift
	type and value for Thumb2 ADD{S} and SUB{S} instructions.
	(do_t_add_sub): Passing flag into encode_thumb32_shifted_operand()
	if first 2 register operands are both SP.
	(do_t_arit3, do_t_arit3c, do_t_mov_cmp, do_t_mvn_tst, do_t_orn)
	(do_t_rsb, do_t_shift): Adding FALSE argument to encode calls
	since that argument is not used by them.

	gas/testsuite/gas/arm/
	* add.s, add.d, addthumb2.s, addthumb2.d: Valid ADD{S} and
	SUB{S} operands.
	* addthumb2err.s, addthumb2err.d, addthumb2err.l: Invalid ADD{S}
	and SUB{S} operands.

2011-02-02  Maciej W. Rozycki  <macro@codesourcery.com>

	Revert:

	2011-01-30  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.c (plt_entry): Adjust comments for MIPS16 PLT
	support removal.
	(mips_elf_link_hash_table): Likewise.
	(mips16_o32_exec_plt_entry): Remove variable.
	(micromips_o32_exec_plt_entry): Rename to...
	(comp_o32_exec_plt_entry): ... this.
	(mips_elf_calculate_relocation): Remove MIPS16 PLT support.
	(_bfd_mips_elf_create_dynamic_sections): Likewise.
	(_bfd_mips_elf_check_relocs): Likewise.
	(_bfd_mips_elf_adjust_dynamic_symbol): Likewise.
	(_bfd_mips_elf_finish_dynamic_symbol): Likewise.
	(_bfd_mips_elf_get_synthetic_symtab): Likewise.

	opcodes/
	* mips-dis.c (_print_insn_mips): Remove MIPS16 PLT support.

	* release-notes-csl.xml
	(Improved MIPS16 and microMIPS library call support): Rename
	to...
	(Improved microMIPS library call support): ... this.  Adjust for
	MIPS16 PLT support removal.

2011-01-30  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.c (plt_entry): Adjust comments for MIPS16 PLT
	support removal.
	(mips_elf_link_hash_table): Likewise.
	(mips16_o32_exec_plt_entry): Remove variable.
	(micromips_o32_exec_plt_entry): Rename to...
	(comp_o32_exec_plt_entry): ... this.
	(mips_elf_calculate_relocation): Remove MIPS16 PLT support.
	(_bfd_mips_elf_create_dynamic_sections): Likewise.
	(_bfd_mips_elf_check_relocs): Likewise.
	(_bfd_mips_elf_adjust_dynamic_symbol): Likewise.
	(_bfd_mips_elf_finish_dynamic_symbol): Likewise.
	(_bfd_mips_elf_get_synthetic_symtab): Likewise.

	opcodes/
	* mips-dis.c (_print_insn_mips): Remove MIPS16 PLT support.

	* release-notes-csl.xml
	(Improved MIPS16 and microMIPS library call support): Rename
	to...
	(Improved microMIPS library call support): ... this.  Adjust for
	MIPS16 PLT support removal.

2011-01-28  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elfxx-mips.h (_bfd_mips_elf_get_synthetic_symtab): New
	prototype.
	* elfxx-mips.c (plt_entry): New structure.
	(mips_elf_link_hash_entry): Add has_plt_entry member.
	(mips_elf_link_hash_table): Rename plt_entry_size member to
	plt_mips_entry_size.  Add plt_comp_entry_size, plt_mips_offset,
	plt_comp_offset and plt_got_index entries.
	(mips_exec_plt_entry): Update comment.
	(mips16_o32_exec_plt_entry): New variable.
	(micromips_o32_exec_plt_entry): Likewise.
	(mips_elf_link_hash_newfunc): Initialise has_plt_entry.
	(mips_elf_output_extsym): Update to use gotplt_union's plist
	member rather than offset.
	(mips_elf_gotplt_index): Likewise.  Remove the VxWorks
	restriction.
	(mips_elf_calculate_relocation): Handle MIPS16/microMIPS PLT
	entries.
	(_bfd_mips_elf_create_dynamic_sections): Likewise.
	(mips_elf_allocate_lazy_stub): Likewise.
	(_bfd_mips_vxworks_finish_dynamic_symbol): Likewise.
	(mips_elf_make_plt_record): New function.
	(_bfd_mips_elf_check_relocs): Update comment.  Record occurences
	of JAL relocations that might need a PLT entry.
	(_bfd_mips_elf_adjust_dynamic_symbol): Update to use
	gotplt_union's plist member rather than offset.  Handle
	MIPS16/microMIPS PLT entries.
	(_bfd_mips_elf_finish_dynamic_symbol): Likewise.
	(_bfd_mips_elf_link_hash_table_create): Update to use
	gotplt_union's plist member rather than offset.  Initialize new
	members of mips_elf_link_hash_table.
	(_bfd_mips_elf_get_synthetic_symtab): New function.
	* elf32-mips.c (elf_backend_plt_sym_val): Remove macro.
	(bfd_elf32_get_synthetic_symtab): New macro.

	ld/
	* scripttempl/elf.sc: Handle $INITIAL_READWRITE_SECTIONS and
	$PLT_NEXT_DATA variables.
	* emulparams/elf32btsmip.sh: Arrange for .got.plt to be placed
	as close to .plt as possible.

	ld/testsuite/
	* ld-mips-elf/jalx-2.dd: Update for microMIPS PLT entries support.

	opcodes/
	* mips-dis.c (is_micromips_mode_p): Handle microMIPS PLT entries.
	(_print_insn_mips): Handle MIPS16 PLT entries.

	* release-notes-csl.xml
	(Improved MIPS16 and microMIPS library call support): New.

2011-01-28  Maciej W. Rozycki  <macro@codesourcery.com>

	ld/testsuite/
	* ld-mips-elf/jalx-2.ld: Include .rel.plt in output.  Place the
	other sections in the expected order.
	* ld-mips-elf/jalx-2.dd: Adjust disassembly accordingly.

2011-01-19  Catherine Moore  <clm@codesourcery.com>

	Issue #10367

	Backport from mainline:

	opcodes/
	2010-10-25  Chao-ying Fu  <fu@mips.com>
	* mips-opc.c (madd, maddu, msub, msubu, mult, multu): Change D33 to D32.

	gas/testsuite/
	2010-10-25  Chao-ying Fu  <fu@mips.com>
	* gas/mips/mips32-dsp.d, gas/mips/mips32-dsp.s: Add madd, maddu, msub,
	msubu, mult, multu.

2011-01-11  Kwok Cheung Yeung  <kcy@codesourcery.com>

	Issue #10336

	gas/
	* config/tc-arm.c: Fix spurious uninitialized variable warning.

2010-12-06  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #10049

	bfd/
	* elf32-mips.c (RA, OP32_SREG, OP32_TREG): New macros.
	(bc_insn_32, bz_insn_32, bzal_insn_32): New variables.
	(beq_insn_32, bz_insn_16): Likewise.
	(BZ16_VALID_REG): Rename macro to...
	(OP16_VALID_REG): ... this.
	(BZ16_REG): New macro.
	(j_insn_32, jalr_insn_32, jalx_insn_32_bd32): New variables.
	(jr_insn_16): Likewise.
	(JR16_REG): New macro.
	(ADDIU_REG, ADDIUPC_VALID_REG, LWGP16_VALID_REG): Remove macros.
	(elf32_mips_relax_section): Restrict HI16/LO16 relaxation.

	* release-notes-csl.xml
	(microMIPS linker code size optimization bug fix): New.

2010-11-25  Bernd Schmidt  <bernds@codesourcery.com>

	Backport from FSF:

	bfd/
	* elf-bfd.h (struct bfd_elf_section_reloc_data): New structure.
	(struct bfd_elf_section_data): New members REL and RELA; delete
	members REL_HDR, REL_HDR2, REL_COUNT, REL_COUNT2, REL_IDX,
	REL_IDX2, REL_HASHES.
	(_bfd_elf_init_reloc_shdr): Adjust declaration.
	(_bfd_elf_single_rel_hdr): Declare.
	(RELOC_AGAINST_DISCARDED_SECTION): Use it.
	* elf.c (bfd_section_from_shdr): Adjusted to match changes in
	data structures.
	(_bfd_elf_init_reloc_shdr): New arg RELDATA.  Remove arg REL_HDR.
	All callers changed.  Allocate memory for the Elf_Internal_Shdr
	structure.
	(_bfd_elf_single_rel_hdr): New function.
	(struct fake_section_arg): New structure.
	(elf_fake_section): Expect to see a pointer to it in the third
	argument.  If doing a relocatable link, allocate both REL and RELA
	sections as needed.
	(assign_section_numbers): Adjusted to match changes in
	data structures.
	(_bfd_elf_compute_section_file_positions): Call elf_fake_sections
	with a struct fake_section_args argument.
	* elfcode.h (elf_write_relocs): Adjusted to match changes in
	data structures.
	(elf_slurp_reloc_table): Likewise.
	* elflink.c (_bfd_elf_link_read_relocs): Likewise.
	(_bfd_elf_link_size_reloc_section): Remove arg REL_HDR, replace with
	RELDATA.  Remove argument O.  All callers changed.  Remove code to
	discover the right rel_hdr and count.
	(_bfd_elf_link_output_relocs): Adjusted to match changes in
	data structures.
	(elf_link_adjust_relocs): Remove args REL_HDR, COUNT and REL_HASH;
	replace with RELDATA.  All callers changed.
	(elf_link_input_bfd): Correctly generate rel_hash data when both
	REL and RELA sections are present.
	(elf_reloc_link_order): Adjusted to match changes in
	data structures.
	(bfd_elf_final_link): Simplify code to count relocs.  Free the
	hashes array for both REL and RELA.
	(get_dynamic_reloc_section_name): Use _bfd_elf_single_reloc_hdr
	* elf32-m32r.c (m32r_elf_fake_sections, elf_backend_fake_sections):
	Delete.
	* elf32-tic6x.c (elf32_tic6x_fake_sections, elf_backend_fake_sections):
	Delete.
	(elf32_tic6x_rel_relocation_p): Adjusted to match changes in
	data structures.
	* elf32-microblaze.c (microblaze_elf_check_relocs): Use
	_bfd_elf_single_rel_hdr.
	* elf32-ppc.c (ppc_elf_relax_section): Likewise.
	* elf32-spu.c (spu_elf_relocate_section): Likewise.
	* elf64-alpha.c (elf64_alpha_relocate_section): Likewise.
	* elf64-hppa.c (get_reloc_section): Likewise.
	* elf64-mips.c (mips_elf64_slurp_reloc_table): Adjusted to match
	changes in data structures.
	(mips_elf64_write_relocs): Use _bfd_elf_single_rel_hdr.
	* elf64-ppc.c (ppc64_elf_edit_opd): Likewise.
	(ppc64_elf_edit_toc): Likewise.
	(get_relocs): Adjusted to match changes in data structures.
	Allocate an Elf_Internal_Shdr structure if necessary.
	(ppc64_elf_finish_dynamic_sections): Use _bfd_elf_single_rel_hdr.
	* elf64-sparc.c (elf64_sparc_slurp_reloc_table): Adjusted to match
	changes in data structures.
	* elfxx-ia64.c (get_reloc_section): Use _bfd_elf_single_rel_hdr.
	* elfxx-mips.c (MIPS_RELOC_RELA_P): Remove macro.
	(mips_elf_rel_relocation_p): Adjusted to match changes in data
	structures.
	(_bfd_mips_elf_relocate_section): Use mips_elf_rel_relocation_p rather
	than MIPS_RELOC_RELOCA_P.
	* elfxx-sparc.c (_bfd_sparc_elf_check_relocs): Use
	_bfd_elf_single_rel_hdr.
	(_bfd_sparc_elf_relocate_section): Likewise.

	ld/
	* emultempl/xtensaelf.em (replace_insn_sec_with_prop_sec): Use
	_bfd_elf_single_rel_hdr.

2010-11-24  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10085
	opcodes/
	* arm-dis.c (thumb32_opcodes): BLX must have bit zero clear.

	gas/testsuite/
	* gas/arm/blx-bad.s: New.
	* gas/arm/blx-bad.d: New.

2010-11-23  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	* config/tc-mips.c (macro)
	[M_ACLR_AB, M_ACLR_OB, M_ASET_AB, M_ASET_OB]: Correct bit index
	decoding.

	gas/testsuite/
	* gas/mips/mcu.d: Correct patterns according to the bit index
	decoding fix.

	opcodes/
	* mips-opc.c (mips_builtin_opcodes): Add TRAP annotation to
	"aclr", "aset" and "iret".  Remove LDD annotation from "aclr"
	and "aset".
	* micromips-opc.c (micromips_opcodes): Likewise.

	* release-notes-csl.xml
	(MCU ASE instructions assembler bug fixes): New.

2010-11-06  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #10034 - thumb2 TLS descriptor

	bfd/
	* elf32-arm.c (elf32_arm_final_link_relocate): Round blx offset to
	word for R_ARM_THM_TLS_DESCSEQ.

	ld/testsuite/
	* ld-arm/tls-longplt-lib.d: Fixup.
	* ld-arm/tls-gdesc.d: Fixup.
	* ld-arm/tls-thumb1.d: Fixup.
	* ld-arm/tls-longplt.d: Fixup.	

2010-11-04  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	2010-11-04  Joseph Myers  <joseph@codesourcery.com>

	* elf-attrs.c (_bfd_elf_merge_unknown_attribute_low,
	_bfd_elf_merge_unknown_attribute_list): New.
	* elf-bfd.h (struct elf_backend_data): Add
	obj_attrs_handle_unknown.
	(_bfd_elf_merge_unknown_attribute_low,
	_bfd_elf_merge_unknown_attribute_list): Declare.
	* elf32-arm.c (elf32_arm_obj_attrs_handle_unknown): New.  Split
	out from elf32_arm_merge_eabi_attributes.
	(elf32_arm_merge_eabi_attributes): Use
	_bfd_elf_merge_unknown_attribute_low and
	_bfd_elf_merge_unknown_attribute_list.
	(elf_backend_obj_attrs_handle_unknown): Define.
	* elfxx-target.h (elf_backend_obj_attrs_handle_unknown): Define.
	(elfNN_bed): Update initializer.

2010-11-02  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	2010-11-02  Joseph Myers  <joseph@codesourcery.com>

	* elf32-tic6x.c (elf32_tic6x_obj_attrs_arg_type): Except for
	Tag_ABI_compatibility, treat odd tags as strings and even ones as
	integers.
	(elf32_tic6x_obj_attrs_order, elf32_tic6x_tag_to_array_alignment,
	elf32_tic6x_array_alignment_to_tag): New.
	(elf32_tic6x_merge_attributes): Handle more attributes.  Set type
	for merged attributes.
	(elf_backend_obj_attrs_order): Define.

	binutils/
	2010-11-02  Joseph Myers  <joseph@codesourcery.com>

	* readelf.c (display_tic6x_attribute): Handle more attributes.

	gas/
	2010-11-02  Joseph Myers  <joseph@codesourcery.com>

	* config/tc-tic6x.c (OPTION_MPID, OPTION_MPIC, OPTION_MNO_PIC):
	New enum values.
	(md_longopts): Add options mpid, mpic and mno-pic.
	(tic6x_pid_type, tic6x_pid, tic6x_pic, tic6x_pid_type_table,
	tic6x_pid_types, tic6x_use_pid): New.
	(md_parse_option): Handle new options.
	(md_show_usage): Output help text for new options.
	(tic6x_set_attributes): Set PID and PIC attributes.
	* doc/as.texinfo: Document -mpid=, -mpic and -mno-pic.
	* doc/c-tic6x.texi (TIC6X Options): Likewise.

	gas/testsuite/
	2010-11-02  Joseph Myers  <joseph@codesourcery.com>

	* gas/tic6x/attr-array-directive-1.d,
	gas/tic6x/attr-array-directive-1.s,
	gas/tic6x/attr-array-directive-2.d,
	gas/tic6x/attr-array-directive-2.s,
	gas/tic6x/attr-array-directive-3.d,
	gas/tic6x/attr-array-directive-3.s,
	gas/tic6x/attr-array-directive-4.d,
	gas/tic6x/attr-array-directive-4.s,
	gas/tic6x/attr-conformance-directive-1.d,
	gas/tic6x/attr-conformance-directive-1.s,
	gas/tic6x/attr-conformance-directive-2.d,
	gas/tic6x/attr-conformance-directive-2.s,
	gas/tic6x/attr-pic-directive-1.d,
	gas/tic6x/attr-pic-directive-1.s,
	gas/tic6x/attr-pic-directive-2.d,
	gas/tic6x/attr-pic-directive-2.s,
	gas/tic6x/attr-pic-opts-mno-pic.d, gas/tic6x/attr-pic-opts-mpic.d,
	gas/tic6x/attr-pid-directive-1.d,
	gas/tic6x/attr-pid-directive-1.s,
	gas/tic6x/attr-pid-directive-2.d,
	gas/tic6x/attr-pid-directive-2.s,
	gas/tic6x/attr-pid-opts-mpid-far.d,
	gas/tic6x/attr-pid-opts-mpid-near.d,
	gas/tic6x/attr-pid-opts-mpid-no.d,
	gas/tic6x/attr-stack-directive-1.d,
	gas/tic6x/attr-stack-directive-1.s,
	gas/tic6x/attr-stack-directive-2.d,
	gas/tic6x/attr-stack-directive-2.s,
	gas/tic6x/attr-wchar-directive-1.d,
	gas/tic6x/attr-wchar-directive-1.s,
	gas/tic6x/attr-wchar-directive-2.d,
	gas/tic6x/attr-wchar-directive-2.s: New tests.

	include/elf/
	2010-11-02  Joseph Myers  <joseph@codesourcery.com>

	* tic6x-attrs.h (Tag_ABI_wchar_t, Tag_ABI_stack_align_needed,
	Tag_ABI_stack_align_preserved, Tag_ABI_PID, Tag_ABI_PIC,
	Tag_ABI_array_object_alignment,
	Tag_ABI_array_object_align_expected, Tag_ABI_conformance): Define.

	ld/testsuite/
	2010-11-02  Joseph Myers  <joseph@codesourcery.com>

	* ld-tic6x/attr-array-16-16.d, ld-tic6x/attr-array-16-4.d,
	ld-tic6x/attr-array-16-416.d, ld-tic6x/attr-array-16-48.d,
	ld-tic6x/attr-array-16-8.d, ld-tic6x/attr-array-16-816.d,
	ld-tic6x/attr-array-16.s, ld-tic6x/attr-array-4-16.d,
	ld-tic6x/attr-array-4-4.d, ld-tic6x/attr-array-4-416.d,
	ld-tic6x/attr-array-4-48.d, ld-tic6x/attr-array-4-8.d,
	ld-tic6x/attr-array-4-816.d, ld-tic6x/attr-array-4.s,
	ld-tic6x/attr-array-416-16.d, ld-tic6x/attr-array-416-4.d,
	ld-tic6x/attr-array-416-416.d, ld-tic6x/attr-array-416-48.d,
	ld-tic6x/attr-array-416-8.d, ld-tic6x/attr-array-416-816.d,
	ld-tic6x/attr-array-416.s, ld-tic6x/attr-array-48-16.d,
	ld-tic6x/attr-array-48-4.d, ld-tic6x/attr-array-48-416.d,
	ld-tic6x/attr-array-48-48.d, ld-tic6x/attr-array-48-8.d,
	ld-tic6x/attr-array-48-816.d, ld-tic6x/attr-array-48.s,
	ld-tic6x/attr-array-8-16.d, ld-tic6x/attr-array-8-4.d,
	ld-tic6x/attr-array-8-416.d, ld-tic6x/attr-array-8-48.d,
	ld-tic6x/attr-array-8-8.d, ld-tic6x/attr-array-8-816.d,
	ld-tic6x/attr-array-8.s, ld-tic6x/attr-array-816-16.d,
	ld-tic6x/attr-array-816-4.d, ld-tic6x/attr-array-816-416.d,
	ld-tic6x/attr-array-816-48.d, ld-tic6x/attr-array-816-8.d,
	ld-tic6x/attr-array-816-816.d, ld-tic6x/attr-array-816.s,
	ld-tic6x/attr-conformance-10-10.d,
	ld-tic6x/attr-conformance-10-11.d,
	ld-tic6x/attr-conformance-10-none.d,
	ld-tic6x/attr-conformance-10.s, ld-tic6x/attr-conformance-11-10.d,
	ld-tic6x/attr-conformance-11-11.d,
	ld-tic6x/attr-conformance-11-none.d,
	ld-tic6x/attr-conformance-11.s,
	ld-tic6x/attr-conformance-none-10.d,
	ld-tic6x/attr-conformance-none-11.d,
	ld-tic6x/attr-conformance-none-none.d,
	ld-tic6x/attr-conformance-none.s, ld-tic6x/attr-pic-0.s,
	ld-tic6x/attr-pic-00.d, ld-tic6x/attr-pic-01.d,
	ld-tic6x/attr-pic-1.s, ld-tic6x/attr-pic-10.d,
	ld-tic6x/attr-pic-11.d, ld-tic6x/attr-pid-0.s,
	ld-tic6x/attr-pid-00.d, ld-tic6x/attr-pid-01.d,
	ld-tic6x/attr-pid-02.d, ld-tic6x/attr-pid-1.s,
	ld-tic6x/attr-pid-10.d, ld-tic6x/attr-pid-11.d,
	ld-tic6x/attr-pid-12.d, ld-tic6x/attr-pid-2.s,
	ld-tic6x/attr-pid-20.d, ld-tic6x/attr-pid-21.d,
	ld-tic6x/attr-pid-22.d, ld-tic6x/attr-stack-16-16.d,
	ld-tic6x/attr-stack-16-8.d, ld-tic6x/attr-stack-16-816.d,
	ld-tic6x/attr-stack-16.s, ld-tic6x/attr-stack-8-16.d,
	ld-tic6x/attr-stack-8-8.d, ld-tic6x/attr-stack-8-816.d,
	ld-tic6x/attr-stack-8.s, ld-tic6x/attr-stack-816-16.d,
	ld-tic6x/attr-stack-816-8.d, ld-tic6x/attr-stack-816-816.d,
	ld-tic6x/attr-stack-816.s, ld-tic6x/attr-wchar-0.s,
	ld-tic6x/attr-wchar-00.d, ld-tic6x/attr-wchar-01.d,
	ld-tic6x/attr-wchar-02.d, ld-tic6x/attr-wchar-1.s,
	ld-tic6x/attr-wchar-10.d, ld-tic6x/attr-wchar-11.d,
	ld-tic6x/attr-wchar-12.d, ld-tic6x/attr-wchar-2.s,
	ld-tic6x/attr-wchar-20.d, ld-tic6x/attr-wchar-21.d,
	ld-tic6x/attr-wchar-22.d: New tests.

2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	* elf32-tic6x.c (elf32_tic6x_obj_attrs_arg_type): Check
	Tag_ABI_compatibility not Tag_compatibility.
	(elf32_tic6x_merge_attributes): Update compatibility attribute
	name in comment.  Return FALSE if merging common attributes fails.

	binutils/
	2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	* readelf.c (display_tic6x_attribute): Use Tag_ABI_compatibility
	not hardcoded 32.  Display name of this attribute.

	gas/
	2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	* doc/c-tic6x.texi (TIC6X Directives): Mention
	Tag_ABI_compatibility.

	gas/testsuite/
	2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	* gas/tic6x/attr-compatibility-directive-1.d,
	gas/tic6x/attr-compatibility-directive-1.s,
	gas/tic6x/attr-compatibility-directive-2.d,
	gas/tic6x/attr-compatibility-directive-2.s: New tests.

	include/elf/
	2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	* tic6x-attrs.h (Tag_ABI_compatibility): Define.

	ld/testsuite/
	2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	* ld-tic6x/attr-compatibility-gnu-gnu.d,
	ld-tic6x/attr-compatibility-gnu-other.d,
	ld-tic6x/attr-compatibility-gnu.s,
	ld-tic6x/attr-compatibility-other-gnu.d,
	ld-tic6x/attr-compatibility-other-other.d,
	ld-tic6x/attr-compatibility-other.s: New tests.

2010-10-29  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	2010-10-29  Bernd Schmidt  <bernds@codesourcery.com>
	            Joseph Myers  <joseph@codesourcery.com>

	* elf32-tic6x.c (elf32_tic6x_merge_attributes): Check for mismatch
	of DSBT attributes.

	binutils/
	2010-10-29  Bernd Schmidt  <bernds@codesourcery.com>
	            Joseph Myers  <joseph@codesourcery.com>

	* readelf.c (display_tic6x_attribute): Handle Tag_ABI_DSBT.

	gas/
	2010-10-29  Bernd Schmidt  <bernds@codesourcery.com>
	            Joseph Myers  <joseph@codesourcery.com>

	* config/tc-tic6x.c (OPTION_MDSBT, OPTION_MNO_DSBT): New enum
	values.
	(md_longopts): Add mdsbt and mno-dsbt.
	(tic6x_dsbt): New static variable.
	(md_parse_option): Handle OPTION_MDSBT and OPTION_MNO_DSBT.
	(md_show_usage): Output help text for -mdsbt and -mno-dsbt.
	(TAG): Add comma at the end.
	(tic6x_set_attributes): Set Tag_ABI_DSBT.
	* doc/as.texinfo: Document -mdsbt and -mno-dsbt.
	* doc/c-tic6x.texi (TIC6X Options): Likewise.
	(TIC6X Directives): Mention Tag_ABI_DSBT.

	gas/testsuite/
	2010-10-29  Bernd Schmidt  <bernds@codesourcery.com>
	            Joseph Myers  <joseph@codesourcery.com>

	* gas/tic6x/attr-dsbt-directive-1.d,
	gas/tic6x/attr-dsbt-directive-1.s,
	gas/tic6x/attr-dsbt-directive-2.d,
	gas/tic6x/attr-dsbt-directive-2.s,
	gas/tic6x/attr-dsbt-opts-mdsbt.d,
	gas/tic6x/attr-dsbt-opts-mno-dsbt.d: New tests.

	include/elf/
	2010-10-29  Bernd Schmidt  <bernds@codesourcery.com>
	            Joseph Myers  <joseph@codesourcery.com>

	* tic6x-attrs.h (Tag_ABI_DSBT): New.

	ld/testsuite/
	2010-10-29  Bernd Schmidt  <bernds@codesourcery.com>
	            Joseph Myers  <joseph@codesourcery.com>

	* ld-tic6x/attr-dsbt-0.s, ld-tic6x/attr-dsbt-00.d,
	ld-tic6x/attr-dsbt-01.d, ld-tic6x/attr-dsbt-1.s,
	ld-tic6x/attr-dsbt-10.d, ld-tic6x/attr-dsbt-11.d: New tests.

2010-10-25  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #9823 - Broken .debug_ranges sections

	* release-notes-csl.xml (Linker debug information fix): New note.

	bfd/
	* elf-bfd.h (RELOC_AGAINST_DISCARDED_SECTION): Always call
	_bfd_clear_contents.  Pass it the input section.
	* libbfd-in.h (_bfd_clear_contents): Add input_section argument.
	* libbfd.h: Regenerate.
	* reloc.c (_bfd_clear_contents): Take input_section argument.
	Use non-zero for .debug_ranges.
	(bfd_generic_get_relocated_section_conten): Update _bfd_clear_contents
	call.

	* elf32-arm.c (elf32_arm_relocate_section): Use
	RELOC_AGAINST_DISCARDED_SECTION.
	* elf-m10200.c (mn10200_elf_relocate_section): Likewise.
	* elf-m10300.c (mn10300_elf_relocate_section): Likewise.
	* elf32-arm.c (elf32_arm_relocate_section): Likewise.
	* elf32-avr.c (elf32_avr_relocate_section): Likewise.
	* elf32-bfin.c (bfin_relocate_section): Likewise.
	(bfinfdpic_relocate_section): Likewise.
	* elf32-cr16.c (elf32_cr16_relocate_section): Likewise.
	* elf32-cr16c.c (elf32_cr16c_relocate_section): Likewise.
	* elf32-cris.c (cris_elf_relocate_section): Likewise.
	* elf32-crx.c (elf32_crx_relocate_section): Likewise.
	* elf32-d10v.c (elf32_d10v_relocate_section): Likewise.
	* elf32-fr30.c (fr30_elf_relocate_section): Likewise.
	* elf32-frv.c (elf32_frv_relocate_section): Likewise.
	* elf32-h8300.c (elf32_h8_relocate_section): Likewise.
	* elf32-hppa.c (elf32_hppa_relocate_section): Likewise.
	* elf32-i370.c (i370_elf_relocate_section): Likewise.
	* elf32-i860.c (elf32_i860_relocate_section): Likewise.
	* elf32-ip2k.c (ip2k_elf_relocate_section): Likewise.
	* elf32-iq2000.c (iq2000_elf_relocate_section): Likewise.
	* elf32-lm32.c (lm32_elf_relocate_section): Likewise.
	* elf32-m32c.c (m32c_elf_relocate_section): Likewise.
	* elf32-m32r.c (m32r_elf_relocate_section): Likewise.
	* elf32-m68hc1x.c (elf32_m68hc11_relocate_section): Likewise.
	* elf32-m68k.c (elf_m68k_relocate_section): Likewise.
	* elf32-mcore.c (mcore_elf_relocate_section): Likewise.
	* elf32-mep.c (mep_elf_relocate_section): Likewise.
	* elf32-moxie.c (moxie_elf_relocate_section): Likewise.
	* elf32-msp430.c (elf32_msp430_relocate_section): Likewise.
	* elf32-mt.c (mt_elf_relocate_section): Likewise.
	* elf32-openrisc.c (openrisc_elf_relocate_section): Likewise.
	* elf32-ppc.c (ppc_elf_relocate_section): Likewise.
	* elf32-rx.c (rx_elf_relocate_section): Likewise.
	* elf32-s390.c (elf_s390_relocate_section): Likewise.
	* elf32-score.c (s3_bfd_score_elf_relocate_section): Likewise.
	* elf32-score7.c (s7_bfd_score_elf_relocate_section): Likewise.
	* elf32-sh.c (sh_elf_relocate_section): Likewise.
	* elf32-spu.c (spu_elf_relocate_section): Likewise.
	* elf32-tic6x.c (elf32_tic6x_relocate_section): Likewise.
	* elf32-v850.c (v850_elf_relocate_section): Likewise.
	* elf32-vax.c (elf_vax_relocate_section): Likewise.
	* elf32-xc16x.c (elf32_xc16x_relocate_section): Likewise.
	* elf32-xstormy16.c (xstormy16_elf_relocate_section): Likewise.
	* elf32-xtensa.c (elf_xtensa_relocate_section): Likewise.
	* elf64-alpha.c (elf64_alpha_relocate_section_r): Likewise.
	(elf64_alpha_relocate_section): Likewise.
	* elf64-hppa.c (elf64_hppa_relocate_section): Likewise.
	* elf64-mmix.c (mmix_elf_relocate_section): Likewise.
	* elf64-ppc.c (ppc64_elf_relocate_section): Likewise.
	* elf64-s390.c (elf_s390_relocate_section): Likewise.
	* elf64-sh64.c (sh_elf64_relocate_section): Likewise.
	* elfxx-ia64.c (elfNN_ia64_relocate_section): Likewise.
	* elfxx-mips.c (_bfd_mips_elf_relocate_section): Likewise.
	* elfxx-sparc.c (_bfd_sparc_elf_relocate_section): Likewise.

	ld/testsuite/
	* ld-discard/zero-range.d, ld-discard/zero-range.s: New files.

2010-10-25  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #9744

	bfd/
	* cpu-powerpc.c (bfd_powerpc_archs): Add "powerpc:e5500" entry.

	opcodes/
	* ppc-dis.c (ppc_opts): Add "e5500" entry.

	gas/
	* config/tc-ppc.c (md_show_usage): Convert second e500mc64 entry to
	e5500.

2010-10-25  Paul Brook  <paul@codesourcery.com>

	Issue #9050

	ld/testsuite/
	* ld-arm/cortex-a8-far.d: Adjust expected output.
	* ld-arm/arm-call1.s: Give function symbol correct type.
	* ld-arm/arm-call2.s: Ditto.
	* ld-arm/farcall-group4.s: Ditto.
	* ld-arm/arm-elf.exp (cortex-a8-far): Define far symbols with correct
	type via assembly file.
	* cortex-a8-far-3.s: New file.
	* ld-arm/abs-call-1.d: Add interworking tests.
	
	bfd/
	* elf32-arm.c (is_thumb_func): New function.
	(arm_type_of_stub, arm_build_one_stub, cortex_a8_erratum_scan,
	elf32_arm_size_stubs, bfd_elf32_arm_process_before_allocation,
	elf32_arm_final_link_relocate): Use is_thumb_func.

2010-10-23  Mark Mitchell  <mark@codesourcery.com>

	Issue #9820
	Backport from mainline:
	2010-10-23  Mark Mitchell  <mark@codesourcery.com>
	* config/obj-elf.c (elf_adjust_symtab): New.  Move group section
	processing here from elf_frob_file.  Ensure that group signature
	symbols have the name of the group.
	(elf_frob_file): Move group section processing to
	elf_adjust_symtab.
	* config/obj-elf.h (elf_adjust_symtab): Declare.
	(obj_adjust_symtab): Define.
	* config/tc-arm.c (arm_adjust_symtab): Call elf_adjust_symtab.
	2010-10-23  Mark Mitchell  <mark@codesourcery.com>
	* gas/elf/elf.exp: Add group0c test.
	* gas/elf/group0c.d: New.
	* gas/elf/group0a.d: Expect ".group" for the name of group
	sections.
	* gas/elf/group0b.d: Likewise.
	* gas/elf/group1a.d: Likewise.
	* gas/elf/group1b.d: Likewise.
	* gas/elf/groupautoa.d: Likewise.
	* gas/elf/groupautob.d: Likewise.
	* gas/elf/section4.d: Likewise.
	* gas/ia64/group-1.d: Likewise.  Adjust hard-coded constants.
	2010-10-22  Mark Mitchell  <mark@codesourcery.com>
	* binutils-all/group-5.d: Expect ".group" for the name of group
	sections.
	* binutils-all/strip-2.d: Likewise.
	2010-10-23  Mark Mitchell  <mark@codesourcery.com>
	* ld-elf/group10.d: Expect ".group" for the name of group
	sections.
	* ld-elf/group2.d: Likewise.
	* ld-elf/group7.d: Likewise.

2010-10-22  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (do_t_branch): Avoid relaxing branches to constant
	addresses.

2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gas/
	2010-09-09  Joseph Myers  <joseph@codesourcery.com>

	* doc/c-tic6x.texi (.c6xabi_attribute): Document directive.

	bfd/
	2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	* elf32-tic6x.c (elf32_tic6x_merge_arch_attributes): Update for
	attribute renaming.
	(elf_backend_obj_attrs_section): Change to ".c6xabi.attributes".

	binutils/
	2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	* readelf.c (display_tic6x_attribute): Update for attribute
	renaming.

	gas/
	2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	* config/tc-tic6x.c (tic6x_arch_attribute, tic6x_arches,
	md_assemble, tic6x_set_attributes): Update for attribute renaming.
	* doc/c-tic6x.texi: Update for attribute renaming.

	gas/testsuite/
	2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	* gas/tic6x/attr-arch-directive-1.d,
	gas/tic6x/attr-arch-directive-2.d,
	gas/tic6x/attr-arch-directive-3.d,
	gas/tic6x/attr-arch-directive-4.d,
	gas/tic6x/attr-arch-directive-4.s,
	gas/tic6x/attr-arch-directive-5.d,
	gas/tic6x/attr-arch-directive-5.s,
	gas/tic6x/attr-arch-opts-c62x.d, gas/tic6x/attr-arch-opts-c64x+.d,
	gas/tic6x/attr-arch-opts-c64x.d, gas/tic6x/attr-arch-opts-c674x.d,
	gas/tic6x/attr-arch-opts-c67x+.d, gas/tic6x/attr-arch-opts-c67x.d,
	gas/tic6x/attr-arch-opts-none-1.d,
	gas/tic6x/attr-arch-opts-none-2.d,
	gas/tic6x/attr-arch-opts-override-1.d,
	gas/tic6x/attr-arch-opts-override-2.d: Update for attribute
	renaming and renumbering.

	include/elf/
	2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	* tic6x-attrs.h (Tag_C6XABI_Tag_CPU_arch): Change to Tag_ISA,
	value 4.
	* tic6x.h (Values for Tag_C6XABI_Tag_CPU_arch): Rename for
	attribute renaming.

	ld/
	2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	* emulparams/elf32_tic6x_le.sh (ATTRS_SECTIONS): Use
	.c6xabi.attributes, not __TI_build_attributes.

	ld/testsuite/
	2010-10-21  Joseph Myers  <joseph@codesourcery.com>

	* ld-tic6x/attr-arch-c62x-c62x.d, ld-tic6x/attr-arch-c62x-c64x+.d,
	ld-tic6x/attr-arch-c62x-c64x.d, ld-tic6x/attr-arch-c62x-c674x.d,
	ld-tic6x/attr-arch-c62x-c67x+.d, ld-tic6x/attr-arch-c62x-c67x.d,
	ld-tic6x/attr-arch-c64x+-c62x.d, ld-tic6x/attr-arch-c64x+-c64x+.d,
	ld-tic6x/attr-arch-c64x+-c64x.d, ld-tic6x/attr-arch-c64x+-c674x.d,
	ld-tic6x/attr-arch-c64x+-c67x+.d, ld-tic6x/attr-arch-c64x+-c67x.d,
	ld-tic6x/attr-arch-c64x-c62x.d, ld-tic6x/attr-arch-c64x-c64x+.d,
	ld-tic6x/attr-arch-c64x-c64x.d, ld-tic6x/attr-arch-c64x-c674x.d,
	ld-tic6x/attr-arch-c64x-c67x+.d, ld-tic6x/attr-arch-c64x-c67x.d,
	ld-tic6x/attr-arch-c674x-c62x.d, ld-tic6x/attr-arch-c674x-c64x+.d,
	ld-tic6x/attr-arch-c674x-c64x.d, ld-tic6x/attr-arch-c674x-c674x.d,
	ld-tic6x/attr-arch-c674x-c67x+.d, ld-tic6x/attr-arch-c674x-c67x.d,
	ld-tic6x/attr-arch-c67x+-c62x.d, ld-tic6x/attr-arch-c67x+-c64x+.d,
	ld-tic6x/attr-arch-c67x+-c64x.d, ld-tic6x/attr-arch-c67x+-c674x.d,
	ld-tic6x/attr-arch-c67x+-c67x+.d, ld-tic6x/attr-arch-c67x+-c67x.d,
	ld-tic6x/attr-arch-c67x-c62x.d, ld-tic6x/attr-arch-c67x-c64x+.d,
	ld-tic6x/attr-arch-c67x-c64x.d, ld-tic6x/attr-arch-c67x-c674x.d,
	ld-tic6x/attr-arch-c67x-c67x+.d, ld-tic6x/attr-arch-c67x-c67x.d:
	Update for attribute renaming.

2010-10-16  Kazu Hirata  <kazu@codesourcery.com>

	Issue #9826
	Backport from mainline:
	gas/
	2010-09-09  Nick Clifton  <nickc@redhat.com>
	PR gas/11972
	* config/tc-arm.c (parse_big_immediate): Allow for bignums being
	extended to the size of a .octa.

	* release-notes-csl.xml: Document the bug fix above.

2010-10-15  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8612

	gas/
	* config/tc-arm.c (fix_new_arm): Create an absolute symbol for
	pc-relative fixes to constants.
	* config/tc-arm.h (TC_FORCE_RELOCATATION_ABS): Define.
	
	ld/testsuite/
	* ld-arm/abs-call-1.d: New.
	* ld-arm/abs-call-1.s: New.
	* ld-arm/arm-elf.exp: Add it.

	* release-notes-csl.xml: Document.

2010-10-13  Nathan Sidwell  <nathan@codesourcery.com>
	    Glauber de Oliveira Costa  <glommer@gmail.com>

	Issue #8915
	bfd/
	* reloc.c (BFD_RELOC_ARM_TLS_GOTDESC, BFD_RELOC_ARM_TLS_CALL,
	BFD_RELOC_ARM_THM_TLS_CALL, BFD_RELOC_ARM_TLS_DESCSEQ,
	BFD_RELOC_ARM_THM_TLS_DESCSEQ, BFD_RELOC_ARM_TLS_DESC): New
	relocations.
	* libbfd.h: Rebuilt.
	* bfd-in2.h: Rebuilt.
	* elf32-arm.c (elf32_arm_howto_table_1): Add new relocations.
	(elf32_arm_reloc_map): Likewise.
	(tls_trampoline, dl_tlsdesc_lazy_trampoline): New PLT templates.
	(elf32_arm_stub_long_branch_any_tls_pic,
	elf32_arm_stub_long_branch_v4t_thumb_tls_pic): New stub templates.
	(DEF_STUBS): Add new stubs.
	(struct_elf_arm_obj_data): Add local_tlsdesc_gotent field.
	(elf32_arm_local_tlsdesc_gotent): New.
	(GOT_TLS_GDESC): New mask.
	(GOT_TLS_GD_ANY): Define.
	(struct elf32_arm_link_hash_entry): Add tlsdesc_got field.
	(elf32_arm_compute_jump_table_size): New.
	(struct elf32_arm_link_hash_table): Add next_tls_desc_index,
	num_tls_desc, dt_tlsdesc_plt, dt_tlsdesc_got, tls_trampoline,
	sgotplt_jump_table_size fields.
	(elf32_arm_link_hash_newfunc): Initialize tlsdesc_got field.
	(elf32_arm_link_hash_table_create): Initialize new fields.
	(arm_type_of_stub): Check TLS desc relocs too.
	(elf32_arm_stub_name): TLS desc relocs can be shared.
	(elf32_arm_tls_transition): Determine relaxation.
	(arm_stub_required_alignment): Add tls stubs.
	(elf32_arm_size_stubs): Likewise.
	(elf32_arm_tls_relax): Perform TLS relaxing.
	(elf32_arm_final_link_relocate): Process TLS DESC relocations.
	(IS_ARM_TLS_GNU_RELOC): New.
	(IS_ARM_TLS_RELOC): Use it.
	(elf32_arm_relocate_section): Perform TLS relaxing.
	(elf32_arm_check_relocs): Anticipate TLS relaxing, process tls
	desc relocations.
	(allocate_dynrelocs): Allocate tls desc relcoations.
	(elf32_arm_output_arch_local_syms): Emit tls trampoline mapping
	symbols.
	(elf32_arm_size_dynamic_sections): Allocate tls trampolines and
	got slots.
	(elf32_arm_always_size_sections): New. Create _TLS_MODULE_BASE
	symbol.
	(elf32_arm_finish_dynamic_symbol): Adjust.
	(arm_put_trampoline): New.
	(elf32_arm_finish_dynamic_sections): Emit new dynamic tags and tls
	trampolines.
	(elf_backend_always_size_sections): Define.

	gas/
	* doc/c-arm.texi: Document TLSDESC and TLSCALL relocations, and
	.tlsdescseq directive.
	* config/tc-arm.c (arm_typed_reg_parse): Check for potential reloc
	following a symbol.
	(s_arm_tls_descseq): New directive.
	(md_pseudo_table): Add it.
	(encode_branch): Allow TLS_CALL relocs too.
	(do_t_blx, do_t_branch23): Use encode_branch.
	(reloc_names): Add tlsdesc and tlscall.
	(md_apply_fix): Process tls desc relocations.
	(tc_gen_reloc): Likewise.
	(arm_fix_adjustable): Likewise.

	include/elf/
	* arm.h (R_ARM_TLS_DESC, R_ARM_TLS_GOTDESC, R_ARM_TLS_CALL,
	R_ARM_TLS_DESCSEQ, T_ARM_THM_TLS_CALL, R_ARM_THM_TLS_DESCSEQ): New
	relocations.

	gas/testsuite/
	* gas/arm/tls.s: Add tlsdesc tests.
	* gas/arm/tls.d: Adjust.

	ld/testsuite/
	* ld-arm/arm-elf.exp: Added tests for new TLS handling
	relocations.
	* ld-arm/tls-descrelax-be32.d: New.
	* ld-arm/tls-descrelax-be32.s: New.
	* ld-arm/tls-descrelax-be8.d: New.
	* ld-arm/tls-descrelax-be8.s: New.
	* ld-arm/tls-descrelax-v7.d: New.
	* ld-arm/tls-descrelax-v7.s: New.
	* ld-arm/tls-descrelax.d: New.
	* ld-arm/tls-descrelax.s: New.
	* ld-arm/tls-descseq.d: New.
	* ld-arm/tls-descseq.r: New.
	* ld-arm/tls-descseq.s: New.
	* ld-arm/tls-gdesc-got.d: New.
	* ld-arm/tls-gdesc-got.s: New.
	* ld-arm/tls-gdesc-nlazy.g: New.
	* ld-arm/tls-gdesc-nlazy.s: New.
	* ld-arm/tls-gdesc.d: New.
	* ld-arm/tls-gdesc.r: New.
	* ld-arm/tls-gdesc.s: New.
	* ld-arm/tls-gdierelax.d: New.
	* ld-arm/tls-gdierelax.s: New.
	* ld-arm/tls-gdierelax2.d: New.
	* ld-arm/tls-gdierelax2.s: New.
	* ld-arm/tls-gdlerelax.d: New.
	* ld-arm/tls-gdlerelax.s: New.
	* ld-arm/tls-lib-loc.d: New.
	* ld-arm/tls-lib-loc.r: New.
	* ld-arm/tls-lib-loc.s: New.
	* ld-arm/tls-longplt-lib.d: New.
	* ld-arm/tls-longplt-lib.s: New.
	* ld-arm/tls-longplt.d: New.
	* ld-arm/tls-longplt.s: New.
	* ld-arm/tls-mixed.r: New.
	* ld-arm/tls-mixed.s: New.
	* ld-arm/tls-thumb1.d: New.
	* ld-arm/tls-thumb1.s: New.
	* ld-arm/arm-elf.exp: New.
	* ld-arm/tls-lib.d: New.
	* ld-arm/tls-lib.r: New.
	* ld-arm/tls-lib.s: New.

2010-10-12  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #9400
	* release-notes-csl.xml (C++ code bloat with -g): Rewrite note
	so it's easier to parse.
	(Strip bug fix): Likewise.

2010-10-12  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Port lib32 arangement from Debian.

	ld/
	* emulparams/elf_i386.sh: Include lib32 directories in library search
	path.

2010-10-11  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #8612

	Backport from mainline HEAD:

	bfd/
	2010-10-11  Thomas Schwinge  <thomas@codesourcery.com>

	* elf32-arm.c (elf32_arm_final_link_relocate)
	(elf32_arm_relocate_section): Handle relocations against STN_UNDEF.

2010-10-07  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #8612

	Backport from mainline HEAD:

	bfd/
	2010-10-01  Thomas Schwinge  <thomas@codesourcery.com>

	* elf32-arm.c (elf32_arm_size_stubs): Don't choke on local symbols in
	SHN_UNDEF, SHN_ABS, SHN_COMMON.

2010-10-07  Bernd Schmidt  <bernds@codesourcery.com>

	gas/
	* config/tc-tic6x.c (tic6x_try_encode): Correct encoding of fstg field
	in SPKERNEL instructions.

	opcodes/
	* tic6x-dis.c (print_insn_tic6x): Correct decoding of fstg field
	in SPKERNEL instructions.

	gas/testsuite/
	* gas/tic6x/insns-c674x-sploop.d: Add two more sploop/spkernel tests.
	* gas/tic6x/insns-c674x-sploop.s: Likewise.

2010-10-06  Nathan Sidwell  <nathan@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_stub_long_branch_any_arm_pic, 
	elf32_arm_stub_long_branch_any_arm_pic): Use a consistent name for
	ip/r12.
	(arm_type_of_stub): Remove superfluous braces.

	gas/
	* config/tc-arm.c (encode_branch): Remove superfluous braces.
	(do_t_branch): Move reloc setting to end of routine.

2010-09-29  Bernd Schmidt  <bernds@codesourcery.com>

	include/
	* opcode/tic6x-control-registers.h (tscl): Now read_write.

	gas/testsuite/
	* gas/tic6x/insns-bad-1.s: Remove test for readonly tscl.
	* gas/tic6x/insns-bad-1.l: Likewise.
	* gas/tic6x/insns-c674x.d: Add test for writeable tscl.
	* gas/tic6x/insns-c674x.s: Likewise.

	Changes made earlier but ChangeLog.csl not committed:
	gas/
	* config/tc-tic6x.c (tic6x_fix_adjustable): New function.
	* config/tc-tic6x.h (tic6x_fix_adjustable): Declare.
	(tc_fix_adjustable): New macro.

	gas/testsuite/
	* gas/tic6x/got-reloc.s: New test.
	* gas/tic6x/got-reloc.d: New test.

2010-09-28  Chao-ying Fu  <fu@mips.com>

	Issue #9656

	include/opcode/
	* mips.h (MICROMIPSOP_MASK_COPZ): Widen to 23 bits.
	(MICROMIPSOP_SH_COPZ): Update accordingly.

	opcodes/
	* micromips-opc.c (CP): New macro.
	(micromips_opcodes): Fix mask and pinfo of "cop2".

	gas/
	* tc-mips.c (micromips_ip): Widen coprocessor code to 23 bits.

	gas/testsuite/
	* mips/micromips.l: Remove coprocessor code warning.
	* mips/micromips.d: Update "cop2" encoding.
	* mips/micromips-trap.d: Likewise.
	* mips/micromips@mips32-cp2.d: Likewise.

	* release-notes-csl.xml (COP2 instruction bug fix): New.

2010-09-24  Joseph Myers  <joseph@codesourcery.com>

	Merge <http://sourceware.org/ml/binutils/2010-09/msg00444.html>:

	bfd/
	2010-09-23  H.J. Lu  <hongjiu.lu@intel.com>

	PR ld/11812
	* elf32-i386.c (elf_i386_size_dynamic_sections): Don't
	 allocate .got.plt section if there are no GOT nor PLT
	 entries and there is no refeence to _GLOBAL_OFFSET_TABLE_.
	 * elf64-x86-64.c (elf64_x86_64_size_dynamic_sections): Li.kewise.

	* elflink.c (_bfd_elf_create_got_section): Clear non_elf on
	_GLOBAL_OFFSET_TABLE_.

	ld/testsuite/
	2010-09-23  H.J. Lu  <hongjiu.lu@intel.com>

	PR ld/11812
	* ld-i386/nogot1.s: Don't use GOTOFF.

2010-09-23  Bernd Schmidt  <bernds@codesourcery.com>

	bfd/
	* elf32-tic6x.c (elf32_tic6x_fake_sections): New function.
	(elf_backend_fake_sections): Define.

	ld/testsuite/
	* ld-tic6x/pcrel-reloc-local-r-rel-rela.d: New test.

2010-09-16  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #9430

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_check_relocs)
	[R_MIPS_32, R_MIPS_REL32, R_MIPS_64]: Ignore relocs from
	SEC_DEBUGGING sections.

	ld/testsuite/
	* lib/ld-lib.exp (run_ld_link_tests): Handle sources from other
	directories.
	(run_ld_link_exec_tests): Likewise.
	(run_cc_link_tests): Likewise.
	* ld-elf/comm-data1.sd: New test.
	* ld-elf/comm-data1.s: Source for the new test.
	* ld-elf/comm-data2.sd: New test.
	* ld-elf/comm-data2.rd: Likewise.
	* ld-elf/comm-data2.xd: Likewise.
	* ld-elf/comm-data2.s: Source for the new tests.
	* ld-elf/comm-data.exp: Run the new tests.
	* ld-mips-elf/comm-data.exp: Likewise.

	* release-notes-csl.xml (Linker bug fix): New.

2010-09-15  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #8897
	* release-notes-csl.xml: Add note.

	bfd/
	* elf32-m68k.c (elf_m68k_finish_dynamic_symbol): Read relocation value
	for R_68K_TLS_GD32 from the correct offset within the GOT.

	ld/testsuite/
	* ld-m68k/tls-gd-3.[sd]: New test.

2010-09-15  Jie Zhang  <jie@codesourcery.com>

	Backport from mainline:

	gas/
	2010-09-14  Jie Zhang  <jie@codesourcery.com>
	* doc/c-arm.texi: Document -mcpu=cortex-m4.

2010-09-09  Nathan Sidwell  <nathan@codesourcery.com>

	ld/testsuite/
	Revert previous patch, it was LD_RUN_PATH's fault.

	ld/testsuite/
	* ld-arm/cortex-a8-fix-bl-rel-plt.d: Adjust and robustify.
	* ld-arm/farcall-mixed-lib-v4t.d: Likewise.
	* ld-arm/tls-app.d: Likewise.
	* ld-arm/farcall-mixed-lib.d: Likewise.
	* ld-arm/farcall-mixed-app-v5.d: Likewise.
	* ld-arm/farcall-mixed-app.d: Likewise.
	* ld-arm/tls-lib.d: Likewise.

2010-09-09  Bernd Schmidt  <bernds@codesourcery.com>

	bfd/
	* elflink.c (bfd_elf_final_link): Correct calculation of
	max_external_reloc_size.

2010-09-03  Kazu Hirata  <kazu@codesourcery.com>

	Issue #8579
	libiberty/
	* pex-win32.c (pex_win32_exec_child): Move calls to _close() to
	the end of the function.

2010-09-01  Catherine Moore  <clm@codesourcery.com>

	* release-notes-csl.xml: Correct typo.

2010-08-27  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #7945

	* release-notes-csl.xml: New note.

	Backport from mainline:

	opcodes/
	2010-08-27  Nathan Froyd  <froydnj@codesourcery.com>

	* ppc-opc.c (powerpc_opcodes) [lswx,lswi,stswx,stswi]: Deprecate
	on E500 and E500MC.

2010-08-25  Jie Zhang  <jie@codesourcery.com>

	Issue #9210

	* release-notes-csl.xml: Document.

	Backport from mainline:

	gas/
	2010-08-25  Jie Zhang  <jie@codesourcery.com>
	* config/tc-arm.c (encode_arm_addr_mode_2): Fix comment.

	2010-08-25  Jie Zhang  <jie@codesourcery.com>
	* config/tc-arm.c (encode_arm_addr_mode_2): Fix
	BAD_PC_ADDRESSING condition.

	gas/testsuite/
	2010-08-25  Jie Zhang  <jie@codesourcery.com>
	* gas/arm/ldst-pc.d: New test.
	* gas/arm/ldst-pc.s: New test.
	* gas/arm/sp-pc-validations-bad.s: `str r0,[pc,#4]' is valid.
	* gas/arm/sp-pc-validations-bad.l: Adjust accordingly.

2010-08-25  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #9285

	bfd/
	* elf32-arm.c (elf32_arm_final_link): Process stub sections
	exactly once.

2010-08-25  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elf32-mips.c (mips_elf_gprel32_reloc): Reformat comment.
	(elf_backend_plt_sym_val): Move undefinition earlier on.
	* elfxx-mips.c (NON_PIC_P, NON_PIC_TO_PIC_STUB_SECTION_NAME):
	Remove macros.
	(_bfd_mips_elf_check_relocs): Adjust comment.  Remove
	non_got_ref references.  Reformat a switch statement.
	(_bfd_mips_elf_merge_private_bfd_data): Don't skip dynamic
	objects.
	* elfxx-mips.h (_bfd_mips_nonpic_finish_dynamic_symbol): Remove
	prototype.

	gas/
	* config/tc-mips.c (OPTION_NON_PIC_ABICALLS): Remove enum value.
	(md_longopts): Redefine "mnon-pic-abicalls" with
	OPTION_CALL_NONPIC.
	(md_parse_option)[OPTION_NON_PIC_ABICALLS]: Remove switch case.

2010-08-24  Joseph Myers  <joseph@codesourcery.com>

	Issue #9270

	Revert:

	2007-05-10  Carlos O'Donell  <carlos@codesourcery.com>

	* Makefile.tpl: Add install-pdf to install target deps.
	* Makefile.in: Regenerate.

2010-08-24  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #9286
	bfd/
	* elfxx-mips.c (_bfd_mips_elf_check_relocs): Handle
	R_MICROMIPS_JALR relocs.

2010-08-21  Maciej W. Rozycki  <macro@codesourcery.com>

	* release-notes-csl.xml (Binutils update): New.

2010-08-20  Catherine Moore  <clm@codesourcery.com>

	gas/
	* config/mips/tc-mips.c (mips_cpu_info):
	Reformat the 34kn entry.

2010-08-20  Catherine Moore  <clm@codesourcery.com>

	Issue #9258

	gas/
	* config/mips/tc-mips.c (mips_cpu_info):  Add the 34kn.

2010-08-09  Catherine Moore  <clm@codesourcery.com>

	Issue #9100

	* release-notes-csl.xml: New note.

	bfd/
	* elfxx-mips.c (mips_elf_perform_relocation): Improve
	interlinking error message.

	ld/testsuite/
	* ld-mips-elf/mode-change-error-1.d: New.
	* ld-mips-elf/mode-change-error-1a.s: New.
	* ld-mips-elf/mode-change-error-1b.s: New.
	* ld-mips-elf/mips-elf.exp: Run new test.

2010-08-09  Maciej W. Rozycki  <macro@codesourcery.com>

	ld/
	* Makefile.am (eshlelf_fd.c): Correct the name of the emulation
	and the tool directory.
	* Makefile.in: Regenerate.

2010-08-05  Julian Brown  <julian@codesourcery.com>

	* release-notes-csl.xml (ARMv7-A linker bug fix): New note.

	bfd/
	* elf32-arm.c (arm_stub_required_alignment): New.
	(arm_build_one_stub): Use above to partition stubs.

	ld/testsuite/
	* ld-arm/arm-elf.exp (armelftests): Add cortex-a8-fix-blx-bcond.s.
	* ld-arm/cortex-a8-fix-blx-bcond.s: New.
	* ld-arm/cortex-a8-fix-blx-bcond.d: New.

2010-08-03  Daniel Jacobowitz  <dan@codesourcery.com>
	    Sandra Loosemore <sandra@codesourcery.com>

	Issue #9152

	* release-notes-csl.xml (C++ code bloat with -g): New note.

	gas/
	* dw2gencfi.c (CFI_EMIT_eh_frame, CFI_EMIT_debug_frame)
	(cfi_sections): Move earlier.
	(dot_cfi_personality): Do not create a symbol unless generating
	.eh_frame.

2010-07-23  Julian Brown  <julian@codesourcery.com>

	bfd/
	* elf32-arm.c (arm_stub_required_alignment): New.
	(arm_build_one_stub): Use above to partition stubs.

	ld/testsuite/
	* ld-arm/arm-elf.exp (armelftests): Add cortex-a8-fix-blx-bcond.s.
	* ld-arm/cortex-a8-fix-blx-bcond.s: New.
	* ld-arm/cortex-a8-fix-blx-bcond.d: New.

2010-07-23  Julian Brown  <julian@codesourcery.com>

	bfd/
	* elf32-arm.c (make_branch_to_a8_stub): Use arm_stub_a8_veneer_lwm
	instead of arm_stub_a8_veneer_b_cond.

2010-07-22  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #8927

	Switch MIPS to 32-bit DWARF format.
	* gas/config/tc-mips.h (DWARF2_FORMAT): Only define for [TE_IRIX].
	* gas/config/tc-mips.c (mips_dwarf2_format): Likewise.

2010-07-07  Rhonda Wittels  <rhonda@codesourcery.com>

	Issue #4268 

	gas/
	* config/obj-elf.c (get_sym_from_input_line_and_check): New
	function to catch missing pseudo-op arguments.
	(obj_elf_local): Call new function.
	(obj_elf_weak): Likewise.
	(obj_elf_visibility): Likewise.
	(obj_elf_vtable_entry): Likewise.
	(obj_elf_type): Likewise.

	gas/testsuite/
	* gas/elf/pseudo.s: New.
	* gas/elf/pseudo.l: New.
	* gas/elf/pseudo.d: New.
	* gas/elf/elf.exp: Run the new test.

	* release-notes-csl.xml: Document.

2010-07-06  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 8843 - disassembly

	opcodes/
	* arm-dis.c (print_arm_address): Show -0 offset encodings.
	(print_insn_arm): Likewise.

	gas/testsuite/
	* gas/arm/offset-1.s: New.
	* gas/arm/offset-1.d: New.

2010-07-06  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #8895
	gas/testsuite/
	* gas/mips/mips.exp: Remove "mips" property.  Use
	[mips_arch_list_all] to run the elf-rel27 test.

2010-07-02  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/mips.exp: Fix formatting.

2010-07-01  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #8895

	Backport from FSF:
	gas/
	2009-12-07  H.J. Lu  <hongjiu.lu@intel.com>
	PR gas/11037
	* symbols.c (symbol_same_p): New.
	* symbols.h (symbol_same_p): Likewise.

	gas/
	* config/tc-mips.c (mips_frob_file): Use symbol_same_p to match
	symbols.

	gas/testsuite/
	* gas/mips/elf-rel27.d: New test for HI16/LO16 relocation
	pairing.
	* gas/mips/elf-rel27.s: Source for the new test.
	* gas/mips/mips.exp: Create "mips16" architecture.  Define
	"mips" property.  Adjust conditions involving negated properties
	throughout to require "mips1" as appropriate.  Run the new test.
	(mips_arch_destroy): New procedure.

	* release-notes-csl.xml
	(Fix for incorrect MIPS16 and microMIPS relocations): New.

2010-06-30  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8983

	bfd/
	* cpu-powerpc.c (bfd_powerpc_archs): Fix next pointer for
	powerpc:750.

	* release-notes-csl.xml: Document.

2010-06-22  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8941

	bfd/
	* archive64.c (bfd_elf64_archive_write_armap): Fix buffer overrun
	when scaning map.

	* release-notes-csl.xml: Document.

2010-06-23  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 8170
	gas/
	* config/tc-arm.c (md_assemble): Adjust error from upstream.

	gas/testsuite/
	* gas/arm/thumb-w-bad.l: Likewise.

2010-06-16  Nathan Froyd  <froydnj@codesourcery.com>

	ld/
	* configure.tgt (powerpc*-*-elf*): Define targ64_extra_emuls and
	targ64_extra_libpath.

2010-06-16  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from upstream:

	bfd/
	2009-12-09  Edmar Wienskoski  <edmar@freescale.com>

	* archures.c: Add bfd_mach_ppc_e500mc64.
	* bfd-in2.h: Regenerate.
	* cpu-powerpc.c (bfd_powerpc_archs): Add entry for
	bfd_mach_ppc_e500mc64.

	gas/
	2009-12-09  Edmar Wienskoski  <edmar@freescale.com>

	* config/tc-ppc.c (md_show_usage): Document -me500mc64.

	opcodes/
	2009-12-09  Edmar Wienskoski  <edmar@freescale.com>

	* ppc-dis.c (ppc_opts): Add entry for "e500mc64".

	opcodes/
	2010-02-24  Edmar Wienskoski  <edmar@freescale.com>

	* ppc-dis.c (ppc_opts): Add PPC_OPCODE_E500MC for "e500mc64".

2010-06-09  Paul Brook  <paul@codesourcery.com>

	Issue #8775 - PC relative LDR from global symbol.
	gas/
	* config/tc-arm.c (arm_force_relocation): Resolve all pc-relative
	loads.

	gas/testsuite/
	* gas/arm/ldr-global.d: New test.
	* gas/arm/ldr-global.s: New test.

2010-06-07  Maciej W. Rozycki  <macro@codesourcery.com>

	ld/testsuite/
	* ld-mips-elf/jalx-2.dd: Adjust patterns.

2010-06-02  Catherine Moore  <clm@codesourcery.com>

	ld/testsuite/ld-mips-elf/
	* jalx-2.ld: New linker script.
	* mips-elf.exp (jalx-2): Link with new script.
	* jalx-2.dd: Update expected output.

2010-06-02  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 8836
	bfd/
	* elf32-m69k.c (elf32_m68k_print_private_bfd_data): Dectec EMAC_B
	variant.

	binutils/
	* readelf.c (get_machine_flags): Detect CF ISA C and EMAC_B
	variants.

	* release-notes-csl.xml: Document it.

2010-05-27  Catherine Moore  <clm@codesourcery.com>

	gas/
	* config/tc-mips.c (is_opcode_valid): Remove use of expansionp.
	(micromips_ip): Change invocation of is_opcode_valid.
	(micromips_macro_build): Likewise.

2010-05-26  Catherine Moore  <clm@codesourcery.com>

	opcodes/
	mips-opc.c: Change membership to I1 for ehb instruction.

2010-05-26  Catherine Moore  <clm@codesourcery.com>

	gas/
	* config/tc-mips.c (is_opcode_valid): Remove expansionp.
	(macro_build): Change invocation of is_opcode_valid.
	(mips_ip): Likewise.

	gas/testsuite/
	* gas/mips/mips-jalx-2.d: New.
	* gas/mips/mips-jalx-2.s: New.
	* gas/mips/mips.exp (mips-jalx-2): Run new test.

	include/
	* opcode/mips.h (INSN_MIPS16): Remove.

	opcodes/
	* mips-dis.c (mips_arch): Remove INSN_MIPS16.
	* mips-opc.c (I16): Remove.

2010-05-24  Jie Zhang  <jie@codesourcery.com>

	Issue #8314

	* release-notes-csl.xml: Document.

	Backport from upstream

	bfd/
	2010-02-18  Alan Modra  <amodra@gmail.com>
	* elf.c (bfd_elf_set_group_contents): Revert accidental 2009-01-15
	commit.  Don't write zeros for removed group members.
	(_bfd_elf_copy_private_header_data): Adjust size of group section
	when group members are removed by objcopy.

	binutils/testsuite/
	2010-02-18  Alan Modra  <amodra@gmail.com>
	* binutils-all/group-5.s, * binutils-all/group-5.d: New test.
	* binutils-all/objcopy.exp: Run it.

2010-05-21  Jie Zhang  <jie@codesourcery.com>

	Issue #8358

	* release-notes-csl.xml: Document.

	Backport from upstream

	bfd/
	2010-01-19  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* elf32-arm.c (elf32_arm_howto_table_1): Correct bitsize of
	R_ARM_THM_CALL entry.
	(elf32_arm_final_link_relocate): Correct calculation of
	reloc_signed_max when doing a R_ARM_THM_CALL, R_ARM_THM_XPC22,
	or R_ARM_THM_JUMP24 relocation.

	ld/testsuite/
	2010-02-15  Matthew Gretton-Dann <matthew.gretton-dann@arm.com>

	* ld-arm/jump-reloc-veneers-long.d: Correct testcase for
	  arm-none-eabi target.
	* ld-arm/jump-reloc-veneers-short1.d: Likewise
	* ld-arm/jump-reloc-veneers-short2.d: Likewise

	2010-02-01  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>

	* ld-arm/jump-reloc-veneers-long.d: New test.
	* ld-arm/jump-reloc-veneers-short1.d: Likewise.
	* ld-arm/jump-reloc-veneers-short2.d: Likewise.
	* ld-arm/jump-reloc-veneers.s: Likewise.
	* ld-arm/arm-elf.exp (armelftests): Run them.

2010-05-17  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_handle_align): Use 32-bit microMIPS
	NOPs where possible.  Adjust comment to match code.

	gas/testsuite/gas/
	* mips/micromips.d: Update to handle 32-bit microMIPS NOPs used
	for alignment.
	* mips/micromips-trap.d: Likewise.

	ld/testsuite/
	* ld-mips-elf/jalx-2.dd: Update to handle 32-bit microMIPS NOPs
	used for alignment.

2010-05-17  Maciej W. Rozycki  <macro@codesourcery.com>

	Backport from FSF:

	gas/
	2010-02-25  Wu Zhangjin <wuzhangjin@gmail.com>
	* config/tc-mips.c (mips_handle_align): Replace the implicit
	nops.
	* config/tc-mips.h (MAX_MEM_FOR_RS_ALIGN_CODE): Modified
	for the new mips_handle_align().

2010-05-12  Thomas Schwinge  <thomas@codesourcery.com>

	Backport from mainline HEAD:

	bfd/
	2010-02-08  Philipp Tomsich  <philipp.tomsich@theobroma-systems.com>

	* archures.c (bfd_mach_ppc_titan): Define.
	* bfd-in2.h: Regenerate.
	* cpu-powerpc.c (bfd_powerpc_archs): Add titan entry.

	gas/
	2010-02-08  Philipp Tomsich  <philipp.tomsich@theobroma-systems.com>

	* config/tc-ppc.c (md_show_usage): Mention -mtitan.  Omitted: [Don't use tabs.]
	(ppc_mach): Handle titan.
	* doc/c-ppc.texi: Mention -mtitan.

	gas/testsuite/
	2010-02-08  Philipp Tomsich  <philipp.tomsich@theobroma-systems.com>

	* gas/ppc/titan.d, * gas/ppc/titan.s: New test.
	* gas/ppc/ppc.exp: Run it.

	include/opcode/
	2010-02-08  Philipp Tomsich  <philipp.tomsich@theobroma-systems.com>

	* opcode/ppc.h (PPC_OPCODE_TITAN): Define.

	opcodes/
	2010-02-08  Philipp Tomsich  <philipp.tomsich@theobroma-systems.com>

	* ppc-dis.c (ppc_opts): Add titan entry.
	* ppc-opc.c (TITAN, MULHW): Define.
	(powerpc_opcodes): Support AppliedMicro Titan core (APM83xxx).

2010-05-12  Jie Zhang  <jie@codesourcery.com>

	Issue #7168

	gas/
	* config/tc-arm.c (aeabi_set_public_attributes): Set
	Tag_ABI_HardFP_use to 1 if a single precision FPU is selected.

	gas/testsuite/
	* gas/arm/attr-mfpu-vfpxd.d: New test.

	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Merge
	Tag_ABI_HardFP_use correctly.

	ld/testsuite/
	* ld-arm/attr-merge-vfp-6.d: New test.
	* ld-arm/attr-merge-vfp-6r.d: New test.
	* ld-arm/attr-merge-vfpv3xd.s: New test.
	* ld-arm/arm-elf.exp: Add attr-merge-vfp-6 and attr-merge-vfp-6r.

2010-05-06  Joseph Myers  <joseph@codesourcery.com>

	Backport:

	ld/testsuite/
	2010-05-06  Joseph Myers  <joseph@codesourcery.com>

	* ld-elf/orphan-region.d: Use ld -N.

2010-04-27  Nathan Sidwell  <nathan@codesourcery.com>

	ld/
	* Makefile.am (ALL_EMULATIONS): Add earmelf_samsung_nucleus.o.
	(earmelf_samsung_nucleus.c): New target.
	* Makefile.in: Regenerated.
	* configure.tgt (arm*-samsing-nucleuseabi): New target.
	* emulparams/armelf_samsing_nucleus.sh: New.

2010-04-16  Daniel Jacobowitz  <dan@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_cpu_info_table): Add "m14kc".
	* doc/c-mips.texi (MIPS architecture options): Add "m14kc" to the
	list of -march options.

2010-04-15  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #8429
	* release-notes-csl.xml (Linker script processing improvement):
	Add missing <formalpara> element around note.

2010-04-12  Andrew Stubbs  <ams@codesourcery.com>

	* release-notes-csl.xml: Add note for ARM ABI 2.08 updates.

2010-04-09  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Change
	Tag_ABI_align8_needed to Tag_ABI_align_needed and
	Tag_ABI_align8_preserved to Tag_ABI_align_preserved.
	Alter error message to match new tag meaning.

	binutils/
	* readelf.c (arm_attr_tag_ABI_align8_needed): Rename to ...
	(arm_attr_tag_ABI_align_needed): ... this.
	Add new values.
	(arm_attr_tag_ABI_align8_preserved): Rename to ...
	(arm_attr_tag_ABI_align_preserved): ... this.
	Add new values.
	(arm_attr_public_tags): Change ABI_align8_needed to
	ABI_align_needed and ABI_align8_preserved to ABI_align_preserved.

	gas/
	* config/tc-arm.c (arm_convert_symbolic_attribute): Add
	Tag_ABI_align_needed and Tag_ABI_align_preserved.
	* doc/c-arm.texi (.eabi_attribute): Change Tag_ABI_align8_needed to
	Tag_ABI_align_needed and Tag_ABI_align8_preserved to
	Tag_ABI_align_preserved.

	gas/testsuite/
	* gas/arm/attr-syntax.s: Change Tag_ABI_align8_needed to
	Tag_ABI_align_needed.

	include/elf/
	* arm.h (Tag_ABI_align_needed): New enum value.
	(Tag_ABI_align_preserved): Likewise.

	ld/testsuite/
	* ld-arm/attr-merge-2.attr: Update alignment attributes.
	* ld-arm/attr-merge-2b.s: Likewise.
	* ld-arm/attr-merge-3.attr: Likewise.
	* ld-arm/attr-merge-3a.s: Likewise.
	* ld-arm/attr-merge-3b.s: Likewise.
	* ld-arm/attr-merge-wchar-00-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-00.d: Likewise.
	* ld-arm/attr-merge-wchar-02-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-02.d: Likewise.
	* ld-arm/attr-merge-wchar-04-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-04.d: Likewise.
	* ld-arm/attr-merge-wchar-20-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-20.d: Likewise.
	* ld-arm/attr-merge-wchar-22-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-22.d: Likewise.
	* ld-arm/attr-merge-wchar-24-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-40-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-40.d: Likewise.
	* ld-arm/attr-merge-wchar-42-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-44-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-44.d: Likewise.
	* ld-arm/attr-merge.attr: Likewise.

2010-04-09  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #8360 - Thumb-2 erratum fix for shared libraries

	* release-notes-csl.xml (Linker bug with Cortex-A8 erratum fix): New
	note.

	ld/testsuite/
	* ld-arm/cortex-a8-fix-bl-rel-plt.d: New file.
	* ld-arm/arm-elf.exp (armelftests): Run cortex-a8-fix-bl-rel-plt.d.

	bfd/
	* elf32-arm.c (struct a8_erratum_reloc): Add hash member.  Move
	sym_name to improve packing.
	(cortex_a8_erratum_scan): Check for PLT entries.
	(elf32_arm_size_stubs): Save the target symbol for a8 relocs.

2010-04-08  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #8352 - StellarisWare build failure.

	ld/
	* ldlang.c (print_assignment): Use the symbol's section if we
	use its value.
	* ld/ldexp.c (exp_fold_tree_1): Skip self-assignment.  Expand
	comment on copying symbol type.

2010-04-08  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #8227 - Corrupt linker veneers.

	* release-notes-csl.xml (Incorrect linker-generated functions): New
	note.

	Backport from mainline:

	2009-07-27  Doug Kwan  <dougkwan@google.com>

	bfd/
	* elf32-arm.c (stub_hash_newfunc): Initialize field output_name.

	2009-07-10  Doug Kwan  <dougkwan@google.com>

	bfd/
	* elf32-arm.c (stub_hash_newfunc): Initialize fields
	target_addend and orig_insn.

2010-04-08  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #8215, #8216, #8217, #8218

	* release-notes-csl.xml: Document.

2010-04-07  Thomas Schwinge  <thomas@codesourcery.com>

	Issue #6715

	Backport from upstream:

	gas/
	2010-03-15  Thomas Schwinge  <thomas@codesourcery.com>

	* dw2gencfi.c (output_cie): Consider emitting the S augmentation in all
	cases, and not only for .eh_frame.

	gas/
	2010-03-15  Thomas Schwinge  <thomas@codesourcery.com>

	* dw2gencfi.c (output_cie): Make it more explicit which code paths
	belong to .eh_frame only.

	gas/
	2009-10-02  Jakub Jelinek  <jakub@redhat.com>

	* dw2gencfi.c: Include dwarf2dbg.h.
	(DWARF2_FORMAT): Define if not defined.
	(dot_cfi_sections): New function.
	(cfi_pseudo_table): Handle .cfi_sections.
	(CFI_EMIT_eh_frame, CFI_EMIT_debug_frame): Define.
	(cfi_sections): New variable.
	(output_cie, output_fde, select_cie_for_fde): Add eh_frame
	argument, add supporting for outputting .debug_frame
	section.
	(cfi_change_reg_numbers): New function or macro.
	(cfi_finish): Only emit .eh_frame if
	cfi_sections & CFI_EMIT_eh_frame.  Emit .debug_frame if
	cfi_sections & CFI_EMIT_debug_frame.
	* config/tc-ppc.h (md_reg_eh_frame_to_debug_frame): Define.
	* doc/as.texinfo (CFI directives): Document .cfi_sections.

2010-04-07  Andrew Stubbs  <ams@codesourcery.com>

	gas/
	* config/tc-arm.c (aeabi_set_public_attributes): Set Tag_DIV_use.

	gas/testsuite/
	* gas/arm/attr-cpu-directive.d: Add Tag_DIV_use.
	* gas/arm/attr-default.d: Likewise.
	* gas/arm/attr-march-armv1.d: Likewise.
	* gas/arm/attr-march-armv2.d: Likewise.
	* gas/arm/attr-march-armv2a.d: Likewise.
	* gas/arm/attr-march-armv2s.d: Likewise.
	* gas/arm/attr-march-armv3.d: Likewise.
	* gas/arm/attr-march-armv3m.d: Likewise.
	* gas/arm/attr-march-armv4.d: Likewise.
	* gas/arm/attr-march-armv4t.d: Likewise.
	* gas/arm/attr-march-armv4txm.d: Likewise.
	* gas/arm/attr-march-armv4xm.d: Likewise.
	* gas/arm/attr-march-armv5.d: Likewise.
	* gas/arm/attr-march-armv5t.d: Likewise.
	* gas/arm/attr-march-armv5te.d: Likewise.
	* gas/arm/attr-march-armv5tej.d: Likewise.
	* gas/arm/attr-march-armv5texp.d: Likewise.
	* gas/arm/attr-march-armv5txm.d: Likewise.
	* gas/arm/attr-march-armv6-m.d: Likewise.
	* gas/arm/attr-march-armv6.d: Likewise.
	* gas/arm/attr-march-armv6j.d: Likewise.
	* gas/arm/attr-march-armv6k.d: Likewise.
	* gas/arm/attr-march-armv6kt2.d: Likewise.
	* gas/arm/attr-march-armv6t2.d: Likewise.
	* gas/arm/attr-march-armv6z.d: Likewise.
	* gas/arm/attr-march-armv6zk.d: Likewise.
	* gas/arm/attr-march-armv6zkt2.d: Likewise.
	* gas/arm/attr-march-armv6zt2.d: Likewise.
	* gas/arm/attr-march-armv7-a.d: Likewise.
	* gas/arm/attr-march-armv7.d: Likewise.
	* gas/arm/attr-march-armv7a.d: Likewise.
	* gas/arm/attr-march-iwmmxt.d: Likewise.
	* gas/arm/attr-march-iwmmxt2.d: Likewise.
	* gas/arm/attr-march-marvell-f.d: Likewise.
	* gas/arm/attr-march-xscale.d: Likewise.
	* gas/arm/attr-mcpu.d: Likewise.
	* gas/arm/attr-mfpu-arm1020e.d: Likewise.
	* gas/arm/attr-mfpu-arm1020t.d: Likewise.
	* gas/arm/attr-mfpu-arm1136jf-s.d: Likewise.
	* gas/arm/attr-mfpu-arm1136jfs.d: Likewise.
	* gas/arm/attr-mfpu-arm7500fe.d: Likewise.
	* gas/arm/attr-mfpu-fpa.d: Likewise.
	* gas/arm/attr-mfpu-fpa10.d: Likewise.
	* gas/arm/attr-mfpu-fpa11.d: Likewise.
	* gas/arm/attr-mfpu-fpe.d: Likewise.
	* gas/arm/attr-mfpu-fpe2.d: Likewise.
	* gas/arm/attr-mfpu-fpe3.d: Likewise.
	* gas/arm/attr-mfpu-maverick.d: Likewise.
	* gas/arm/attr-mfpu-neon-fp16.d: Likewise.
	* gas/arm/attr-mfpu-neon.d: Likewise.
	* gas/arm/attr-mfpu-softfpa.d: Likewise.
	* gas/arm/attr-mfpu-softvfp+vfp.d: Likewise.
	* gas/arm/attr-mfpu-softvfp.d: Likewise.
	* gas/arm/attr-mfpu-vfp.d: Likewise.
	* gas/arm/attr-mfpu-vfp10-r0.d: Likewise.
	* gas/arm/attr-mfpu-vfp10.d: Likewise.
	* gas/arm/attr-mfpu-vfp3.d: Likewise.
	* gas/arm/attr-mfpu-vfp9.d: Likewise.
	* gas/arm/attr-mfpu-vfpv2.d: Likewise.
	* gas/arm/attr-mfpu-vfpv3-d16.d: Likewise.
	* gas/arm/attr-mfpu-vfpv3.d: Likewise.
	* gas/arm/attr-mfpu-vfpv4-d16.d: Likewise.
	* gas/arm/attr-mfpu-vfpv4.d: Likewise.
	* gas/arm/attr-mfpu-vfpxd.d: Likewise.
	* gas/arm/attr-order.d: Likewise.
	* gas/arm/attr-override-cpu-directive.d: Likewise.
	* gas/arm/attr-override-mcpu.d: Likewise.
	* gas/arm/eabi_attr_1.d: Likewise.

	ld/testsuite/
	* ld-arm/attr-merge-2.attr: Add Tag_DIV_use.
	* ld-arm/attr-merge-2a.s: Likewise.
	* ld-arm/attr-merge-2b.s: Likewise.
	* ld-arm/attr-merge-3a.s: Likewise.
	* ld-arm/attr-merge-3b.s: Likewise.
	* ld-arm/attr-merge-4.attr: Likewise.
	* ld-arm/attr-merge-5.attr: Likewise.
	* ld-arm/attr-merge-6.attr: Likewise.
	* ld-arm/attr-merge-7.attr: Likewise.
	* ld-arm/attr-merge-arch-1.attr: Likewise.
	* ld-arm/attr-merge-arch-2.attr: Likewise.
	* ld-arm/attr-merge-unknown-2.d: Likewise.
	* ld-arm/attr-merge-unknown-2r.d: Likewise.
	* ld-arm/attr-merge-unknown-3.d: Likewise.
	* ld-arm/attr-merge-vfp-1.d: Likewise.
	* ld-arm/attr-merge-vfp-1r.d: Likewise.
	* ld-arm/attr-merge-vfp-2.d: Likewise.
	* ld-arm/attr-merge-vfp-2r.d: Likewise.
	* ld-arm/attr-merge-vfp-3.d: Likewise.
	* ld-arm/attr-merge-vfp-3r.d: Likewise.
	* ld-arm/attr-merge-vfp-4.d: Likewise.
	* ld-arm/attr-merge-vfp-4r.d: Likewise.
	* ld-arm/attr-merge-vfp-5.d: Likewise.
	* ld-arm/attr-merge-vfp-5r.d: Likewise.
	* ld-arm/attr-merge-wchar-00-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-00.d: Likewise.
	* ld-arm/attr-merge-wchar-02-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-02.d: Likewise.
	* ld-arm/attr-merge-wchar-04-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-04.d: Likewise.
	* ld-arm/attr-merge-wchar-20-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-20.d: Likewise.
	* ld-arm/attr-merge-wchar-22-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-22.d: Likewise.
	* ld-arm/attr-merge-wchar-24-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-40-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-40.d: Likewise.
	* ld-arm/attr-merge-wchar-42-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-44-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-44.d: Likewise.
	* ld-arm/attr-merge.attr: Likewise.

2010-04-06  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Merge
	Tag_Virtualization_use with an OR operator.

	ld/testsuite/
	* ld-arm/attr-merge-3.attr: Update Tag_Virtualization_use.
	* ld-arm/attr-merge-3a.s: Test Tag_Virtualization_use better.

2010-04-06  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Rename Tag_VFP_arch
	to Tag_FP_arch and Tag_VFP_HP_extension to Tag_FP_HP_extension.

	binutils/
	* readelf.c (arm_attr_tag_VFP_arch): Rename to ...
	(arm_attr_tag_FP_arch): ... this.
	(arm_attr_tag_ABI_HardFP_use): Change Tag_VFP_arch to Tag_FP_arch.
	(arm_attr_tag_VFP_HP_extension): Rename to ...
	(arm_attr_tag_FP_HP_extension): ... this.
	(arm_attr_public_tags): Change VFP_arch to FP_arch and
	VFP_HP_extension to FP_HP_extension.

	gas/
	* config/tc-arm.c (aeabi_set_public_attributes): Change Tag_VFP_arch
	to Tag_FP_arch and Tag_VFP_HP_extension to Tag_FP_HP_extension.
	(arm_convert_symbolic_attribute): Add Tag_FP_arch and
	Tag_FP_HP_extension.
	* doc/c-arm.texi (.eabi_attribute): Change Tag_VFP_arch to
	Tag_FP_arch and Tag_VFP_HP_extension to Tag_FP_HP_extension.

	include/elf/
	* arm.h (Tag_FP_arch, Tag_FP_HP_extension): New enum values.

	gas/testsuite/
	* gas/arm/attr-mcpu.d: Change Tag_VFP_arch to Tag_FP_arch and
	Tag_VFP_HP_extension to Tag_FP_HP_extension.
	* gas/arm/attr-mfpu-arm1020e.d: Likewise.
	* gas/arm/attr-mfpu-arm1020t.d: Likewise.
	* gas/arm/attr-mfpu-arm1136jf-s.d: Likewise.
	* gas/arm/attr-mfpu-arm1136jfs.d: Likewise.
	* gas/arm/attr-mfpu-neon-fp16.d: Likewise.
	* gas/arm/attr-mfpu-neon.d: Likewise.
	* gas/arm/attr-mfpu-softvfp+vfp.d: Likewise.
	* gas/arm/attr-mfpu-vfp.d: Likewise.
	* gas/arm/attr-mfpu-vfp10-r0.d: Likewise.
	* gas/arm/attr-mfpu-vfp10.d: Likewise.
	* gas/arm/attr-mfpu-vfp3.d: Likewise.
	* gas/arm/attr-mfpu-vfp9.d: Likewise.
	* gas/arm/attr-mfpu-vfpv2.d: Likewise.
	* gas/arm/attr-mfpu-vfpv3-d16.d: Likewise.
	* gas/arm/attr-mfpu-vfpv3.d: Likewise.
	* gas/arm/attr-mfpu-vfpv4-d16.d: Likewise.
	* gas/arm/attr-mfpu-vfpv4.d: Likewise.
	* gas/arm/attr-mfpu-vfpxd.d: Likewise.
	* gas/arm/vfma1.s: Likewise.

	ld/testsuite/
	* ld-arm/attr-merge-3.attr: Change Tag_VFP_arch to Tag_FP_arch and
	Tag_VFP_HP_extension to Tag_FP_HP_extension.
	* ld-arm/attr-merge-3a.s: Likewise.
	* ld-arm/attr-merge-3b.s: Likewise.
	* ld-arm/attr-merge-vfp-1.d: Likewise.
	* ld-arm/attr-merge-vfp-1r.d: Likewise.
	* ld-arm/attr-merge-vfp-2.d: Likewise.
	* ld-arm/attr-merge-vfp-2r.d: Likewise.
	* ld-arm/attr-merge-vfp-3.d: Likewise.
	* ld-arm/attr-merge-vfp-3r.d: Likewise.
	* ld-arm/attr-merge-vfp-4.d: Likewise.
	* ld-arm/attr-merge-vfp-4r.d: Likewise.
	* ld-arm/attr-merge-vfp-5.d: Likewise.
	* ld-arm/attr-merge-vfp-5r.d: Likewise.

2010-04-06  Andrew Stubbs  <ams@codesourcery.com>

	Backport from upstream:
	(some of this patch was already present)

	2009-11-17  Paul Brook  <paul@codesourcery.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>

	gas/
	* doc/c-arm.texi: Document .arch armv7e-m.
	* config/tc-arm.c (arm_ext_v6_dsp, arm_ext_v7m): New.
	(insns): Put Thumb versions of v5TExP instructions into
	arm_ext_v5exp also.  Move some Thumb variants from
	arm_ext_v6_notm to arm_ext_v6_dsp.
	(arm_archs): Add armv7e-m architecture.
	(aeabi_set_public_attributes): Handle -march=armv7e-m.

	gas/testsuite/
	* gas/arm/attr-march-armv7em.d: New test.
	* gas/arm/arch7em-bad.d: New test.
	* gas/arm/arch7em-bad.l: New test.
	* gas/arm/arch7em.d: New test.
	* gas/arm/arch7em.s: New test.

	include/elf/
	* arm.h (TAG_CPU_ARCH_V7E_M): Define.

	include/opcode/
	* arm.h (ARM_EXT_V6_DSP): Define.
	(ARM_AEXT_V6T2, ARM_AEXT_NOTM): Include ARM_EXT_V6_DSP.
	(ARM_AEXT_V7EM, ARM_ARCH_V7EM): Define.

	binutils/
	* readelf.c (arm_attr_tag_CPU_arch): Add v7E-M.

	bfd/
	* elf32-arm.c (using_thumb_only, arch_has_arm_nop,
	arch_has_thumb2_nop): Handle TAG_CPU_ARCH_V7E_M.
	(tag_cpu_arch_combine): Ditto. Correct MAX_TAG_CPU_ARCH test.

2010-04-06  Andrew Stubbs  <ams@codesourcery.com>

	Add files missing from previous commit.

	* ld/testsuite/ld-arm/attr-merge-6.attr: New test.
	* ld/testsuite/ld-arm/attr-merge-6a.s: Likewise.
	* ld/testsuite/ld-arm/attr-merge-6b.s: Likewise.
	* ld/testsuite/ld-arm/attr-merge-7.attr: Likewise.
	* ld/testsuite/ld-arm/attr-merge-7a.s: Likewise.
	* ld/testsuite/ld-arm/attr-merge-7b.s: Likewise.
2010-04-06  Andrew Stubbs  <ams@codesourcery.com>

	Backport from mainline:

	2010-02-17  Matthew Gretton-Dann  <matthew.gretton-dann@arm.com>
	* bfd/elf32-arm.c (elf32_arm_merge_eabi_attributes): Add support
	for merging Tag_DIV_use, Tag_MPextension_use, and
	Tag_MPextension_use_legacy tags.
	* bfd/readelf.c (arm_attr_tag_Advanced_SIMD_arch): Add
	description of newly permitted attribute values.
	(arm_attr_tag_Virtualization_use): Likewise.
	(arm_attr_tag_DIV_use): Add description of new attribute.
	(arm_attr_tag_MPextension_use): Likewise.
	* gas/config/tc-arm.c (arm_convert_symbolic_attribute): Add
	Tag_DIV_use.
	* gas/doc/c-arm.texi: Likewise
	* include/elf/arm.h (Tag_MPextension_use): Renumber.
	(Tag_DIV_use): Add.
	(Tag_MPextension_use_legacy): Likewise.
	* gas/testsuite/arm/attr-order.d: Fix test for new name for
	Tag_Virtualization_use attribute values
	* ld/testsuite/ld-arm/attr-merge-3.attr: Fix test for new
	Tag_MPextension_use value.
	* ld/testsuite/ld-arm/attr-merge-3b.s: Likewise
	* ld/testsuite/ld-arm/attr-merge-unknown-1.d: Fix test now that
	42 is a recognised attribute ID.
	* ld/testsuite/ld-arm/attr-merge-unknown-1.s: Likewise.
	* ld/testsuite/ld-arm/attr-merge-6.attr: New test.
	* ld/testsuite/ld-arm/attr-merge-6a.s: Likewise.
	* ld/testsuite/ld-arm/attr-merge-6b.s: Likewise.
	* ld/testsuite/ld-arm/attr-merge-7.attr: Likewise.
	* ld/testsuite/ld-arm/attr-merge-7a.s: Likewise.
	* ld/testsuite/ld-arm/attr-merge-7b.s: Likewise.
	* ld/testsuite/ld-arm/arm-elf.exp: Run the new tests.

2010-04-06  Jie Zhang  <jie@codesourcery.com>

	Issue #7965

	gas/
	* config/tc-arm.c (make_mapping_symbol): Handle the case
	that multiple mapping symbols have the same value 0.

	gas/testsuite/
	* gas/arm/mapmisc.s: Test multiple mapping symbols have
	the same value 0.

2010-04-06  Jie Zhang  <jie@codesourcery.com>

	Issue #8218

	gas/
	* config/tc-arm.c (parse_address_main): Handle #-0.
	(encode_arm_addr_mode_2): Handle #-0.
	(encode_arm_addr_mode_3): Handle #-0.
	(encode_arm_cp_address): Handle #-0.
	(md_apply_fix): Assert address offset not be 0.

	gas/testsuite/
	* gas/arm/inst.d: Adjust.
	* gas/arm/ldst-offset0.d: New test.
	* gas/arm/ldst-offset0.s: New test.

	opcodes/
	* arm-dis.c (print_insn_coprocessor): Explicitly print #-0
	as address offset.
	(print_arm_address): Likewise.

2010-04-06  Jie Zhang  <jie@codesourcery.com>

	Issue #8217

	gas/
	* config/tc-arm.c (only_one_reg_in_list): New.
	(do_ldmstm): Use different encodings when push or pop only
	one register.

	gas/testsuite/
	* gas/arm/push-pop.d: New test.
	* gas/arm/push-pop.s: New test.

2010-04-06  Jie Zhang  <jie@codesourcery.com>

	Issue #8216

	gas/
	* config/tc-arm.c (md_apply_fix): Use encoding A2 of ADR
	if offset is negative.

	gas/testsuite/
	* gas/arm/adr.d: New test.
	* gas/arm/adr.s: New test.

2010-04-06  Jie Zhang  <jie@codesourcery.com>

	Issue #8215

	gas/
	* config/tc-arm.c (parse_shifter_operand): Fix handling
	of explicit rotation.
	(encode_arm_shifter_operand): Likewise.

	gas/testsuite/
	* gas/arm/adrl.d: Adjust.
	* gas/arm/immed2.d: New test.
	* gas/arm/immed2.s: New test.

	opcodes/
	* arm-dis.c (print_insn_arm): Explicitly specify rotation
	if needed.

2010-03-30  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gas/
	2009-10-02  Peter Bergner  <bergner@vnet.ibm.com>

	* config/tc-ppc.c (md_show_usage): Document -m476.
	* doc/c-ppc.texi (PowerPC-Opts): Document -m476.

	gas/testsuite/
	2009-10-02  Peter Bergner  <bergner@vnet.ibm.com>

	* gas/ppc/476.s: New test.
	* gas/ppc/476.d: Likewise.
	* gas/ppc/ppc.exp: Run the 476 test.

	include/opcode/
	2009-10-02  Peter Bergner  <bergner@vnet.ibm.com>

	* ppc.h (PPC_OPCODE_476): Define.

	2009-09-22  Peter Bergner  <bergner@vnet.ibm.com>

	* ppc.h (ppc_cpu_t): Typedef to uint64_t.

	opcodes/
	2009-10-02  Peter Bergner  <bergner@vnet.ibm.com>

	* ppc-dis.c (ppc_opts): Add "476" entry.
	* ppc-opc.c (PPC476): Define.
	(powerpc_opcodes): Update mnemonics where required for 476.

2010-03-30  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8230

	gas/
	* write.c (fixup_segment): Do not assume we know the section a
	defined weak symbol is in.
	* config/tc-arm.c (relax_adr, relax_branch, md_apply_fix): Treat
	weak symbols as not known to be in the same section, even if they
	are defined.

	gas/testsuite/
	* gas/arm/weakdef-1.s: New.
	* gas/arm/weakdef-1.d: New.
	* gas/arm/weakdef-2.s: New.
	* gas/arm/weakdef-2.d: New.
	* gas/arm/weakdef-2.l: New.

	* release-notes-csl.xml: Document.

2010-03-29  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #8219 - Incorrect veneers on ARM v6-M.

	* release-notes-csl.xml (Long call fix): New note.

	Backport from mainline:

	2010-03-29  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-arm.c (using_thumb_only): Handle v6-M.

	2010-03-29  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/testsuite/
	* ld-arm/arm-elf.exp (armeabitests): Add v6-M farcall test.

2010-03-29  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-arm.c (md_apply_fix): Remove checks duplicated in
	merge from upstream.

2010-03-25  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #8170

	gas/
	* config/tc-arm.c (md_assemble): Clarify current mode in error
	messages about unsupported instructions.
	(UT): Delete #define.
	(insns): Adjust cbnz, cbz appropriately.

	gas/testsuite/
	* gas/arm/armv1-bad.l: Adjust expected error text.
	* gas/arm/armv7em-bad.l: Likewise.
	* gas/arm/armv7m-bad.l: Likewise.
	* gas/arm/thumb-w-bad.l: Likewise.
	* gas/arm/arm7-bad.d: New.
	* gas/arm/arm7-bad.l: New.
	* gas/arm/arm7-bad.s: New.

	* release-notes-csl.xml: Document.

2010-03-23  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #8089 - Orphan placement fails with memory regions

	* release-notes-csl.xml: Document.

	Backport from upstream:

	2010-03-15  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/
	* ldlang.c (lang_insert_orphan): Place loadable orphans in the same
	region and phdrs as their placement section.

	ld/testsuite/
	* ld-elf/orphan-region.d, ld-elf/orphan-region.ld,
	ld-elf/orphan-region.s: New files.

2010-03-19  Jie Zhang  <jie@codesourcery.com>

	Issue #7972

	Backport from upstream

	ld/testsuite/
	2010-03-19  Jie Zhang  <jie@codesourcery.com>

	PR ld/11304
	* ld-elf/pr11304.d: New test.
	* ld-elf/pr11304a.s: New test.
	* ld-elf/pr11304b.s: New test.
	* lib/ld-lib.exp (regexp_diff): Add support for #failif.

2010-03-19  Jie Zhang  <jie@codesourcery.com>

	Issue #7972

	Backport from upstream

	bfd/
	2010-02-25  Alan Modra  <amodra@gmail.com>

	PR ld/11304
	* elf.c (_bfd_elf_init_private_section_data): Rename need_group
	to final_link and invert.  For final link allow some flags to
	differ.  Don't specially allow flags to be all zero.

	ld/
	2010-02-25  Alan Modra  <amodra@gmail.com>

	PR ld/11304
	* ldlang.c (init_os): Remove isec param.  Don't check for
	bfd_section already set or call bfd_init_private_section_data
	here.
	(exp_init_os): Update init_os call.
	(lang_add_section): Tidy.  Really don't set SEC_LINK_ONCE
	flags.  Call bfd_init_private_section_data here.
	(map_input_to_output_sections): Tidy.  Update init_os calls.
	Use os->sectype to select sec flags for lang_data_statement.

2010-03-17  Jie Zhang  <jie@codesourcery.com>

	Issue #7599

	* release-notes-csl.xml: Document.

	bfd/
	* elf32-arm.c (struct section_list): Remove.
	(section_list): Remove typedef.
	(record_section_with_arm_elf_section_data): Remove.
	(find_arm_elf_section_entry): Remove.
	(get_arm_elf_section_data): Use is_arm_elf.
	(unrecord_section_with_arm_elf_section_data): Remove.
	(elf32_arm_new_section_hook): Don't call
	record_section_with_arm_elf_section_data.
	(elf32_arm_write_section): Set mapcount to -1 when
	the map has been used. Don't call
	unrecord_section_with_arm_elf_section_data.
	(unrecord_section_via_map_over_sections): Remove.
	(elf32_arm_close_and_cleanup): Remove.
	(elf32_arm_bfd_free_cached_info): Remove.
	(bfd_elf32_close_and_cleanup): Don't define.
	(bfd_elf32_bfd_free_cached_info): Don't define.

2010-03-17  Jie Zhang  <jie@codesourcery.com>

	Issue #7965

	* release-notes-csl.xml: Document.

	gas/
	* config/tc-arm.c (make_mapping_symbol): Hanle the case
	that two mapping symbols have the same value.

	gas/testsuite/
	* gas/arm/mapmisc.s, gas/arm/mapmisc.d: Add the test case
	for two mapping symbols having the same value.

2010-03-15  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_size_dynamic_sections): Avoid dereferencing
	htab->sgotplt on non-FDPIC targets where it may be NULL.

2010-03-12  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #8085
	* release-notes-csl.xml (Asssembler segmentation fault):
	Use "assembler", not "GAS".
	(Maximum code alignment increased): Likewise.

2010-03-12  Catherine Moore  <clm@codesourcery.com>

	Issue #8090

	bfd/
	* elfxx-mips.c (mips_elf_perform_relocation): Remove unnecessary
	#if 0 block.

2010-03-04  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #7859 - extra mapping symbol in script-type test

	bfd/
	* elf32-arm.c (elf32_arm_output_arch_local_syms): Skip non-program
	sections.

2010-03-03  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #7953 - Incorrect mapping symbols for Thumb-2 routines

	bfd/
	* elf32-arm.c (elf32_arm_output_arch_local_syms): Do not add
	a mapping symbol to an empty section.

2010-03-03  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (arm_cpu_option_table): Add cortex-m4.

2010-03-03  Jie Zhang  <jie@codesourcery.com>

	Issue #2735

	* release-notes-csl.xml: Document.

	Backport from upstream:

	ld/
	2010-02-27  Jie Zhang  <jie@codesourcery.com>

	* scripttempl/armbpabi.sc: Don't combine .init_array.* or
	.fini_array.* when do relocatable linking.
	* scripttempl/elf.sc: Likewise.
	* scripttempl/elf32sh-symbian.sc: Likewise.
	* scripttempl/elf64hppa.sc: Likewise.
	* scripttempl/elfxtensa.sc: Likewise.

	2010-02-26  Alan Modra  <amodra@gmail.com>

	* scripttempl/elf.sc (.fini_array): Place input .fini_array after
	.fini_array.*.
	* scripttempl/armbpabi.sc: Likewise.
	* scripttempl/elf32sh-symbian.sc: Likewise.
	* scripttempl/elf64hppa.sc: Likewise.
	* scripttempl/elfxtensa.sc: Likewise.

	ld/testsuite/

	2010-02-27  H.J. Lu  <hongjiu.lu@intel.com>

	* ld-elf/init-fini-arrays.d: Pass --wide to readelf.

	2010-02-27  Jie Zhang  <jie@codesourcery.com>

	* ld-elf/init-fini-arrays.s: New test.
	* ld-elf/init-fini-arrays.d: New test.

2010-03-02  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #7911

	* release-notes-csl.xml (<literal>vcvt</literal> assembly bug fix):
	New note.

	Backport from mainline:

	gas/
	2010-01-20  Nick Clifton  <nickc@redhat.com>

	PR 11109
	* config/tc-arm.c (do_neon_cvt): Rename to do_neon_cvt_1.  Add
	code to handle round-to-zero for VCVT conversions.
	(do_neon_cvt): New.  Call do_neon_cvt_1.
	(do_neon_cvtr): New.  Call do_neon_cvt_1.
	(insns): Use do_neon_cvt for VCVT insn and do_neon_cvtr for VCVTR
	insn.

	gas/testsuite/
	2010-01-20  Nick Clifton  <nickc@redhat.com>

	PR 11109
	* gas/arm/vfp-neon-syntax.d: Update expected disassembly.
	* gas/arm/vfp-neon-syntax_t2.d: Likewise.

2010-02-26  Maxim Kuvyrkov  <maxim@codesourcery.com>

	ld/testsuite/
	* ld-m68k/tls-gd-ie-1.d: Stabilize test.

2010-02-25  Daniel Jacobowitz  <dan@codesourcery.com>
	    Pedro Alves  <pedro@codesourcery.com>

	libiberty/
	* cygpath.c (IMAGE_IMPORT_MODULE_DIRECTORY)
	(PIMAGE_IMPORT_MODULE_DIRECTORY, IMAGE_DIRECTORY_ENTRY_IMPORT): New.
	(msvcrt_dll): Use GetModuleHandle instead of
	LoadLibrary.  Check the import table to figure out which C
	runtime to use.
	(msvcrt_stat): New function.  Check for _stat32, _stat64i32,
	and _stat.
	(stat): Use msvcrt_stat.

2010-02-25  Julian Brown  <julian@codesourcery.com>

	Issue #7865

	ld/testsuite/
	* ld-arm/arm-elf.exp (Relocation boundaries): Use arm.ld linker
	script and don't define _start symbol.

2010-02-25  Jie Zhang  <jie@codesourcery.com>

	Issue #7806

	gas/
	* config/tc-arm.c (do_t_strexd): Remove
	operand[1] != operand[2] contraint.

	gas/testsuite/
	* gas/arm/thumb32.s, gas/arm/thumb32.d: Add a new test
	for strexd.
	* gas/arm/thumb32.l: Adjust.

2010-02-25  Jie Zhang  <jie@codesourcery.com>

	gas/
	* config/tc-arm.c (neon_select_shape): No need to match
	the remaining operands in the shape when one operand does
	not match.

2010-02-25  Jie Zhang  <jie@codesourcery.com>

	Issue #6686

	gas/
	* config/tc-arm.c (do_neon_ld_st_interleave): Reject bad
	alignment.

	gas/testsuite/
	* gas/arm/neon-ldst-align-bad.d: New test.
	* gas/arm/neon-ldst-align-bad.l: New test.
	* gas/arm/neon-ldst-align-bad.s: New test.

2010-02-17  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #7703

	Backport from upstream:
	2010-02-05  Christophe Lyon  <christophe.lyon@st.com>

	binutils/
	* objdump.c (disassemble_bytes): Clear aux->reloc before printing
	a new address, so as not to reuse a previous, non-related reloc.

	gas/testsuite/
	* gas/arm/arm-it-auto.d, gas/arm/bl-local-v4t.d,
	gas/arm/blx-local.d, gas/arm/thumb-w-good.d: Update expected
	results.

	2010-02-08  Christophe Lyon  <christophe.lyon@st.com>

	gas/

	* config/tc-arm.c (md_pcrel_from_section): Keep base to zero for
	non-local branches (BFD_RELOC_THUMB_PCREL_BRANCH23,
	BFD_RELOC_THUMB_PCREL_BLX, BFD_RELOC_ARM_PCREL_BLX,
	BFD_RELOC_ARM_PCREL_CALL)

	gas/testsuite/
	* gas/arm/branch-reloc.s, gas/arm/branch-reloc.d,
	gas/arm/branch-reloc.l: New tests and expected results with all
	variants of call: ARM/Thumb, local/global, inter/intra-section,
	using BL/BLX.

	* release-notes-csl.xml: Document.

2010-02-16  Daniel Jacobowitz  <dan@codesourcery.com>

	libiberty/
	* cygpath.c (cygpath): If cygpath exits, retry on the next request.

2010-02-16  Andrew Stubbs  <ams@codesourcery.com>

	gas/
	* config/tc-sh.c (get_specific): Move overflow checking code to avoid
	reading uninitialized data.
	(build_Mytes): Check the operand exists before reading it.

2010-02-12  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_size_dynamic_sections): Ensure that FDPIC
	libraries always have a PLTGOT entry in the .dynamic section.

2010-02-10  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #741

	gas/config/
	* tc-arm.c (do_rd_rm_rn): Added warning.

	gas/testsuite/
	* gas/arm/depr-swp.d: New test case.
	* gas/arm/depr-swp.s: New file.
	* gas/arm/depr-swp.l: New file.

	* release-notes-csl.xml: Document.

2010-02-08  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #2882

	gas/
	* config/tc-arm.c (asm_opcode): operands type
	change.
	(BAD_PC_ADDRESSING): New macro message.
	(BAD_PC_WRITEBACK): Likewise.
	(MIX_ARM_THUMB_OPERANDS): New macro.
	(operand_parse_code): Added enum values.
	(parse_operands): Added thumb/arm distinction,
	plus new enum values handling.
	(encode_arm_addr_mode_2): Validations enhanced.
	(encode_arm_addr_mode_3): Likewise.
	(do_rm_rd_rn): Likewise.
	(encode_thumb32_addr_mode): Likewise.
	(do_t_ldrex): Likewise.
	(do_t_ldst): Likewise.
	(do_t_strex): Likewise.
	(md_assemble): Call parse_operands with
	a new parameter.
	(OPS_1): New macro.
	(OPS_2): Likewise.
	(OPS_3): Likewise.
	(OPS_4): Likewise.
	(OPS_5): Likewise.
	(OPS_6): Likewise.
	(insns): Updated insns operands.

	gas/testsuite/
	* gas/arm/sp-pc-validations-bad.d: New testcase.
	* gas/arm/sp-pc-validations-bad.l: New file.
	* gas/arm/sp-pc-validations-bad.s: New file.
	* gas/arm/sp-pc-validations-bad-t.d: New testcase.
	* gas/arm/sp-pc-validations-bad-t.l: New file.
	* gas/arm/sp-pc-validations-bad-t.s: New file.
	* gas/arm/sp-pc-usage-t.d: Removed invalid insns.
	* gas/arm/sp-pc-usage-t.s: Likewise.
	* gas/arm/thumb2_bcond.s: Added case.
	* gas/arm/thumb2_bcond.d: Updated disassembly.

	* release-notes-csl.xml: Document.

2010-02-08  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #7285

	gas/config
	* tc-arm.c (relax_adr): handle NULL case.
	(tc_gen_reloc): Add message for
	BFD_RELOC_ARM_T32_OFFSET_IMM.

	gas/testsuite/
	* gas/arm/reloc-bad.d: New test case.
	* gas/arm/reloc-bad.s: New file.
	* gas/arm/reloc-bad.l: New file.

	* release-notes-csl.xml: Document.

2010-02-01  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #7320
	* elf32-arm.c (elf32_arm_output_arch_local_syms): add
	missing mapping symbol to data only sections.

	ld/testsuite/
	* ld-arm/arm-elf.exp (armelftests): New test case.
	* ld-arm/data-only-map.s: New file.
	* ld-arm/data-only-map.d: New file.
	* ld-arm/data-only-map.ld: New file.

	* release-notes-csl.xml: Document.

2010-01-28  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elfxx-mips.c (LA25_LUI_MICROMIPS, LA25_J_MICROMIPS,
	LA25_ADDIU_MICROMIPS): Remove.
	(LA25_LUI_MICROMIPS_1, LA25_LUI_MICROMIPS_2, LA25_J_MICROMIPS_1,
	LA25_J_MICROMIPS_2, LA25_ADDIU_MICROMIPS_1,
	LA25_ADDIU_MICROMIPS_2): Define.
	(mips_elf_create_la25_stub): Use these macros to generate stubs 16
	bits at a time.

2010-01-20  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* bfd-in2.h: Regenerate.
	* elf32-mips.c (elf_micromips_ctor64_howto): Remove.
	(elf_micromips_howto_table_rel): Remove various relocations.
	(mips_elf_gprel32_reloc): Don't handle R_MICROMIPS_GPREL32.
	(mips32_64bit_reloc): Don't handle R_MICROMIPS_64 and
	R_MICROMIPS_32.
	(micromips_reloc_map): Remove various relocations.
	(bfd_elf32_bfd_reloc_type_lookup): Don't handle microMIPS
	specially.
	* elf64-mips.c (micromips_elf64_howto_table_rel,
	micromips_elf64_howto_table_rela, micromips_reloc_map): Remove
	various relocations.
	* elfn32-mips.c (elf_micromips_howto_table_rel,
	elf_micromips_howto_table_rela, micromips_reloc_map): Remove
	various relocations.
	* elfxx-mips.c (TLS_RELOC_P): Don't handle various microMIPS
	relocations.
	(micromips_reloc_shuffle_p): Don't exclude any microMIPS data
	relocations.
	(mips_elf_initialize_tls_slots): Don't handle microMIPS specially.
	(mips_elf_calculate_relocation, _bfd_mips_elf_check_relocs,
	mips_elf_adjust_addend): Don't handle various microMIPS
	relocations.
	* libbfd.h: Regenerate.
	* reloc.c (BFD_RELOC_MICROMIPS_64, BFD_RELOC_MICROMIPS_32,
	BFD_RELOC_MICROMIPS_GPREL32, BFD_RELOC_MICROMIPS_TLS_DTPMOD32,
	BFD_RELOC_MICROMIPS_TLS_DTPREL32,
	BFD_RELOC_MICROMIPS_TLS_DTPMOD64,
	BFD_RELOC_MICROMIPS_TLS_DTPREL64, BFD_RELOC_MICROMIPS_TLS_TPREL32,
	BFD_RELOC_MIPS_TLS_TPREL_HI16): Remove.

	gas/
	* config/tc-mips.c (A_BFD_RELOC_GPREL32, A_BFD_RELOC_64,
	A_BFD_RELOC_MIPS_TLS_DTPREL64, A_BFD_RELOC_MIPS_TLS_DTPREL32):
	Remove.
	(micromips_reloc_p): Don't handle BFD_RELOC_MICROMIPS_64,
	BFD_RELOC_MICROMIPS_32 or BFD_RELOC_MICROMIPS_GPREL32.
	(append_insn): Don't handle BFD_RELOC_MICROMIPS_32,
	BFD_RELOC_MICROMIPS_GPREL32 or BFD_RELOC_MICROMIPS_64.
	(md_apply_fix): Don't handle BFD_RELOC_MICROMIPS_64,
	BFD_RELOC_MICROMIPS_TLS_DTPREL32,
	BFD_RELOC_MICROMIPS_TLS_DTPREL64 or BFD_RELOC_MICROMIPS_32.  Don't
	use A_BFD_RELOC_MIPS_TLS_DTPREL64 or
	A_BFD_RELOC_MIPS_TLS_DTPREL32.
	(s_gpword): Don't use A_BFD_RELOC_GPREL32.
	(s_gpdword): Don't use A_BFD_RELOC_GPREL32 or A_BFD_RELOC_64.
	(do_msbd): Don't use BFD_RELOC_MICROMIPS_32.

	include/elf/
	* mips.h (R_MICROMIPS_32, R_MICROMIPS_REL32, R_MICROMIPS_GPREL32,
	R_MICROMIPS_64, R_MICROMIPS_TLS_DTPMOD32,
	R_MICROMIPS_TLS_DTPREL32, R_MICROMIPS_TLS_DTPMOD64,
	R_MICROMIPS_TLS_DTPREL64, R_MICROMIPS_TLS_TPREL32,
	R_MICROMIPS_TLS_TPREL64, R_MICROMIPS_GLOB_DAT): Remove.

2010-01-14  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Expect low bit of
	$t9 to be set of microMIPS _gp_disp relocations.

2010-01-14  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elfxx-mips.c (LA25_LUI_MICROMIPS, LA25_J_MICROMIPS,
	LA25_ADDIU_MICROMIPS): Define.
	(mips_elf_add_la25_intro, mips_elf_add_la25_trampoline): Adjust
	value of stub symbol if target is a microMIPS function.
	(mips_elf_create_la25_stub): Create microMIPS stub if target is a
	microMIPS function.

2010-01-13  Chao-ying Fu  <fu@mips.com>

	opcodes/
	mips-dis.c (is_micromips_mode_p): Rewrite.

2010-01-13  Catherine Moore  <clm@codesourcery.com>

	ld/testsuite/
	* ld-mips-elf/jalx-1.d: Update disassembly.
	* ld-mips-elf/jalx-2-main.s: New.
	* ld-mips-elf/jalx-2.dd: New.
	* ld-mips-elf/jalx-2-ex.s: New.
	* ld-mips-elf/jalx-2-printf.s: New.
	* ld-mips-elf/mips-elf.exp: Run new test.

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Check for a PLT
	output section for target_is_micromips_code_p.

2010-01-13  Chao-ying Fu  <fu@mips.com>

	opcodes/
	* mips-dis.c (is_micromips_mode_p):  Improve disassembly for
	microMIPS.

2010-01-06  Catherine Moore  <clm@codesourcery.com>

	opcodes/
	* mips-dis.c: Revert inadvertent commit.

2010-01-06  Catherine Moore  <clm@codesourcery.com>
	    Chao-ying Fu <fu@mips.com>

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation):  Use correct
	mask for jalx.

	ld/testsuite
	ld-mips-elf/jalx-1.s: New test.
	ld-mips-elf/jalx-1.d: New test output.
	ld-mips-elf/jalx-1.ld: New test linker script.
	ld-mips-elf/mips-elf.exp: Run new test.
	
2010-01-05  Joseph Myers  <joseph@codesourcery.com>

	* configure.ac: Handle arm*-*-nucleuseabi.
	* configure: Regenerate.

	bfd/
	* config.bfd: Handle arm*-*-nucleuseabi*.

	gas/
	* configure.tgt: Handle arm*-*-nucleuseabi*.

	gas/testsuite/
	* gas/elf/elf.exp: Handle arm*-*-nucleuseabi*.

	ld/
	* configure.tgt: Handle arm*-*-nucleuseabi.

2009-12-18  Maciej W. Rozycki  <macro@codesourcery.com>

	libiberty/
	* pex-common.c (pex_read_err): Set stderr_pipe to -1 if a
	corresponding stream has been opened.
	(pex_free): Close pipe file descriptors corresponding to child's
	stdout and stderr before waiting.

2009-12-17  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Do not mark calls
	to undefined weak functions as needing jalx.

2009-12-17  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf32-sh.c (create_got_section): Create .rofixup section
	for shared objects also.

2009-12-15  Maciej W. Rozycki  <macro@codesourcery.com>

	opcodes/
	* mips-opc.c (mips_builtin_opcodes): Add "sync_acquire",
	"sync_mb", "sync_release", "sync_rmb" and "sync_wmb".

	gas/testsuite/
	* gas/mips/mips32r2-sync.d: New test for MIPS32r2 "sync"
	instruction variants.
	* gas/mips/mips32r2-sync.s: Source for the new test.
	* gas/mips/mips.exp: Run the new test.

	* release-notes-csl.xml
	(MIPS32 revision 2.61 SYNC instruction types): New.

2009-12-14  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/eret-2.s: Add an instruction to fill a branch delay
	slot.
	* gas/mips/eret-2.d: Adjust accordingly.

2009-12-14  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/aent.d: New test.
	* gas/mips/aent.s: Source for the new test.
	* gas/mips/mips.exp: Run it.

2009-12-09  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6970

	gas/
	* config/tc-arm.c (struct arm_it): New flag 'is_neon'.
	(NEON_ENC_*): Macros renamed to NEON_ENC_*_.
	(NEON_ENCODE): New macro.
	(check_neon_suffixes): New macro.
	(do_vfp_cond_or_thumb): Set the 'is_neon' flag.
	(do_vfp_nsyn_opcode): Likewise.
	(do_vfp_nsyn_nmul): Use the new 'NEON_ENCODE' macro.
	(do_vfp_nsyn_cmp): Likewise.
	(do_neon_shl_imm): Likewise.
	(do_neon_qshl_imm): Likewise.
	(neon_dyadic_misc): Likewise.
	(do_neon_mac_maybe_scalar): Likewise.
	(do_neon_qdmulh): Likewise.
	(do_neon_qmovn): Likewise.
	(do_neon_qmovun): Likewise.
	(do_neon_movn): Likewise.
	(neon_mac_reg_scalar_long): Likewise.
	(do_neon_vmull): Likewise.
	(do_neon_trn): Likewise.
	(do_neon_ldx_stx): Likewise.
	(neon_dp_fixup): Changed signature and set the flag.
	(neon_three_same): Call the above with new signature.
	(neon_two_same): Likewise.
	(neon_imm_shift): Likewise.
	(neon_mul_mac): Likewise.
	(do_neon_abs_neg): Likewise.
	(neon_mixed_length): Likewise.
	(do_neon_ext): Likewise.
	(do_neon_mov): Likewise.
	(do_neon_tbl_tbx): Likewise.
	(do_neon_logic): Likewise, and use the new 'NEON_ENCODE' macro.
	(neon_compare): Likewise.
	(do_neon_shll): Likewise.
	(do_neon_cvt): Likewise.
	(do_neon_mvn): Likewise.
	(do_neon_dup): Likewise.
	(md_assemble): Call check_neon_suffixes macro.

	gas/testsuite/
	* gas/arm/neon-suffix-bad.d: New test case.
	* gas/arm/neon-suffix-bad.s: New file.
	* gas/arm/neon-suffix-bad.l: New file.

	* release-notes-csl.xml: Document fix.

2009-12-07  Maxim Kuvyrkov  <maxim@codesourcery.com>
	    Sandra Loosemore  <sandra@codesourcery.com>

	Backport from upstream:

	* release-notes-csl.xml: Add release note.
	opcodes/
	2009-11-30  Massimo Ruo Roch  <massimo.ruoroch@polito.it>
	PR gas/11030
	* m68k-opc.c (m68k_opcodes): Allow the STLDSR instruction on the
	Coldfire ISA A+.

2009-12-02  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6338

	opcodes/
	* arm-dis.c (print_insn): Fixed search for next
	symbol and data dumping condition, and the
	initial mapping symbol state.

	gas/testsuite/
	* gas/arm/dis-data.d: New test case.
	* gas/arm/dis-data.s: New file.

	* release-notes-csl.xml: Document fix.

2009-11-27  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #7025

	gas/
	* config/tc-arm.c (do_neon_logic): Accept imm value
	in the third operand too.
	(operand_parse_code): OP_RNDQ_IMVNb renamed to
	OP_RNDQ_Ibig.
	(parse_operands): OP_NILO case removed, applied renaming.
	(insns): Neon shape changed for some logic instructions.

	gas/testsuite/
	* gas/arm/neon-logic.d: New test case.
	* gas/arm/neon-logic.s: New file.

	* release-notes-csl.xml: Document fix.

2009-11-27  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #3532

	bfd/
	* elf32-arm.c (elf32_arm_final_link_relocate): limits
	fixed.

	ld/testsuite/
	* ld-arm/arm-elf.exp (armelftests): New test case added.
	* ld-arm/reloc-boundaries.s: New file.
	* ld-arm/reloc-boundaries.d: New file.

	* release-notes-csl.xml: Document fix.

2009-11-27  Joseph Myers  <joseph@codesourcery.com>

	Issue #6819

	include/elf/
	* sh.h (R_SH_GOT20, R_SH_GOTOFF20, R_SH_GOTFUNCDESC,
	R_SH_GOTFUNCDESC20, R_SH_GOTOFFFUNCDESC, R_SH_GOTOFFFUNCDESC20,
	R_SH_FUNCDESC, R_SH_FUNCDESC_VALUE): Renumber to 201 to 208.
	(R_SH_LAST_INVALID_RELOC_3, R_SH_FIRST_INVALID_RELOC_4,
	R_SH_LAST_INVALID_RELOC_4, R_SH_FIRST_INVALID_RELOC_5,
	R_SH_LAST_INVALID_RELOC_5, R_SH_FIRST_INVALID_RELOC_6): Update.

	bfd/
	* elf32-sh-relocs.h (R_SH_GOT20, R_SH_GOTOFF20, R_SH_GOTFUNCDESC,
	R_SH_GOTFUNCDESC20, R_SH_GOTOFFFUNCDESC, R_SH_GOTOFFFUNCDESC20,
	R_SH_FUNCDESC, R_SH_FUNCDESC_VALUE): Renumber to 201 to 208.

2009-11-27  Nathan Sidwell  <nathan@codesourcery.com>

	* release-notes-csl.xml: Remove associated release note.
	
	Revert 2009-11-23  Daniel Gutson  <dgutson@codesourcery.com>
	Issue #6338
	opcodes/
	* arm-dis.c (print_insn): Fixed search for next
	symbol and data dumping condition.

2009-11-25  Catherine Moore  <clm@codesourcery.com>

	* release-notes-csl.xml: Restore note.
	opcodes/
	* arm-dis.c: Restore patch lost in micromips merge.

2009-11-23  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6338

	opcodes/
	* arm-dis.c (print_insn): Fixed search for next
	symbol and data dumping condition.

2009-11-19  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6741

	bfd/
	* elf-attrs.c (_bfd_elf_merge_object_attributes): Error
	message rephrased.

2009-11-19  Catherine Moore  <clm@codesourcery.com>

	Merge from micromips branch:

	2009-10-22  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	2009-10-22  Maciej W. Rozycki  <macro@codesourcery.com>
	* gas/mips/jal-mask-11.d: New test.
	* gas/mips/jal-mask-12.d: Likewise.
	* gas/mips/micromips@jal-mask-11.d: Likewise.
	* gas/mips/jal-mask-1.s: Source for the new tests.
	* gas/mips/jal-mask-21.d: New test.
	* gas/mips/jal-mask-22.d: Likewise.
	* gas/mips/micromips@jal-mask-12.d: Likewise.
	* gas/mips/jal-mask-2.s: Source for the new tests.
	* gas/mips/mips.exp: Run the new tests.

	opcodes/
	2009-10-19  Chao-ying Fu  <fu@mips.com>
	* mips-dis.c (print_insn_micromips): Fix the address mask used
	for J, JAL and JALS instructions with the 'a' operand specifier.

	2009-10-15  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/micromips-trap.d: Add a BAL delay slot size test.
	* gas/mips/micromips.d: Likewise.
	* gas/mips/micromips.s: Update accordingly.

	2009-10-15  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	2009-10-01  Chao-ying Fu  <fu@mips.com>
	* config/tc-mips.c (mips32_to_micromips_reg_q_map): Adjust a
	comment.
	(mips32_to_micromips_reg_h_map): New variable.
	(mips32_to_micromips_reg_m_map): Likewise.
	(mips32_to_micromips_reg_n_map): New macro.
	(micromips_to_32_reg_h_map): New variable.
	(micromips_to_32_reg_i_map): Likewise.
	(micromips_to_32_reg_m_map): Likewise.
	(micromips_to_32_reg_n_map): New macro.
	(append_insn): Handle microMIPS "mh", "mi", "mm" and "mn"
	operands.
	(micromips_ip): Likewise.

	gas/testsuite/
	2009-10-15  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* gas/mips/micromips@mips4-fp.d: Change floating-point
	instruction encodings.
	* gas/mips/micromips@mips5.d: Likewise.
	* gas/mips/micromips-trap.d: Likewise.  Add MOVEP, BGEZALS and
	BLTZALS tests.
	* gas/mips/micromips.d: Likewise.
	* gas/mips/micromips.s: Update accordingly.

	include/opcode/
	2009-10-01  Chao-ying Fu  <fu@mips.com>
	* mips.h (INSN2_MOD_GPR_MHI): New macro.
	(INSN2_MOD_GPR_MM, INSN2_MOD_GPR_MN): Likewise.
	(MICROMIPSOP_MASK_MH, MICROMIPSOP_SH_MH): Likewise.
	(MICROMIPSOP_MASK_MI, MICROMIPSOP_SH_MI): Likewise.
	(MICROMIPSOP_MASK_MM, MICROMIPSOP_SH_MM): Likewise.
	(MICROMIPSOP_MASK_MN, MICROMIPSOP_SH_MN): Likewise.
	(MICROMIPSOP_MASK_MK, MICROMIPSOP_SH_MK): Remove macros.

	opcodes/
	2009-10-15  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* micromips-opc.c (MOD_mhi, MOD_mm, MOD_mn): New macros.
	(micromips_opcodes): Add "bals", "bgezals", "bltzals" and
	"movep".  Change "add.d", "add.ps", "div.d", "movn.d",
	"movn.ps", "movn.s", "movz.d", "movz.ps", "movz.s", "mul.d",
	"mul.ps", "sub.d" and "sub.ps" instruction encodings.  Fix
	"msubu", "suxc1" and "swxc1" register usage annotation.  
	* mips-dis.c (micromips_to_32_reg_h_map): New variable.
	(micromips_to_32_reg_i_map): Likewise.
	(micromips_to_32_reg_m_map): Likewise.
	(micromips_to_32_reg_n_map): New macro.
	(print_insn_micromips) Handle microMIPS "mh", "mi", "mm" and
	"mn" operands.

	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	2009-07-17  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* config/tc-mips.c (mips_set_options): Rename ase_mucon to
	ase_mcu.
	(mips_after_parse_args): Update accordingly.
	(ISA_SUPPORTS_MUCON_ASE): Rename to...
	(ISA_SUPPORTS_MCU_ASE): ... this.
	(MIPS_CPU_ASE_MUCON): Rename to...
	(MIPS_CPU_ASE_MCU): ... this.
	(mips_cpu_info_table): Update accordingly.
	(is_opcode_valid): Replace INSN_MUCON with INSN_MCU.
	(options): Replace OPTION_MUCON and OPTION_NO_MUCON with
	OPTION_MCU and OPTION_NO_MCU, respectively.
	(md_parse_option): Likewise.
	(md_longopts): Replace "mmucon" and "mno-mucon" with "mmcu" and
	"mno-mcu", respectively.
	(md_show_usage): Update accordingly.
	(s_mipsset): Replace "mucon" and "nomucon" with "mcu" and
	"nomcu", respectively.
	Update comments for the MuCon to MCU rename throughout.

	* doc/as.texinfo: Rename -mmucon and -mno-mucon options to -mmcu
	and -mno-mcu, respectively.
	* doc/c-mips.texi: Likewise, and rename ".set mucon" and
	".set nomucon" directives to ".set mcu" and ".set nomcu",
	respectively.

	gas/testsuite/
	2009-07-17  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* gas/mips/mucon.s: Rename file to...
	* gas/mips/mcu.s: ... this.  Use ".set mcu" instead of
	".set mucon".
	* gas/mips/mucon.d: Rename file to...
	* gas/mips/mcu.d: ... this.  Update for the MuCon to MCU rename.
	* gas/mips/micromips@mucon.d: Rename file to...
	* gas/mips/micromips@mcu.d: ... this.  Update for the MuCon to
	MCU rename.
	* gas/mips/mips.exp: Update test invocation accordingly.

	include/opcode/
	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>
	* mips.h (INSN_MUCON): Rename to...
	(INSN_MCU): ... this.
	Update comments for the MuCon to MCU rename throughout.

	opcodes/
	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>
	* micromips-opc.c (MC): Replace INSN_MUCON with INSN_MCU.
	* mips-opc.c (MC): Likewise.
	* mips-dis.c (mips_arch_choices): Likewise.

	2009-07-17  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	2009-07-17  Chao-ying Fu  <fu@mips.com>
	* config/tc-mips.c (mips_cpu_info_table): Add "m14k".
	* doc/c-mips.texi (MIPS architecture options): Add "m14k" to the
	list of -march options.

	2009-06-30  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	* config/tc-mips.c (append_insn): Replace INSN2_MOD_31 with
	INSN2_READ_GPR_31.  Merge with code to handle INSN_WRITE_GPR_31.

	gas/testsuite/
	* gas/mips/micromips@beq.d: Adjust for fixed BAL delay slot
	disassembly.
	* gas/mips/micromips@branch-misc-1.d: Likewise.
	* gas/mips/micromips@branch-misc-2.d: Likewise.
	* gas/mips/micromips@branch-misc-2-64.d: Likewise.
	* gas/mips/micromips@branch-misc-2pic.d: Likewise.
	* gas/mips/micromips@branch-misc-2pic-64.d: Likewise.

	include/opcode/
	* mips.h (INSN2_MOD_31): Rename to...
	(INSN2_READ_GPR_31): ... this.
	(INSN2_UNCOND_BRANCH, INSN2_COND_BRANCH): New macros.

	opcodes/
	* micromips-opc.c (MOD_31): Remove macro.
	(UBR, CBR, RD_31): New macros.
	(micromips_opcodes): Add branch annotation for "beqzc", "bnezc",
	"jraddiusp" and "jrc".  Update register use annotation for
	"jraddiusp", 16-bit "jalr" and 16-bit "jalrs".
	* mips-dis.c (print_insn_micromips): Add branch instruction type
	and delay slot determination.

	2009-06-30  Maciej W. Rozycki  <macro@codesourcery.com>

	opcodes/
	* mips-dis.c (print_insn_mips): Correct branch instruction type
	determination.

	2009-06-30  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	* config/tc-mips.c (nops_for_insn_or_target): Replace
	MIPS16_INSN_BRANCH with MIPS16_INSN_UNCOND_BRANCH and
	MIPS16_INSN_COND_BRANCH.

	include/opcode/
	* mips.h (MIPS16_INSN_UNCOND_BRANCH): New macro.
	(MIPS16_INSN_BRANCH): Rename to...
	(MIPS16_INSN_COND_BRANCH): ... this.

	opcodes/
	* mips-dis.c (print_mips16_insn_arg): Remove branch instruction
	type and delay slot determination.
	(print_insn_mips16): Extend branch instruction type and delay
	slot determination to cover all instructions.
	* mips16-opc.c (BR): Remove macro.
	(UBR, CBR): New macros.
	(mips16_opcodes): Update branch annotation for "b", "beqz",
	"bnez", "bteqz" and "btnez".  Add branch annotation for "jalrc"
	and "jrc".

	2009-06-30  Maciej W. Rozycki  <macro@codesourcery.com>

	include/opcode/
	* mips.h: Correct description of the "mX" microMIPS instruction
	argument specifier.

	2009-06-22  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	2009-06-19  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* elfxx-mips.c (micromips_reloc_shuffle_p): Correct TLS
	relocations.

	2009-06-04  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* config/tc-mips.c (mips_set_options): Add ase_mucon.
	(mips_opts): Initialise ase_mucon to -1.
	(ISA_SUPPORTS_MUCON_ASE): New macro.
	(MIPS_CPU_ASE_MUCON): Likewise.
	(is_opcode_valid): Handle MuCon.
	(macro_build): Likewise.
	(macro): Likewise.
	(validate_mips_insn): Likewise.
	(mips_ip): Likewise.
	(options): Add OPTION_MUCON and OPTION_NO_MUCON.
	(md_longopts): Add mmucon and mno-mucon.
	(md_parse_option): Handle OPTION_MUCON and OPTION_NO_MUCON.
	(mips_after_parse_args): Handle MuCon.
	(s_mipsset): Likewise.
	(md_show_usage): Handle MuCon options.
	(micromips_macro): Handle MuCon.

	* doc/as.texinfo: Document -mmucon and -mno-mucon options.
	* doc/c-mips.texi: Likewise, and document ".set mucon" and
	".set nomucon" directives.

	gas/testsuite/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* gas/mips/micromips@mucon.d: New test.
	* gas/mips/mucon.d: Likewise.
	* gas/mips/mucon.s: New test source.
	* gas/mips/mips.exp: Run the new tests.

	include/opcode/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* mips.h (OP_MASK_3BITPOS, OP_SH_3BITPOS): New macros.
	(OP_MASK_OFFSET12, OP_SH_OFFSET12): Likewise.
	(INSN_ASE_MASK): Add the MuCon bit.
	(INSN_MUCON): New macro.
	(M_ACLR_AB, M_ACLR_OB, M_ASET_AB, M_ASET_OB): New enum values.

	opcodes/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* mips-dis.c (mips_arch_choices): Enable MuCon for "mips32r2"
	and "mips64r2".
	(print_insn_args): Handle MuCon.
	* micromips-opc.c (MC): New macro.
	(micromips_opcodes): Add "aclr", "aset" and "iret".
	* mips-opc.c (MC): New macro.
	(mips_builtin_opcodes): Add "aclr", "aset" and "iret".

	2009-06-04  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/micromips@abs.d: New test.
	* gas/mips/micromips@add.d: Likewise.
	* gas/mips/micromips@and.d: Likewise.
	* gas/mips/micromips@beq.d: Likewise.
	* gas/mips/micromips@bge.d: Likewise.
	* gas/mips/micromips@bgeu.d: Likewise.
	* gas/mips/micromips@blt.d: Likewise.
	* gas/mips/micromips@bltu.d: Likewise.
	* gas/mips/micromips@branch-likely.d: Likewise.
	* gas/mips/micromips@branch-misc-1.d: Likewise.
	* gas/mips/micromips@branch-misc-2-64.d: Likewise.
	* gas/mips/micromips@branch-misc-2.d: Likewise.
	* gas/mips/micromips@branch-misc-2pic-64.d: Likewise.
	* gas/mips/micromips@branch-misc-2pic.d: Likewise.
	* gas/mips/micromips@dli.d: Likewise.
	* gas/mips/micromips@elf-jal.d: Likewise.
	* gas/mips/micromips@elf-rel2.d: Likewise.
	* gas/mips/micromips@elf-rel4.d: Likewise.
	* gas/mips/micromips@lb-svr4pic-ilocks.d: Likewise.
	* gas/mips/micromips@li.d: Likewise.
	* gas/mips/micromips@mips1-fp.d: Likewise.
	* gas/mips/micromips@mips32-cp2.d: Likewise.
	* gas/mips/micromips@mips32-imm.d: Likewise.
	* gas/mips/micromips@mips32-sf32.d: Likewise.
	* gas/mips/micromips@mips32.d: Likewise.
	* gas/mips/micromips@mips32r2-cp2.d: Likewise.
	* gas/mips/micromips@mips32r2-fp32.d: Likewise.
	* gas/mips/micromips@mips32r2.d: Likewise.
	* gas/mips/micromips@mips4-branch-likely.d: Likewise.
	* gas/mips/micromips@mips4-fp.d: Likewise.
	* gas/mips/micromips@mips4.d: Likewise.
	* gas/mips/micromips@mips5.d: Likewise.
	* gas/mips/micromips@mips64-cp2.d: Likewise.
	* gas/mips/micromips@mips64.d: Likewise.
	* gas/mips/micromips@mips64r2.d: Likewise.
	* gas/mips/micromips@rol-hw.d: Likewise.
	* gas/mips/micromips@uld2-eb.d: Likewise.
	* gas/mips/micromips@uld2-el.d: Likewise.
	* gas/mips/micromips@ulh3-eb.d: Likewise.
	* gas/mips/micromips@ulh3-el.d: Likewise.
	* gas/mips/micromips@ulw2-eb-ilocks.d: Likewise.
	* gas/mips/micromips@ulw2-el-ilocks.d: Likewise.
	* gas/mips/mips32-imm.d: Likewise.
	* gas/mips/mips32.d: Update immediates.
	* gas/mips/micromips@mips32-cp2.s: New test source.
	* gas/mips/micromips@mips32-imm.s: Likewise.
	* gas/mips/micromips@mips32r2-cp2.s: Likewise.
	* gas/mips/micromips@mips64-cp2.s: Likewise.
	* gas/mips/mips32-imm.s: Likewise.
	* gas/mips/mips32.s: Handle microMIPS.
	* gas/mips/mips.exp: Add the micromips arch.  Exclude mips16e
	from micromips.  Run mips32-imm.

	2009-06-04  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/mips.exp (run_dump_test_arch): Check for the presence
	of an architecture-specific test first and use it if found,
	before falling back to the generic one.

	2009-06-04  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Ilie Garbacea  <ilie@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* archures.c (bfd_mach_mips_micromips): New macro.
	* cpu-mips.c (I_micromips): New enum value.
	(arch_info_struct): Add bfd_mach_mips_micromips.
	* elf32-mips.c (elf_micromips_ctor64_howto): New variable.
	(elf_micromips_howto_table_rel): Likewise.
	(_bfd_mips_elf32_gprel16_reloc): Handle microMIPS.
	(mips_elf_gprel32_reloc): Update comment.
	(mips32_64bit_reloc): Support R_MICROMIPS_32.
	(micromips_reloc_map): New variable.
	(bfd_elf32_bfd_reloc_type_lookup): Handle microMIPS.
	(mips_elf32_rtype_to_howto): Likewise.
	(mips_info_to_howto_rel): Likewise.
	(elf32_mips_relax_delete_bytes): New function.
	(opcode_descriptor): New structure.
	(b_insns_32, b_insn_16): New variables.
	(BZ32_REG, BZ32_REG_FIELD): New macros.
	(bz_insns_32, bzc_insns_32, bz_insns_16): New variables.
	(BZ16_VALID_REG, BZ16_REG_FIELD): New macros.
	(jal_insn_32_bd16, jal_insn_32_bd32): New variables.
	(jalr_insn_32_bd16, jalr_insn_32_bd32): Likewise.
	(ds_insns_32_bd16, ds_insns_32_bd32): Likewise.
	(jalr_insn_16_bd16, jalr_insn_16_bd32): Likewise.
	(ds_insns_16_bd16): Likewise.
	(lui_insn, addiu_insn, addiupc_insn): Likewise.
	(ADDIU_REG, ADDIUPC_VALID_REG, ADDIUPC_REG_FIELD): New macros.
	(lwgp_insn_32, lwgp_insn_16): New functions.
	(LWGP32_REG, LWGP16_VALID_REG, LWGP16_REG_FIELD): New macros.
	(MOVE32_RD, MOVE32_RS): Likewise.
	(MOVE16_RD_FIELD, MOVE16_RS_FIELD): Likewise.
	(move_insns_32, move_insns_16): New variables.
	(nop_insn_32, nop_insn_16): Likewise.
	(MATCH): New macro.
	(find_match): New function.
	(relax_delay_slot): Likewise.
	(IS_BITSIZE): New macro.
	(elf32_mips_relax_section): New function.
	(bfd_elf32_bfd_relax_section): Define.
	* elf64-mips.c (micromips_elf64_howto_table_rel): New variable.
	(micromips_elf64_howto_table_rela): Likewise.
	(micromips_reloc_map): Likewise.
	(bfd_elf64_bfd_reloc_type_lookup): Handle microMIPS.
	(bfd_elf64_bfd_reloc_name_lookup): Likewise.
	(mips_elf64_rtype_to_howto): Likewise.
	* elfn32-mips.c (elf_micromips_howto_table_rel): New variable.
	(elf_micromips_howto_table_rela): Likewise.
	(micromips_reloc_map): Likewise.
	(bfd_elf32_bfd_reloc_type_lookup): Handle microMIPS.
	(bfd_elf32_bfd_reloc_name_lookup): Likewise.
	(mips_elf_n32_rtype_to_howto): Likewise.
	* elfxx-mips.c (TLS_RELOC_P): Handle microMIPS.
	(micromips_reloc_shuffle_p): Likewise.
	(got16_reloc_p, call16_reloc_p): Likewise.
	(hi16_reloc_p, lo16_reloc_p): Likewise.
	(_bfd_mips16_elf_reloc_unshuffle): Likewise.
	(_bfd_mips16_elf_reloc_shuffle): Likewise.
	(_bfd_mips_elf_lo16_reloc): Likewise.
	(mips_elf_initialize_tls_slots): Likewise.
	(mips_tls_got_index, mips_elf_got_page): Likewise.
	(mips_elf_create_local_got_entry): Likewise.
	(mips_elf_relocation_needs_la25_stub): Likewise.
	(mips_elf_calculate_relocation): Likewise.
	(mips_elf_perform_relocation): Likewise.
	(_bfd_mips_elf_symbol_processing): Likewise.
	(_bfd_mips_elf_add_symbol_hook): Likewise.
	(_bfd_mips_elf_link_output_symbol_hook): Likewise.
	(mips_elf_add_lo16_rel_addend): Likewise.
	(_bfd_mips_elf_check_relocs): Likewise.
	(mips_elf_adjust_addend): Likewise.
	(_bfd_mips_elf_relocate_section): Likewise.
	(_bfd_mips_vxworks_finish_dynamic_symbol): Likewise.
	(_bfd_mips_elf_gc_sweep_hook): Likewise.
	(_bfd_mips_elf_print_private_bfd_data):	Likewise.
	* reloc.c (BFD_RELOC_MICROMIPS_64, BFD_RELOC_MICROMIPS_32): New
	relocations.
	(BFD_RELOC_MICROMIPS_16): Likewise.
	(BFD_RELOC_MICROMIPS_7_PCREL_S1): Likewise.
	(BFD_RELOC_MICROMIPS_10_PCREL_S1): Likewise.
	(BFD_RELOC_MICROMIPS_16_PCREL_S1): Likewise.
	(BFD_RELOC_MICROMIPS_GPREL16): Likewise.
	(BFD_RELOC_MICROMIPS_GPREL32): Likewise.
	(BFD_RELOC_MICROMIPS_JMP, BFD_RELOC_MICROMIPS_HI16): Likewise.
	(BFD_RELOC_MICROMIPS_HI16_S, BFD_RELOC_MICROMIPS_LO16): Likewise.
	(BFD_RELOC_MICROMIPS_LITERAL): Likewise.
	(BFD_RELOC_MICROMIPS_GOT16): Likewise.
	(BFD_RELOC_MICROMIPS_CALL16): Likewise.
	(BFD_RELOC_MICROMIPS_GOT_HI16): Likewise.
	(BFD_RELOC_MICROMIPS_GOT_LO16): Likewise.
	(BFD_RELOC_MICROMIPS_CALL_HI16): Likewise.
	(BFD_RELOC_MICROMIPS_CALL_LO16): Likewise.
	(BFD_RELOC_MICROMIPS_SUB): Likewise.
	(BFD_RELOC_MICROMIPS_GOT_PAGE): Likewise.
	(BFD_RELOC_MICROMIPS_GOT_OFST): Likewise.
	(BFD_RELOC_MICROMIPS_GOT_DISP): Likewise.
	(BFD_RELOC_MICROMIPS_HIGHEST): Likewise.
	(BFD_RELOC_MICROMIPS_HIGHER): Likewise.
	(BFD_RELOC_MICROMIPS_SCN_DISP): Likewise.
	(BFD_RELOC_MICROMIPS_JALR): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_DTPMOD32): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_DTPREL32): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_DTPMOD64): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_DTPREL64): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_GD): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_LDM): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_DTPREL_HI16): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_DTPREL_LO16): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_GOTTPREL): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_TPREL32): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_TPREL64): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_TPREL_HI16): Likewise.
	(BFD_RELOC_MICROMIPS_TLS_TPREL_LO16): Likewise.
	* bfd-in2.h: Regenerate.
	* libbfd.h: Regenerate.

	binutils/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	* readelf.c (get_machine_flags): Handle microMIPS.
	(get_mips_symbol_other): Likewise.

	gas/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* config/tc-mips.h (mips_segment_info): Add one bit for
	microMIPS.
	* config/tc-mips.c (emit_branch_likely_macro): New variable.
	(mips_set_options): Add micromips.
	(mips_opts): Initialise micromips to -1.
	(file_ase_micromips): New variable.
	(CPU_HAS_MICROMIPS): New macro.
	(micromips_op_hash): New variable.
	(micromips_nop16_insn, micromips_nop32_insn): New variables.
	(NOP_INSN): Handle microMIPS.
	(mips32_to_micromips_reg_b_map): New macro.
	(mips32_to_micromips_reg_c_map): Likewise.
	(mips32_to_micromips_reg_d_map): Likewise.
	(mips32_to_micromips_reg_e_map): Likewise.
	(mips32_to_micromips_reg_f_map): Likewise.
	(mips32_to_micromips_reg_g_map): Likewise.
	(mips32_to_micromips_reg_l_map): Likewise.
	(mips32_to_micromips_reg_q_map): New variable.
	(micromips_to_32_reg_b_map): New macro.
	(micromips_to_32_reg_c_map): Likewise.
	(micromips_to_32_reg_d_map): Likewise.
	(micromips_to_32_reg_e_map): Likewise.
	(micromips_to_32_reg_f_map): Likewise.
	(micromips_to_32_reg_g_map): Likewise.
	(micromips_to_32_reg_l_map): Likewise.
	(micromips_to_32_reg_q_map): New variable.
	(micromips_imm_b_map, micromips_imm_c_map): New macros.
	(RELAX_DELAY_SLOT_SIZE_ERROR_FIRST): New macro.
	(RELAX_DELAY_SLOT_SIZE_ERROR_SECOND): Likewise.
	(RELAX_MICROMIPS_ENCODE, RELAX_MICROMIPS_P): New macros.
	(RELAX_MICROMIPS_TYPE, RELAX_MICROMIPS_USER_16BIT): Likewise.
	(RELAX_MICROMIPS_UNCOND, RELAX_MICROMIPS_LINK): Likewise.
	(RELAX_MICROMIPS_TOOFAR, RELAX_MICROMIPS_MARK_TOOFAR): Likewise.
	(RELAX_MICROMIPS_CLEAR_TOOFAR): Likewise.
	(RELAX_MICROMIPS_EXTENDED): Likewise.
	(RELAX_MICROMIPS_MARK_EXTENDED): Likewise.
	(RELAX_MICROMIPS_CLEAR_EXTENDED): Likewise.
	(MICROMIPS_INSERT_OPERAND, MICROMIPS_EXTRACT_OPERAND): New
	macros.
	(A_BFD_RELOC_HI16_S, A_BFD_RELOC_HI16, A_BFD_RELOC_LO16): New
	relocation wrapper macros.
	(A_BFD_RELOC_GPREL16, A_BFD_RELOC_GPREL32): Likewise.
	(A_BFD_RELOC_MIPS_GOT16, A_BFD_RELOC_MIPS_GOT_HI16): Likewise.
	(A_BFD_RELOC_MIPS_GOT_LO16, A_BFD_RELOC_MIPS_HIGHEST): Likewise.
	(A_BFD_RELOC_MIPS_HIGHER, A_BFD_RELOC_MIPS_GOT_DISP): Likewise.
	(A_BFD_RELOC_MIPS_GOT_PAGE, A_BFD_RELOC_MIPS_GOT_OFST): Likewise.
	(A_BFD_RELOC_MIPS_SUB, A_BFD_RELOC_64): Likewise.
	(A_BFD_RELOC_MIPS_JALR, A_BFD_RELOC_MIPS_TLS_DTPREL64): Likewise.
	(A_BFD_RELOC_MIPS_TLS_DTPREL32): Likewise.
	(mips_macro_warning): Add delay_slot_16bit_p, delay_slot_32bit_p,
	and num_insns.
	(micromips_16, micromips_32): New variables.
	(is_micromips_16bit_p, is_micromips_32bit_p): New functions.
	(insn_length): Return the length of microMIPS instructions.
	(mips_record_mips16_mode): Rename to...
	(mips_record_mips16_micromips_mode): ... this.  Handle microMIPS.
	(install_insn): Handle microMIPS.
	(is_opcode_valid): Likewise.
	(md_begin): Likewise.
	(md_assemble): Likewise.
	(micromips_reloc_p): New function.
	(got16_reloc_p): Handle microMIPS.
	(hi16_reloc_p): Likewise.
	(lo16_reloc_p): Likewise.
	(matching_lo_reloc): Likewise.
	(mips_move_labels): Likewise.
	(mips16_mark_labels): Rename to...
	(mips16_micromips_mark_labels): ... this.  Handle microMIPS.
	(insns_between): Handle microMIPS.
	(MICROMIPS_TARGET, MICROMIPS_TARGET_LABEL): New macros.
	(micromips_add_number_label): New function.
	(append_insn): Handle microMIPS.
	(start_noreorder, end_noreorder): Likewise.
	(macro_start, macro_warning, macro_end): Likewise.
	(macro_build): Likewise.
	(macro_build_jalr): Likewise.
	(macro_build_lui): Likewise.
	(macro_build_ldst_constoffset): Use relocation wrappers.
	(set_at): Likewise.
	(load_register): Likewise.
	(load_address): Likewise.
	(move_register): Handle microMIPS.
	(load_got_offset): Use relocation wrappers.
	(add_got_offset): Likewise.
	(add_got_offset_hilo): Likewise.
	(macro): Handle microMIPS.
	(validate_micromips_insn): New function.
	(micromips_percent_op): New variable.
	(parse_relocation): Handle microMIPS.
	(my_getExpression): Likewise.
	(options): Add OPTION_MICROMIPS and OPTION_NO_MICROMIPS.
	(md_longopts): Add mmicromips and mno-micromips.
	(md_parse_option): Handle OPTION_MICROMIPS and
	OPTION_NO_MICROMIPS.
	(mips_after_parse_args): Handle microMIPS.
	(md_pcrel_from): Handle microMIPS relocations.
	(mips_force_relocation): Likewise.
	(md_apply_fix): Likewise.
	(mips_align): Handle microMIPS.
	(s_mipsset): Likewise.
	(s_cpload, s_cpsetup, s_cpreturn): Use relocation wrappers.
	(s_dtprel_internal): Likewise.
	(s_gpword, s_gpdword): Likewise.
	(s_insn): Handle microMIPS.
	(s_mips_stab): Likewise.
	(relaxed_micromips_32bit_branch_length): New function.
	(relaxed_micromips_16bit_branch_length): New function.
	(md_estimate_size_before_relax): Handle microMIPS.
	(mips_fix_adjustable): Likewise.
	(tc_gen_reloc): Handle microMIPS relocations.
	(mips_relax_frag): Handle microMIPS.
	(md_convert_frag): Likewise.
	(mips_frob_file_after_relocs): Likewise.
	(mips_elf_final_processing): Likewise.
	(mips_nop_opcode): Likewise.
	(mips_handle_align): Likewise.
	(md_show_usage): Handle microMIPS options.
	(micromips_ip): New function.
	(micromips_macro_build): Likewise.
	(micromips_macro): Likewise.

	* doc/as.texinfo (Target MIPS options): Add -mmicromips and
	-mno-micromips.
	(-mmicromips, -mno-micromips): New options.
	* doc/c-mips.texi (-mmicromips, -mno-micromips): New options.
	(MIPS ISA): Document .set micromips and .set nomicromips.

	gas/testsuite/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* gas/mips/micromips.d: New test.
	* gas/mips/micromips-trap.d: Likewise.
	* gas/mips/micromips-branch-relax-pic.d: Likewise.
	* gas/mips/micromips-branch-relax-pic.d: Likewise.
	* gas/mips/micromips.l: New stderr output.
	* gas/mips/micromips-branch-relax.l: Likewise.
	* gas/mips/micromips-branch-relax-pic.l: Likewise.
	* gas/mips/micromips.s: New test source.
	* gas/mips/micromips-branch-relax.s: Likewise.
	* gas/mips/mips.exp: Run the new tests.

	include/elf/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	* mips.h (R_MICROMIPS_min, R_MICROMIPS_16, R_MICROMIPS_32): New
	relocations.
	(R_MICROMIPS_REL32, R_MICROMIPS_26_S1): Likewise.
	(R_MICROMIPS_HI16, R_MICROMIPS_LO16): Likewise.
	(R_MICROMIPS_GPREL16, R_MICROMIPS_LITERAL): Likewise.
	(R_MICROMIPS_GOT16, R_MICROMIPS_PC7_S1): Likewise.
	(R_MICROMIPS_PC10_S1, R_MICROMIPS_PC16_S1): Likewise.
	(R_MICROMIPS_CALL16, R_MICROMIPS_GPREL32): Likewise.
	(R_MICROMIPS_64, R_MICROMIPS_GOT_DISP): Likewise.
	(R_MICROMIPS_GOT_PAGE, R_MICROMIPS_GOT_OFST): Likewise.
	(R_MICROMIPS_GOT_HI16, R_MICROMIPS_GOT_LO16): Likewise.
	(R_MICROMIPS_SUB, R_MICROMIPS_HIGHER): Likewise.
	(R_MICROMIPS_HIGHEST, R_MICROMIPS_CALL_HI16): Likewise.
	(R_MICROMIPS_CALL_LO16, R_MICROMIPS_SCN_DISP): Likewise.
	(R_MICROMIPS_JALR, R_MICROMIPS_HI0_LO16): Likewise.
	(R_MICROMIPS_TLS_DTPMOD32, R_MICROMIPS_TLS_DTPREL32): Likewise.
	(R_MICROMIPS_TLS_DTPMOD64, R_MICROMIPS_TLS_DTPREL64): Likewise.
	(R_MICROMIPS_TLS_GD, R_MICROMIPS_TLS_LDM): Likewise.
	(R_MICROMIPS_TLS_DTPREL_HI, R_MICROMIPS_TLS_DTPREL_LO): Likewise.
	(R_MICROMIPS_TLS_GOTTPREL, R_MICROMIPS_TLS_TPREL32): Likewise.
	(R_MICROMIPS_TLS_TPREL64, R_MICROMIPS_TLS_TPREL_HI16): Likewise.
	(R_MICROMIPS_TLS_TPREL_LO116, R_MICROMIPS_GLOB_DAT): Likewise.
	(R_MICROMIPS_GPREL7_S2, R_MICROMIPS_PC23_S2): Likewise.
	(R_MICROMIPS_max): Likewise.
	(EF_MIPS_ARCH_ASE_MICROMIPS): New macro.
	(ELF_ST_IS_MIPS_PLT): Likewise.
	(STO_MICROMIPS): Likewise.
	(ELF_ST_IS_MICROMIPS, ELF_ST_MICROMIPS, ELF_ST_SET_MICROMIPS):
	Likewise.
	(ELF_ST_IS_MIPS_PIC, ELF_ST_SET_MIPS_PIC): Handle microMIPS.

	include/opcode/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* mips.h
	(INSN2_BRANCH_DELAY_16BIT, INSN2_BRANCH_DELAY_32BIT): New macros.
	(INSN2_WRITE_GPR_S, INSN2_READ_FPR_D): Likewise.
	(INSN2_MOD_GPR_MB, INSN2_MOD_GPR_MC, INSN2_MOD_GPR_MD): Likewise.
	(INSN2_MOD_GPR_ME, INSN2_MOD_GPR_MF, INSN2_MOD_GPR_MG): Likewise.
	(INSN2_MOD_GPR_MJ, INSN2_MOD_GPR_MP, INSN2_MOD_GPR_MQ): Likewise.
	(INSN2_MOD_SP, INSN2_MOD_31): Likewise.
	(INSN2_READ_GP, INSN2_READ_PC): Likewise.
	(CPU_MICROMIPS): New macro.
	(M_BC1FL, M_BC1TL, M_BC2FL, M_BC2TL, M_BEQL, M_BGEZL): New enum
	values.
	(M_BGEZALL, M_BGTZL, M_BLEZL, M_BLTZL, M_BLTZALL): Likewise.
	(M_CACHE_OB, M_LDC2_OB, M_LDL_OB, M_LDM_AB, M_LDM_OB): Likewise.
	(M_LDP_AB, M_LDP_OB, M_LDR_OB, M_LL_OB, M_LLD_OB): Likewise.
	(M_LWC2_OB, M_LWL_OB, M_LWM_AB, M_LWP_AB, M_LWP_OB): Likewise.
	(M_LWR_OB, M_LWU_OB, M_PREF_OB, M_SC_OB, M_SCD_OB): Likewise.
	(M_SDC2_OB, M_SDL_OB, M_SDM_AB, M_SDM_OB, M_SDP_AB): Likewise.
	(M_SDP_OB, M_SDR_OB, M_SWC2_OB, M_SWL_OB, M_SWM_AB): Likewise.
	(M_SWM_OB, M_SWP_AB, M_SWP_OB, M_SWR_OB): Likewise.
	(MICROMIPSOP_MASK_MAJOR, MICROMIPSOP_SH_MAJOR): New macros.
	(MICROMIPSOP_MASK_IMMEDIATE, MICROMIPSOP_SH_IMMEDIATE): Likewise.
	(MICROMIPSOP_MASK_DELTA, MICROMIPSOP_SH_DELTA): Likewise.
	(MICROMIPSOP_MASK_CODE10, MICROMIPSOP_SH_CODE10): Likewise.
	(MICROMIPSOP_MASK_TRAP, MICROMIPSOP_SH_TRAP): Likewise.
	(MICROMIPSOP_MASK_SHAMT, MICROMIPSOP_SH_SHAMT): Likewise.
	(MICROMIPSOP_MASK_TARGET, MICROMIPSOP_SH_TARGET): Likewise.
	(MICROMIPSOP_MASK_EXTLSB, MICROMIPSOP_SH_EXTLSB): Likewise.
	(MICROMIPSOP_MASK_EXTMSBD, MICROMIPSOP_SH_EXTMSBD): Likewise.
	(MICROMIPSOP_MASK_INSMSB, MICROMIPSOP_SH_INSMSB): Likewise.
	(MICROMIPSOP_MASK_BREAKCODE, MICROMIPSOP_SH_BREAKCODE): Likewise.
	(MICROMIPSOP_SH_BREAKCODE2): Likewise.
	(MICROMIPSOP_MASK_CACHEOP, MICROMIPSOP_SH_CACHEOP): Likewise.
	(MICROMIPSOP_MASK_COPSEL, MICROMIPSOP_SH_COPSEL): Likewise.
	(MICROMIPSOP_MASK_OFFSET12, MICROMIPSOP_SH_OFFSET12): Likewise.
	(MICROMIPSOP_MASK_3BITPOS, MICROMIPSOP_SH_3BITPOS): Likewise.
	(MICROMIPSOP_MASK_STYPE, MICROMIPSOP_SH_STYPE): Likewise.
	(MICROMIPSOP_MASK_OFFSET10, MICROMIPSOP_SH_OFFSET10): Likewise.
	(MICROMIPSOP_MASK_RS, MICROMIPSOP_SH_RS): Likewise.
	(MICROMIPSOP_MASK_RT, MICROMIPSOP_SH_RT): Likewise.
	(MICROMIPSOP_MASK_RD, MICROMIPSOP_SH_RD): Likewise.
	(MICROMIPSOP_MASK_FS, MICROMIPSOP_SH_FS): Likewise.
	(MICROMIPSOP_MASK_FT, MICROMIPSOP_SH_FT): Likewise.
	(MICROMIPSOP_MASK_FD, MICROMIPSOP_SH_FD): Likewise.
	(MICROMIPSOP_MASK_FR, MICROMIPSOP_SH_FR): Likewise.
	(MICROMIPSOP_MASK_RS3, MICROMIPSOP_SH_RS3): Likewise.
	(MICROMIPSOP_MASK_PREFX, MICROMIPSOP_SH_PREFX): Likewise.
	(MICROMIPSOP_MASK_BCC, MICROMIPSOP_SH_BCC): Likewise.
	(MICROMIPSOP_MASK_CCC, MICROMIPSOP_SH_CCC): Likewise.
	(MICROMIPSOP_MASK_COPZ, MICROMIPSOP_SH_COPZ): Likewise.
	(MICROMIPSOP_MASK_MB, MICROMIPSOP_SH_MB): Likewise.
	(MICROMIPSOP_MASK_MC, MICROMIPSOP_SH_MC): Likewise.
	(MICROMIPSOP_MASK_MD, MICROMIPSOP_SH_MD): Likewise.
	(MICROMIPSOP_MASK_ME, MICROMIPSOP_SH_ME): Likewise.
	(MICROMIPSOP_MASK_MF, MICROMIPSOP_SH_MF): Likewise.
	(MICROMIPSOP_MASK_MG, MICROMIPSOP_SH_MG): Likewise.
	(MICROMIPSOP_MASK_MJ, MICROMIPSOP_SH_MJ): Likewise.
	(MICROMIPSOP_MASK_MK, MICROMIPSOP_SH_MK): Likewise.
	(MICROMIPSOP_MASK_ML, MICROMIPSOP_SH_ML): Likewise.
	(MICROMIPSOP_MASK_MP, MICROMIPSOP_SH_MP): Likewise.
	(MICROMIPSOP_MASK_MQ, MICROMIPSOP_SH_MQ): Likewise.
	(MICROMIPSOP_MASK_MZ, MICROMIPSOP_SH_MZ): Likewise.
	(MICROMIPSOP_MASK_IMMA, MICROMIPSOP_SH_IMMA): Likewise.
	(MICROMIPSOP_MASK_IMMB, MICROMIPSOP_SH_IMMB): Likewise.
	(MICROMIPSOP_MASK_IMMC, MICROMIPSOP_SH_IMMC): Likewise.
	(MICROMIPSOP_MASK_IMMD, MICROMIPSOP_SH_IMMD): Likewise.
	(MICROMIPSOP_MASK_IMME, MICROMIPSOP_SH_IMME): Likewise.
	(MICROMIPSOP_MASK_IMMF, MICROMIPSOP_SH_IMMF): Likewise.
	(MICROMIPSOP_MASK_IMMG, MICROMIPSOP_SH_IMMG): Likewise.
	(MICROMIPSOP_MASK_IMMH, MICROMIPSOP_SH_IMMH): Likewise.
	(MICROMIPSOP_MASK_IMMI, MICROMIPSOP_SH_IMMI): Likewise.
	(MICROMIPSOP_MASK_IMMJ, MICROMIPSOP_SH_IMMJ): Likewise.
	(MICROMIPSOP_MASK_IMML, MICROMIPSOP_SH_IMML): Likewise.
	(MICROMIPSOP_MASK_IMMM, MICROMIPSOP_SH_IMMM): Likewise.
	(MICROMIPSOP_MASK_IMMN, MICROMIPSOP_SH_IMMN): Likewise.
	(MICROMIPSOP_MASK_IMMO, MICROMIPSOP_SH_IMMO): Likewise.
	(MICROMIPSOP_MASK_IMMP, MICROMIPSOP_SH_IMMP): Likewise.
	(MICROMIPSOP_MASK_IMMQ, MICROMIPSOP_SH_IMMQ): Likewise.
	(MICROMIPSOP_MASK_IMMU, MICROMIPSOP_SH_IMMU): Likewise.
	(MICROMIPSOP_MASK_IMMW, MICROMIPSOP_SH_IMMW): Likewise.
	(MICROMIPSOP_MASK_IMMX, MICROMIPSOP_SH_IMMX): Likewise.
	(MICROMIPSOP_MASK_IMMY, MICROMIPSOP_SH_IMMY): Likewise.
	(micromips_opcodes): New declaration.
	(bfd_micromips_num_opcodes): Likewise.

	opcodes/
	2009-06-04  Chao-ying Fu  <fu@mips.com>
	            Maciej W. Rozycki  <macro@codesourcery.com>
	* micromips-opc.c: New file.
	* mips-dis.c (micromips_to_32_reg_b_map): New array.
	(micromips_to_32_reg_c_map, micromips_to_32_reg_d_map): Likewise.
	(micromips_to_32_reg_e_map, micromips_to_32_reg_f_map): Likewise.
	(micromips_to_32_reg_g_map, micromips_to_32_reg_l_map): Likewise.
	(micromips_to_32_reg_q_map): Likewise.
	(micromips_imm_b_map, micromips_imm_c_map): Likewise.
	(print_insn_micromips): New function.
	(is_micromips_mode_p): New function.
	(_print_insn_mips): Handle microMIPS instructions.
	* Makefile.am (CFILES): Add micromips-opc.c.
	(ALL_MACHINES): Add micromips-opc.lo.
	(micromips-opc.lo): Add dependencies.
	* configure.in (bfd_mips_arch): Add micromips-opc.lo.
	* Makefile.in: Regenerate.
	* configure: Regenerate.

2009-11-18  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (aeabi_set_public_attributes): Correctly mark
	VFPv3xD objects.

2009-11-17  Daniel Jacobowitz  <dan@codesourcery.com>

	Backport from upstream:

	opcodes/
	2009-11-12  Daniel Jacobowitz  <dan@codesourcery.com>

	* arm-dis.c (coprocessor_opcodes): Use %A instead of %C.  Remove
	generic coprocessor instructions for FPA loads and stores.
	(print_insn_coprocessor): Remove %C support.  Display address for
	PC-relative offsets in %A.

	gas/testsuite/
	2009-11-12  Daniel Jacobowitz  <dan@codesourcery.com>

	* gas/arm/copro.d, gas/arm/fp-save.d, gas/arm/float.d,
	gas/arm/fpa-mem.d: Update for removed generic coprocessor instructions
	and expanded PC-relative offsets.

2009-11-17  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6734

	gas/
	* config/tc-arm.c (do_neon_ldx_stx): Added
	validation for vector load/store insns.

	gas/testsuite/
	* gas/arm/neon-addressing-bad.d: New test case.
	* gas/arm/neon-addressing-bad.s: New file.
	* gas/arm/neon-addressing-bad.l: New file.

	release-notes-csl.xml: Document fix.

2009-11-17  Thomas Schwinge  <thomas@codesourcery.com>

	Issues 5002, 5004

	ld/
	* emulparams/armelf.sh (OTHER_READONLY_SECTIONS)
	<__exidx_start, __exidx_end>: Use PROVIDE_HIDDEN.
	* emulparams/armelf_linux_eabi.sh (OTHER_READONLY_SECTIONS)
	<__exidx_start, __exidx_end>: Likewise.
	* emulparams/armsymbian.sh (OTHER_READONLY_SECTIONS)
	<.ARM.exidx$$Base, __exidx_start, __exidx_end, .ARM.exidx$$Limit>:
	Likewise.

	ld/testsuite/
	* ld-arm/arm-dyn.ld: Adapt to main linker script changes.
	* ld-arm/arm-lib.ld: Likewise.
	* ld-arm/armthumb-lib.sym: : Adjust expected results.
	* ld-arm/farcall-mixed-app-v5.d: Likewise.
	* ld-arm/farcall-mixed-app.d: Likewise.
	* ld-arm/farcall-mixed-app.sym: Likewise.
	* ld-arm/farcall-mixed-lib.d: Likewise.
	* ld-arm/mixed-app-v5.d: Likewise.
	* ld-arm/mixed-app.d: Likewise.
	* ld-arm/mixed-app.sym: Likewise.
	* ld-arm/mixed-lib.sym: Likewise.
	* ld-arm/preempt-app.sym: Likewise.
	* ld-arm/tls-app.d: Likewise.

2009-11-11  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6687
	gas/
	* doc-c-arm.texi: Document NEON alignment specifiers.

2009-11-10  Andrew Jenner  <andrew@codesourcery.com>

	gas/
	* config/tc-arm.c (arm_init_frag): Set thumb MODE_RECORDED flag for
	non-elf.

2009-11-10  Catherine Moore  <clm@codesourery.com>

	bfd/
	* elf32-mips.c (elf_backend_want_plt_sym): Remove.
	(elf_backend_plt_readonly): Remove.
	(elf_backend_plt_sym_val): Remove extra definition.
	Remove extra undef.

2009-11-03  Catherine Moore  <clm@codesourcery.com>

	Issue #7050

	Backport from mainline:

	2009-09-21  Maciej W. Rozycki  <macro@linux-mips.org>
	
	* gas/mips/eret-1.s: Add trailing padding.
	* gas/mips/eret-2.s: Likewise.
	* gas/mips/eret-3.s: Likewise.
	* gas/mips/eret-1.d: Adjust accordingly.  Force a 32-bit ABI.
	* gas/mips/eret-2.d: Likewise.
	* gas/mips/eret-3.d: Likewise.

2009-10-30  Nathan Sidwell  <nathan@codesourcery.com>

	Revert Janus2CC erratum patch
	2008-08-28  Julian Brown  <julian@codesourcery.com>

	ld/
	* emultempl/armelf.em (fix_janus_2cc): New variable.
	(arm_elf_before_allocation): Call
	bfd_elf32_arm_validate_janus_2cc_fix and
	bfd_elf32_arm_janus_2cc_erratum_scan.
	(arm_elf_after_allocation): Call bfd_elf32_arm_fix_veneer_locations
	not bfd_elf32_arm_vfp11_fix_veneer_locations.
	(arm_elf_create_output_section_statements): Add fix_janus_2cc
	argument.
	(PARSE_AND_LIST_PROLOGUE): Add OPTION_FIX_JANUS_2CC.
	(PARSE_AND_LIST_LONGOPTS): Add fix-janus-2cc option.
	(PARSE_AND_LIST_OPTIONS): Likewise. (PARSE_AND_LIST_CASES): Add
	OPTION_FIX_JANUS_2CC case.
	* emulparams/armelf.sh (OTHER_TEXT_SECTIONS): Add .janus_2cc_veneer
	section.

	bfd/
	* bfd-in.h (bfd_elf32_arm_validate_janus_2cc_fix): Add prototype.
	(bfd_elf32_arm_janus_2cc_erratum_scan): Add prototype.
	(bfd_elf32_arm_vfp11_fix_veneer_locations): Rename to...
	(bfd_elf32_arm_fix_veneer_locations): This.
	(bfd_elf32_arm_set_target_relocs): Update prototype.
	* bfd-in2.h: Regenerate.
	* elf32-arm.c (VFP11_ERRATUM_VENEER_ENTRY_NAME): Adjust format.
	(JANUS_2CC_ERRATUM_VENEER_SECTION_NAME)
	(JANUS_2CC_ERRATUM_VENEER_ENTRY_NAME, MAX_ERRATUM_SYMBOL_LENGTH):
	New macros.
	(elf32_vfp11_erratum_type): Rename to...
	(elf32_cpu_erratum_type): This. Add Janus 2CC entries.
	(elf32_vfp11_erratum_list): Rename to...
	(elf32_cpu_erratum_list): This. Rename vfp_insn field to orig_insn.
	(_arm_elf_section_data): Update type of erratumlist field.
	(elf32_arm_link_hash_table): Add janus_2cc_erratum_glue_size,
	fix_janus_2cc fields. Rename num_vfp11_fixes to num_errata_fixes.
	(elf32_arm_link_hash_table_create): Initialise above fields.
	(JANUS_2CC_ERRATUM_VENEER_SIZE): New macro.
	(bfd_elf32_arm_allocate_interworking_sections): Initialise Janus
	2CC erratum veneer section.
	(record_vfp11_erratum_veneer): Rename to...
	(record_cpu_erratum_veneer): This. Add argument for type of erratum
	to record. Expand to handle Janus 2CC erratum.
	(bfd_elf32_arm_add_glue_sections_to_bfd): Make Janus 2CC erratum
	veneer section.
	(bfd_elf32_arm_validate_janus_2cc_fix): New.
	(bfd_elf32_arm_vfp11_erratum_scan): Update for new type and field
	names. Call record_cpu_erratum_veneer instead of
	record_vfp11_erratum_veneer.
	(bfd_elf32_arm_vfp11_fix_veneer_locations): Rename to...
	(bfd_elf32_arm_fix_veneer_locations): This. Add Janus 2CC erratum
	support.
	(bfd_elf32_arm_janus_2cc_erratum_scan): New.
	(bfd_elf32_arm_set_target_relocs): Add fix_janus_2cc option. Handle.
	(elf32_arm_size_dynamic_sections): Call
	bfd_elf32_arm_janus_2cc_erratum_scan.
	(elf32_arm_write_section): Add Janus 2CC erratum support.

2009-10-27  Joseph Myers  <joseph@codesourcery.com>

	Issue #6807

	ld/testsuite/
	* ld-sh/fdpic-funcdesc-shared.d, ld-sh/fdpic-funcdesc-shared.s,
	ld-sh/fdpic-funcdesc-static.d, ld-sh/fdpic-funcdesc-static.s,
	ld-sh/fdpic-gotfuncdesc-shared.d,
	ld-sh/fdpic-gotfuncdesc-shared.s,
	ld-sh/fdpic-gotfuncdesc-static.d,
	ld-sh/fdpic-gotfuncdesc-static.s,
	ld-sh/fdpic-gotfuncdesci20-shared.d,
	ld-sh/fdpic-gotfuncdesci20-shared.s,
	ld-sh/fdpic-gotfuncdesci20-static.d,
	ld-sh/fdpic-gotfuncdesci20-static.s, ld-sh/fdpic-goti20-shared.d,
	ld-sh/fdpic-goti20-shared.s, ld-sh/fdpic-goti20-static.d,
	ld-sh/fdpic-goti20-static.s, ld-sh/fdpic-gotofffuncdesc-shared.d,
	ld-sh/fdpic-gotofffuncdesc-shared.s,
	ld-sh/fdpic-gotofffuncdesc-static.d,
	ld-sh/fdpic-gotofffuncdesc-static.s,
	ld-sh/fdpic-gotofffuncdesci20-shared.d,
	ld-sh/fdpic-gotofffuncdesci20-shared.s,
	ld-sh/fdpic-gotofffuncdesci20-static.d,
	ld-sh/fdpic-gotofffuncdesci20-static.s,
	ld-sh/fdpic-gotoffi20-shared.d, ld-sh/fdpic-gotoffi20-shared.s,
	ld-sh/fdpic-gotoffi20-static.d, ld-sh/fdpic-gotoffi20-static.s,
	ld-sh/fdpic-plt-be.d, ld-sh/fdpic-plt-le.d, ld-sh/fdpic-plt.s,
	ld-sh/fdpic-plti20-be.d, ld-sh/fdpic-plti20-le.d,
	ld-sh/fdpic-stack-default.d, ld-sh/fdpic-stack-size.d,
	ld-sh/fdpic-stack.s: New.

2009-10-26  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elf32-sh.c (FDPIC_PLT_LAZY_OFFSET): Change to 20.
	(FDPIC_SH2A_PLT_LAZY_OFFSET): Change to 16.

2009-10-26  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* config.bfd (sh-*-uclinux* | sh[12]-*-uclinux*): Add
	bfd_elf32_shl_vec to targ_selvecs.

	gas/
	* configure.tgt (sh-*-uclinux* | sh[12]-*-uclinux*): Set
	em=uclinux.
	* config/tc-sh.h (TARGET_FORMAT): Define specially for TE_UCLINUX.
	(sh_uclinux_target_format): Declare for TE_UCLINUX.
	* config/tc-sh.c (sh_uclinux_target_format): New.

2009-10-16  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #6792

	* release-notes-csl.xml (Incorrect symbol addresses bug fix):
	New note.

	Backport from mainline:

	ld/
	2009-07-22  H.J. Lu  <hongjiu.lu@intel.com>
	PR ld/10429
	* ldlang.c (insert_os_after): Tie assignments to non-alloc
	output sections if there is no-input section.

	ld/
	2009-07-11  Alan Modra  <amodra@bigpond.net.au>
	* ldlang.c (insert_os_after): Don't tie assignments to non-alloc
	output sections.

2009-10-14  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_relocate_section): Always initialize
	check_segment.

2009-10-14  Joseph Myers  <joseph@codesourcery.com>

	ld/testsuite/
	* ld-scripts/phdrs3.d: Allow colon in name of linker binary.

2009-10-13  Joseph Myers  <joseph@codesourcery.com>

	Merge from FDPIC branch:

	2008-06-12  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_relocate_section): Always generate R_SH_DIR32
	for FDPIC instead of R_SH_RELATIVE.
	(sh_elf_finish_dynamic_symbol): Likewise.

	2008-06-12  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_relocate_section): Change fixup message
	to an error.  Suppress inter-segment warning for relocations
	with dynamic relocations or fixups.

	2008-05-22  Daniel Jacobowitz  <dan@codesourcery.com>

	include/elf/
	* sh.h: Comment temporary relocation assignments.

	bfd/
	* elf32-sh.c (sh_elf_gc_sweep_hook): GC fixup slots.

	2008-05-22  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (DEFAULT_STACK_SIZE): Define.
	(sh_elf_always_size_sections): Handle PT_GNU_STACK and __stacksize.
	(sh_elf_modify_program_headers): New.
	(sh_elf_copy_private_data): Copy PT_GNU_STACK size.
	(sh_elf_encode_eh_address): Define for fdpic.

	2008-04-23  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (SYMBOL_FUNCDESC_LOCAL): Define.  Use it instead
	of SYMBOL_REFERENCES_LOCAL for function descriptors.
	(struct elf_sh_link_hash_entry): Update comments.  Add
	abs_funcdesc_refcount.
	(sh_elf_link_hash_newfunc): Initialize abs_funcdesc_refcount.
	(allocate_dynrelocs): Correct allocation for static executables.
	Use abs_funcdesc_refcount.  Remove unneeded fixups.
	(sh_elf_size_dynamic_sections): Remove unneeded fixups.
	(sh_elf_gc_sweep_hook): Decrement abs_funcdesc_refcount.  Remove
	unneeded fixups.
	(sh_elf_copy_indirect_symbol): Copy abs_funcdesc_refcount.
	(sh_elf_check_relocs): Allocate a GOT for R_SH_DIR32.  Cound
	abs_funcdesc_refcount.  Allocate fixups for R_SH_DIR32.
	(sh_elf_merge_private_data): Reject FDPIC mismatches.
	(sh_elf_finish_dynamic_symbol): Rename srel to srelgot.
	(sh_elf_finish_dynamic_sections): Assert that the right number
	of rofixups and dynamic relocations were allocated.

	2008-04-22  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_relocate_section): Check for cross-segment
	relocations and clear EF_SH_PIC.  Correct symbol name in messages.
	(sh_elf_check_relocs): Short-circuit for non-FDPIC.
	(sh_elf_merge_private_data): Set EF_SH_PIC for FDPIC.
	(sh_elf_use_relative_eh_frame, sh_elf_encode_eh_address): New.
	(elf_backend_can_make_relative_eh_frame)
	(elf_backend_can_make_lsda_relative_eh_frame)
	(elf_backend_encode_eh_address): Define.

	2008-04-22  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (install_movi20_field): New function.
	(install_plt20_field): Delete.
	(sh_elf_relocate_section, sh_elf_gc_sweep_hook)
	(sh_elf_check_relocs): Handle 20-bit relocations.
	(sh_elf_finish_dynamic_symbol): Use install_movi20_field.

	2008-04-21  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_got_offset): Correct sign.
	(sh_elf_relocate_section): Correct offset for R_SH_GOTOFF.  Handle
	R_SH_GOTOFFFUNCDESC.
	(sh_elf_gc_sweep_hook): Handle R_SH_GOTOFFFUNCDESC.
	(sh_elf_check_relocs): Remove error for R_SH_GOTOFFFUNCDESC.  Handle
	it like R_SH_FUNCDESC.

	2008-04-21  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh-relocs.h: Correct typo.
	* elf32-sh.c (struct elf_sh_plt_info): Add got20 and short_plt.  Update
	all definitions.
	(FDPIC_PLT_ENTRY_SIZE, FDPIC_PLT_LAZY_OFFSET): Define.
	(fdpic_sh_plt_entry_be, fdpic_sh_plt_entry_le, fdpic_sh_plts): New.
	(FDPIC_SH2A_PLT_ENTRY_SIZE, FDPIC_SH2A_PLT_LAZY_OFFSET): Define.
	(fdpic_sh2a_plt_entry_be, fdpic_sh2a_plt_entry_le)
	(fdpic_sh2a_short_plt_be, fdpic_sh2a_short_plt_le, fdpic_sh2a_plts):
	New.
	(get_plt_info): Handle FDPIC.
	(MAX_SHORT_PLT): Define.
	(get_plt_index, get_plt_offset): Handle short_plt.
	(allocate_dynrelocs): Do not point the symbol at its PLT entry for
	FDPIC.  Handle short_plt.  Allocate a function descriptor.
	(sh_elf_size_dynamic_sections): Move reserved entries to the end
	of .got.plt.
	(sh_elf_got_offset): Adjust for new value of _GLOBAL_OFFSET_TABLE_.
	(sh_elf_osec_to_segment): Add FIXME.
	(sh_elf_merge_private_data): Copy initial flags.  Do not clobber
	non-mach flags.
	(sh_elf_object_p): Check for FDPIC.
	(install_plt20_field): New.
	(sh_elf_finish_dynamic_symbol): Rename sgot to sgotplt and srel to
	srelplt.  Handle short_plt, FDPIC descriptors, and got20.  Create
	R_SH_FUNCDESC_VALUE for FDPIC.
	(sh_elf_finish_dynamic_sections): Correct DT_PLTGOT.  Rename sgot
	to sgotplt.

	2008-04-16  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_relocate_section): Correct build error.

	2008-04-16  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (allocate_dynrelocs): Only generate fixups for non-TLS
	GOT entries.
	(sh_elf_relocate_section): Generate fixups for R_SH_DIR32 and GOT
	entries.
	(sh_elf_finish_dynamic_sections): Do not fill in reserved GOT entries
	for FDPIC.

	2008-04-16  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (struct elf_sh_link_hash_entry): Adjust description
	of funcdesc.  Remove canon_funcdesc_refcount.  Rename tls_type to
	got_type and adjust all uses.  Add GOT_FUNCDESC.
	(struct sh_elf_obj_tdata): Rename local_got_tls_type to local_got_type.
	(sh_elf_local_got_type): Renamed from sh_elf_local_got_tls_type.  All
	users changed.
	(sh_elf_link_hash_newfunc): Do not set canon_funcdesc_refcount.
	(allocate_dynrelocs): Handle GOT_FUNCDESC.  Create fixups.  Use
	funcdesc.refcount before clobbering it.  Handle GOT entries which
	require function descriptors.
	(sh_elf_size_dynamic_sections): Handle local GOT entries of type
	GOT_FUNCDESC.  Create fixups for local GOT entries.
	(sh_elf_relocate_section): Handle R_SH_GOTFUNCDESC similarly to
	R_SH_FUNCDESC.
	(sh_elf_gc_sweep_hook): Handle R_SH_GOTOFF20, R_SH_GOTFUNCDESC,
	and R_SH_GOTFUNCDESC20.  Update funcdesc.refcount.
	(sh_elf_copy_indirect_symbol): Do not copy canon_funcdesc_refcount.
	(sh_elf_check_relocs): Make FDPIC symbols dynamic even if the
	GOT was already created.  Handle R_SH_GOTFUNCDESC and
	R_SH_GOTFUNCDESC20.  Error for FDPIC symbol mismatches.  Set
	the GOT type even for R_SH_FUNCDESC.
	(sh_elf_finish_dynamic_symbol): Do not handle GOT_FUNCDESC entries
	here.

	2008-04-14  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-sh.c (sh_elf_osec_readonly_p, sh_elf_relocate_section): Fix
	typos.

	2008-04-09  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/
	* emulparams/shlelf_fd.sh: Add comment.
	* emulparams/shelf_fd.sh: Base on shlelf_fd.sh.

	bfd/
	* elf32-sh.c (struct elf_sh_link_hash_table): Add srofixup.
	(create_got_section): Create .rofixup for executables.
	(allocate_dynrelocs): Handle undefined weak symbols.  Allocate
	rofixups.
	(sh_elf_size_dynamic_sections): Allocate rofixups.
	(sh_elf_add_rofixup, sh_elf_osec_to_segment)
	(sh_elf_osec_readonly_p): New functions.
	(sh_elf_initialize_funcdesc): Set segment index.  Create rofixups.
	(sh_elf_relocate_section): Add rofixup read-only section warnings.
	Handle undefined weak symbols.
	(sh_elf_check_relocs): Make symbols dynamic for FDPIC relocs.
	Account for rofixups.
	(sh_elf_finish_dynamic_sections): Fill in the GOT pointer in
	rofixup.

	2008-04-08  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/
	* emulparams/shlelf_fd.sh (GOT, OTHER_GOT_RELOC_SECTIONS): New.
	* emulparams/shelf_fd.sh (GOT, OTHER_GOT_RELOC_SECTIONS): New.

	binutils/
	* readelf.c (get_machine_flags): Handle EF_SH_PIC and EF_SH_FDPIC.

	bfd/
	* config.bfd (sh-*-uclinux*): Add FDPIC vectors.
	* configure.in: Handle FDPIC vectors.
	* targets.c (_bfd_target_vector): Add FDPIC vectors.
	* configure: Regenerate.
	* elf32-sh.c (fdpic_object_p): New.
	(union gotref): New.
	(struct elf_sh_link_hash_entry): Add funcdesc and
	canon_funcdesc_refcount.
	(struct sh_elf_obj_tdata): Add local_funcdesc.
	(sh_elf_local_funcdesc): Define.
	(struct elf_sh_link_hash_table): Add sfuncdesc, srelfuncdesc, and
	fdpic_p.
	(sh_elf_link_hash_newfunc): Initialize new fields.
	(sh_elf_link_hash_table_create): Set fdpic_p.
	(sh_elf_omit_section_dynsym): New.
	(create_got_section): Create .got.funcdesc and .rela.got.funcdesc.
	(allocate_dynrelocs): Allocate local function descriptors and space
	for R_SH_FUNCDESC-related relocations.
	(sh_elf_size_dynamic_sections): Allocate function descriptors for
	local symbols.  Allocate .got.funcdesc contents.
	(sh_elf_add_dyn_reloc, sh_elf_got_offset, sh_elf_initialize_funcdesc):
	New.
	(sh_elf_relocate_section): Handle new relocations, particularly
	R_SH_FUNCDESC.  Use sh_elf_got_offset and .got.plt throughout to
	find _GLOBAL_OFFSET_TABLE_.
	(sh_elf_gc_sweep_hook): Collect R_SH_FUNCDESC.
	(sh_elf_copy_indirect_symbol): Copy function descriptor reference
	counts.
	(sh_elf_check_relocs): Handle new relocations, particularly
	R_SH_FUNCDESC.
	(elf_backend_omit_section_dynsym): Use sh_elf_omit_section_dynsym.
	(TARGET_BIG_SYM, TARGET_BIG_NAME, TARGET_LITTLE_SYM)
	(TARGET_LITTLE_NAME, elf32_bed): Redefine for FDPIC vector.

	2008-04-03  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/
	* Makefile.am (ALL_EMULATIONS): Add eshelf_fd.o and eshlelf_fd.o.
	(eshelf_fd.c, eshlelf_fd.c): New rules.
	* Makefile.in: Regenerate.
	* emulparams/shlelf_fd.sh, emulparams/shelf_fd.sh: New files.
	* emulparams/shlelf_linux.sh: Update comment.
	* configure.tgt (sh-*-uclinux*): Add shelf_fd and shlelf_fd
	emulations.

	ld/testsuite/
	* lib/ld-lib.exp (is_elf_format): Include sh*-*-uclinux*.

	gas/
	* doc/c-sh.texi (SH Options): Document --fdpic.
	* config/tc-sh.c (sh_fdpic): New.
	(enum options): Add OPTION_FDPIC.
	(md_longopts, md_parse_option, md_show_usage): Add --fdpic.
	(sh_elf_final_processing): Handle --fdpic.

	gas/testsuite/
	* lib/gas-defs.exp (is_elf_format): Include sh*-*-uclinux*.

	2008-04-03  Daniel Jacobowitz  <dan@codesourcery.com>

	include/elf/
	* sh.h (EF_SH_PIC, EF_SH_FDPIC): Define.
	(R_SH_FIRST_INVALID_RELOC_6, R_SH_LAST_INVALID_RELOC_6): New.  Adjust
	other invalid ranges.
	(R_SH_GOT20, R_SH_GOTOFF20, R_SH_GOTFUNCDESC, R_SH_GOTFUNCDESC20)
	(R_SH_GOTOFFFUNCDESC, R_SH_GOTOFFFUNCDESC20, R_SH_FUNCDESC)
	(R_SH_FUNCDESC_VALUE): New.

	bfd/
	* elf32-sh-relocs.h: Add FDPIC and movi20 relocations.
	* elf32-sh.c (sh_reloc_map): Add FDPIC and movi20 relocations.
	(sh_elf_info_to_howto, sh_elf_relocate_section): Handle new invalid
	range.
	* reloc.c: Add SH FDPIC and movi20 relocations.
	* bfd-in2.h, libbfd.h: Regenerated.

	gas/
	* config/tc-sh.c (sh_check_fixup): Handle relocations on movi20.
	(parse_exp): Do not reject PIC operators here.
	(build_Mytes): Check for unhandled PIC operators here.  Use
	sh_check_fixup for movi20.
	(sh_fix_adjustable, md_apply_fix): Handle FDPIC and movi20 relocations.
	(sh_parse_name): Handle FDPIC relocation operators.

	gas/testsuite/
	* gas/sh/fdpic.s, gas/sh/sh2a-pic.d, gas/sh/sh2a-pic.s,
	gas/sh/fdpic.d: New files.
	* gas/sh/reg-prefix.d: Force big-endian.
	* gas/sh/basic.exp: Run new tests.  Handle uClinux like Linux.

	ld/testsuite/
	* ld-sh/sh.exp: Handle uClinux like Linux.

2009-10-12  Paul Brook  <paul@codesourcery.com>

	Issue #5767
	gas/
	* doc-c-arm.texi: Document armv7e-m and fp4-sp-d16.
	* config/tc-arm.c (arm_archs): Rename tag13 to armv7e-m.
	(arm_fpus): Add fp4-sp-d16.

	include/opcode/
	* arm.h (ARM_AEXT_TAG13, ARM_ARCH_TAG13): Remove.
	(ARM_AEXT_V7EM, ARM_ARCH_V7EM): Define.
	(FPU_VFP_V4_SP_D16, FPU_ARCH_VFP_V4_SP_D16): Define.

	binutils/
	* readelf.c (arm_attr_tag_CPU_arch): Add v7E-M.

	gas/testsuite/
	* gas/arm/tag13-bad.d: Rename...
	* gas/arm/arch7em-bad.d: ... to this.
	* gas/arm/tag13-bad.l: Rename...
	* gas/arm/arch7em-bad.l: ... to this.
	* gas/arm/tag13.d: Rename...
	* gas/arm/arch7em.d: ... to this.
	* gas/arm/tag13.s: Rename...
	* gas/arm/arch7em.s: ... to this.
	* gas/arm/attr-march-tag13.d: Rename ...
	* gas/arm/attr-march-armv7em.d: ... to this.

2009-10-12  Paul Brook  <paul@codesourcery.com>

	Issue #5767
	gas/
	* doc/c-arm.texi: Document ARM -mcpu=cortex-a5.
	* config/arm/tc-arm.c (arm_cpu_option_table): Add cortex-a5.

2009-10-12  Paul Brook  <paul@codesourcery.com>

	Issue #5767
	gas/
	* config/tc-arm.c (arm_fpus): Update VFPv4 FPU names.
	* doc/c-arm.texi: Document VFPv4 -mfpu options.

	include/opcode/
	* arm.h (FPU_VFP_V4D16, FPU_VFP_V4): Define.
	(FPU_ARCH_VFP_V4, FPU_ARCH_VFP_V4D16, FPU_ARCH_NEON_VFP_V4): Define.
	(FPU_ARCH_VFP_TAG_5, FPU_ARCH_VFP_TAG_6, FPU_ARCH_NEON_FMA_FP16):
	Remove.

	binutils/
	* readelf.c (arm_attr_tag_VFP_arch): Update VFPv4 names.

	gas/testsuite/
	* gas/arm/attr-mfpu-tag-5.d: Rename ...
	* gas/arm/attr-mfpu-vfpv4.d: ... to this.
	* gas/arm/attr-mfpu-tag-6.d: Rename ...
	* gas/arm/attr-mfpu-vfpv4-d16.d: ... to this.
	* gas/arm/neon-fma-cov.d: Update expected output.
	* gas/arm/vfp-fma-arm.d: Ditto.
	* gas/arm/vfp-fma-thumb.d: Ditto.
	* 

	ld/testsuite/
	* ld-arm/attr-merge-vfp-4-d16.s: Use VFPv4 name.
	* ld-arm/attr-merge-vfp-4.s: Use VFPv4 name.
	* ld-arm/attr-merge-vfp-3.d: Update expected output.
	* ld-arm/attr-merge-vfp-3r.d: Ditto.
	* ld-arm/attr-merge-vfp-4.d: Ditto.
	* ld-arm/attr-merge-vfp-4r.d: Ditto.
	* ld-arm/attr-merge-vfp-5.d: Ditto.
	* ld-arm/attr-merge-vfp-5r.d: Ditto.

2009-10-08  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6697

	libiberty/
	* argv.c (expandargv): Use xmalloc instead of malloc,
	as suggested upstream.

2009-10-07  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #6368
	Backport altered patch from FSF.
	ld/
	* ldlang.c (lang_new_phdr): Check PHDRS and FILEHDR in loadable
	segments do not appear after a different loadable segment.
	* ld.texinfo (PHDRS): Document order of processing segments.
	Document where PHDRS and FILEHDR may appear.

	ld/testsuite/
	* ld-scripts/phdrs3.d: New.

2009-10-05  Daniel Gutson  <dgutson@codesourcery.com>

	* release-config-csl.xml: Remove last entry,
	since it was documented in gcc as well.

2009-10-05  Daniel Gutson  <dgutson@codedsourcery.com>
	Daniel Jacobowitz  <dan@codesourcery.com>
	Pedro Alves  <pedro@codesourcery.com>

	Issue #6697

	libiberty/
	* argv.c (consume_whitespace): New function.
	(only_whitespace): New function.
	(buildargv): Always use ISSPACE by calling consume_whitespace.
	(expandargv): Skip empty files.  Do not stop at the first empty
	argument (calling only_whitespace)..
	* testsuite/test-expandargv.c: (test_data): Test empty lines
	and empty arguments.
	(run_tests): Fix false positives due to shorter arguments. 

	* release-config-csl.xml: Document.

2009-10-05  Paul Brook  <paul@codesourcery.com>

	Issue #5767
	bfd/
	* bfd/elf32-arm.c (elf32_arm_merge_eabi_attributes): Handle new
	VFP architecture variants.
	ld/testsuite/
	* ld-arm/arm-elf.exp: Add new VFP attribute tests.
	* ld-arm/attr-merge-vfp-1.d: New.
	* ld-arm/attr-merge-vfp-1r.d: New.
	* ld-arm/attr-merge-vfp-2.d: New.
	* ld-arm/attr-merge-vfp-2.s: New.
	* ld-arm/attr-merge-vfp-2r.d: New.
	* ld-arm/attr-merge-vfp-3-d16.s: New.
	* ld-arm/attr-merge-vfp-3.d: New.
	* ld-arm/attr-merge-vfp-3.s: New.
	* ld-arm/attr-merge-vfp-3r.d: New.
	* ld-arm/attr-merge-vfp-4-d16.s: New.
	* ld-arm/attr-merge-vfp-4.d: New.
	* ld-arm/attr-merge-vfp-4.s: New.
	* ld-arm/attr-merge-vfp-4r.d: New.
	* ld-arm/attr-merge-vfp-5.d: New.
	* ld-arm/attr-merge-vfp-5r.d: New.

2009-10-05  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #6714
	gas/
	* doc/c-arm.texi (ARM Options): Correctly name the two mapcs options.

2009-10-02  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #6368
	ld/
	* ldlang.c (lang_new_phdr): Check PHDRS and FILEHDR do not appear
	after a non-PHDR/FILEHDR segment.
	* ld.texinfo (PHDRS): Document order of processing segments.
	Document where PHDRS and FILEHDR may appear.

	ld/testsuite/
	* ld-scripts/phdrs3.d: New.
	* ld-scripts/phdrs3.t: New.
	* ld-scripts/phdrs3.exp: New.

	* release-notes-csl.xml: Document.

2009-09-30  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #6369

	* release-notes-csl.xml (ELF file corruption with strip): New note.

	Backport from mainline:
	bfd/
	2009-08-08  Alan Modra  <amodra@bigpond.net.au>

	PR 10494
	* elf.c (_bfd_elf_make_section_from_shdr): When setting up section
	LMAs, use ELF_IS_SECTION_IN_SEGMENT to match sections with headers.

2009-09-29  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #4151 - CYGPATH support for the GDB input file.

	libiberty/
	* lrealpath.c (lrealpath): Use cygpath on Windows.

2009-09-24  Catherine Moore  <clm@codesourcery.com>

	Revert:
	2009-09-09  Mark Mitchell  <mark@codesourcery.com>

	Issue #6412

	gas/
	* config/tc-mips.h (DWARF2_EH_FRAME_READ_ONLY): Define to zero.

2009-09-21  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #6534

	gas/

	Partial backport from mainline:
	2009-07-24  Nick Clifton  <nickc@redhat.com>

	PR 10437
	* config/tc-arm.c: Fix up uses of gas printf like functions so
	that the format string is a constant string.  Add translation
	support to message strings.

2009-09-11  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #5767

	gas/
	* config/tc-arm.c (fpu_neon_ext_fma): Renamed from fpu_neon_fma.
	Update uses.
	(fpu_vfp_ext_fma): Renamed from fpu_vfp_fma.  Update uses.
	(NEON_ENC_TAB): Update vfma / vfms.
	(do_vfp_nsyn_fma_fms, do_neon_fmac): New.
	(insns): Update vfma / vfms.  Add dummy VFP FMA instructions.
	(arm_fpus): Add neon-fma-fp16.

	gas/testsuite/
	* gas/arm/neon-fma-cov.d, gas/arm/neon-fma-cov.s: New tests.

	include/opcode/
	* arm.h (FPU_NEON_EXT_FMA): Rename from FPU_NEON_FMA.  Update uses.
	(FPU_VFP_EXT_FMA): Rename from FPU_VFP_FMA.  Update uses.
	(FPU_VFP_HARD): Add FMA extensions.
	(FPU_ARCH_NEON_FMA_FP16): New.

	opcodes/
	* arm-dis.c: Update references to FPU_NEON_FMA and FPU_VFP_FMA.

2009-09-11  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #5767
	gas/
	* config/tc-arm.c (NEON_ENC_TAB): Add vfma and vfms.
	(insns): Likewise.

	testsuite/gas/
	* gas/arm/vfp-fma-arm-inc.s: Add new insns.
	* gas/arm/vfp-fma-arm.d: Adjust expected patterns.
	* gas/arm/vfp-fma-thumb.d: Likewise.

2009-09-10  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #5767

	gas/
	* config/tc-arm.c (fpu_vfp_ext_v3xd): New.
	(insns): Separate single and double precision VFPv3 instructions.
	(arm_fpus): Add vfpv3xd-fp16.

	include/opcode/
	* arm.h (FPU_VFP_EXT_V3xD): Define.
	(FPU_VFP_EXT_V3, FPU_NEON_EXT_V1, FPU_VFP_EXT_D32)
	(FPU_VFP_EXT_FP16, FPU_NEON_FMA, FPU_VFP_FMA): Renumber.
	(FPU_VFP_V3D16, FPU_VFP_HARD): Add FPU_VFP_EXT_V3xD.
	(FPU_VFP_V3xD): Correct value.
	(FPU_ARCH_VFP_V3xD_FP16): New.

	opcodes/
	* arm-dis.c (coprocessor_opcodes): Mark single-precision
	VFPv3 instructions with FPU_VFP_EXT_V3xD.

2009-09-10  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #5767

	gas/
	* config/tc-arm.c (arm_ext_v6_dsp, arm_ext_v7m): New.
	(insns): Put Thumb versions of v5TExP instructions into
	arm_ext_v5exp also.  Move some Thumb variants from
	arm_ext_v6_notm to arm_ext_v6_dsp.
	(arm_archs): Add tag13 architecture.
	(aeabi_set_public_attributes): Handle -march=tag13.

	gas/testsuite/
	* gas/arm/attr-march-tag13.d, gas/arm/tag13-bad.d,
	gas/arm/tag13-bad.l, gas/arm/tag13.d, gas/arm/tag13.s: New test cases.

	include/opcode/
	* opcode/arm.h (ARM_EXT_V6_DSP): New.
	(ARM_AEXT_V6T2, ARM_AEXT_NOTM): Include ARM_EXT_V6_DSP.
	(ARM_AEXT_TAG13, ARM_ARCH_TAG13): New.

	bfd/
	* elf32-arm.c (using_thumb_only, arch_has_arm_nop)
	(arch_has_thumb2_nop): Handle TAG_CPU_ARCH_TAG13.
	(tag_cpu_arch_combine): Likewise.  Correct MAX_TAG_CPU_ARCH
	test.

	include/elf/
	* arm.h (TAG_CPU_ARCH_TAG13): Define.
	(MAX_TAG_CPU_ARCH): Update.

2009-09-10  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #5767
	
	gas/
	* config/tc-arm.c (NEON_ENC_TAB): Add vfnma and vfnms.
	(insns): Likewise.

	opcodes/
	* arm-dis.c (coprocessor_opcodes): Correct pattern for vfnms.f64.

	gas/testsuite/
	* gas/arm/vfp-fma-arm.d: New.
	* gas/arm/vfp-fma-arm.s: New.
	* gas/arm/vfp-fma-thumb.d: New.
	* gas/arm/vfp-fma-thumb.s: New.
	* gas/arm/vfp-fma-inc.s: New.
	* gas/arm/vfma1.d: Correct vfnms.f64 pattern.

	* release-notes-csl.xml: Document.

	gas/
	* config/tc-arm.c (do_vfp_nsyn_mla_mls): Use correct alias for mls
	versions.

	testsuite/
	* gas/arm/vfp-neon-syntax.d: Adjust.
	* gas/arm/vfp-neon-syntax_t2.d: Adjust.

	gas/
	* config/tc-arm.c (NEON_ENC_TAB): Correct encodings for vnmla and
	vnmls.

	gas/testsuite/
	* gas/arm/vfp-neon-syntax.d: Likewise.
	* gas/arm/vfp-neon-syntax_t2.d: Likewise.

2009-09-10  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #6438
	
	gas/
	* dw2gencfi.c (CFI_DIFF_LSDA_OK): New macro.
	(dot_cfi_lsda, output_fde): Use instead of CFI_DIFF_EXPR_OK.
	* config/tc-m68k.h (CFI_DIFF_LSDA_OK): Define.

2009-09-10  Nathan Sidwell  <nathan@codesourcery.com>

	include/elf/
	* arm.h (TAG_CPU_ARCH_13): New.
	(MAX_TAG_CPU_ARCH): Adjust.

	include/opcode/
	* arm.h (ARM_EXT_13): New mask.
	(FPU_NEON_FMA, FPU_VFP_FMA): New.
	(ARM_AEXT_13): New.
	(FPU_ARCH_VFP_TAG_5, FPU_ARCH_VFP_TAG_6): New.
	(ARM_ARCH_13): New.

	binutils/
	* readelf.c (arm_attr_tag_VFP_arch): Add tag-5 and tag-6.

	opcodes/
	* arm-dis.c (coprocessor_opcodes): Add vfma, vfms, vfnma and vfnms
	variants.

	gas/
	* config/tc-arm.c (fpu_neon_fma, fpu_vfp_fma): New.
	(arm_option_cpu_values): Add tag-5 and tag-6.
	(aeabi_set_public_attributes): Adjust for new attribute values.

	gas/testsuite/
	* vfma1.s: New.
	* vfma1.d: New.
	* attr-mfpu-tag-5.d: New.
	* attr-mfpu-tag-6.d: New.

2009-09-09  Daniel Jacobowitz  <dan@codesourcery.com>
	    Maxim Kuvyrkov <maxim@codesourcery.com>

	Issue #6438

	gas/
	* config/tc-m68k.h (CF_DIFF_EXPR_OK): Define to 0 for uClinux.
	* config/te-uclinux.h: New file.
	* configure.tgt (m68k-uclinux): Define em.

2009-09-09  Mark Mitchell  <mark@codesourcery.com>

	Issue #6412

	gas/
	* config/tc-mips.h (DWARF2_EH_FRAME_READ_ONLY): Define to zero.

2009-09-07  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gas/
	* config/m68k-parse.h (enum m68k_register): Add ACR[4-7], RGPIOBAR.
	* config/tc-m68k.c (mcf54418): Define.
	(mcf54455): Remove MBAR.
	(m68k_cpus): Add lines for MCF5441x family.
	(m68k_ip, init_table): Handle RGPIOBAR, ACR[4-7].
	
	opcodes/
	* m68k-dis.c (print_insn_arg): Handle RGPIOBAR, ACR[4-7] and MBAR[01].

2009-09-04  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-arm.c (mapping_state, mapping_state_2): Make dummy
	versions slightly more than nothing.

2009-09-03  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6305

	gas/
	* config/tc-arm.c (arm_cpus): cortex-r4f CPU added.
	* doc/c-arm.texi: cortex-r4f CPU added.

	* release-notes-csl.xml: Document.

2009-09-03  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (fpu_neon_fp16): Rename...
	(fpu_vfp_fp16): ... to this.
	(insns): Move single presicion load/store to VFPv1xD.
	(arm_option_cpu_value): Add vfpv3-fp16, vfpv3-d16-fp16 and
	vfpv3xd.
	(aeabi_set_public_attributes): Use fpu_vfp_fp16.
	(FPU_NEON_FP16): Rename...
	(FPU_VFP_EXT_FP16): ... to this.
	(FPU_ARCH_VFP_V3D16_FP16, FPU_ARCH_VFP_V3_FP16, FPU_ARCH_VFP_V3xD):
	Define.
	(FPU_ARCH_NEON_FP16): Use FPU_VFP_EXT_FP16.

	opcodes/
	* arm-dis.c: Use FPU_VFP_EXT_FP16.

	gas/testsuite/
	* gas/arm/vfpv3xd.d: New test.
	* gas/arm/vfpv3xd.s: New test.

2009-09-02  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #6382

	* release-notes-csl.xml: Merge notes about auto IT fixes into
	the one about renaming the option to -mimplicit-it.

2009-09-02  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/arm/tc-arm.c (opcode_lookup): Allow VFP/NEON type suffixes
	unconditionally.

2009-09-01  Maciej W. Rozycki  <macro@codesourcery.com>

	bfd/
	* elf64-mips.c (mips_elf64_howto_table_rela): Add support for
	R_MIPS_TLS_DTPMOD64 and R_MIPS_TLS_TPREL64, replacing the
	respective stubs.

2009-08-31  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #6382

	* release-notes-csl.xml (Automatic IT generation fix for Thumb-1):
	Copy-edit.
	(Linking objects built without -fPic into shared libraries):
	Adjust TARGET line.

2009-08-25  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_final_link_relocate): Set sym_flags
	for the mode of target PLT entries.
	(allocate_dynrelocs): Only adjust symbol type if setting its
	value.

	ld/testsuite/
	* ld-arm/farcall-mixed-lib.d: Update.

2009-08-21  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gas/
	* config/tc-m68k.c (mcf52223_ctrl): Remove non-existent registers. 
	(mcf5206_ctrl): Fix whitespace.

2009-08-17  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/
	* elf32-m68k.c: Rewrite initialization of GOT entries for TLS
	relocations.  Rewrite output of dynamic TLS relocations.
	(DTP_OFFSET, TP_OFFSET): New constants.
	(dtpoff_base): Update.
	(tpoff): Rename to tpoff_base, update.
	(elf_m68k_init_got_entry_static, elf_m68k_init_got_entry_local_shared):
	New functions.  Move code from elf_m68k_relocate_section here.
	(elf_m68k_relocate_section): Update.
	(elf_m68k_finish_dynamic_symbol): Fix handling of local TLS symbols.

2009-08-17  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/
	* elf32-m68k.c (elf_m68k_copy_indirect_symbol): Propagate non_got_ref
	value.
	(elf_m68k_check_relocs): Handle dynamic TLS relocations.
	Handle non_got_ref field.
	(elf_m68k_adjust_dynamic_symbol): Handle non_got_ref field.

2009-08-12  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6068

	bfd/
	* elf32-arm.c (arch_has_thumb2_nop): New function.
	(arch_has_arm_nop): New function.
	(elf32_arm_final_link_relocate): NOP opcodes changed.

	ld/testsuite/
	* ld-arm/callweak.d: Opcodes updated.
	* ld-arm/callweak.s: Architecture specified.
	* ld-arm/callweak-2.d: New test case.
	* ld-arm/callweak-2.s: New file.

2009-08-09  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #6154

	* config/tc-arm.c (do_t_add_sub_w): Fixed constraints.

	gas/testsuite/
	* gas/arm/sp-pc-usage-t.d: New test case.
	* gas/arm/sp-pc-usage-t.s: New file.

	* release-notes-csl.xml: Document.

2009-08-07  Daniel Jacobowitz  <dan@codesourcery.com>

	Backport from mainline:

	2009-08-07  Daniel Jacobowitz  <dan@codesourcery.com>

	gas/
	* config/tc-arm.c (marked_pr_dependency, mapstate): Delete global
	variables.
	(mapping_state): Use the section's mapstate.
	(mapping_state_2): Likewise.  Skip special sections.
	(s_arm_unwind_fnend): Use the section's marked_pr_dependency.
	(arm_elf_change_section): Do not set deleted globals.
	* config/tc-arm.h (struct arm_segment_info_type): Document
	marked_pr_dependency.

	2009-08-07  Daniel Jacobowitz  <dan@codesourcery.com>

	gas/testsuite/
	* gas/arm/mapping2.s: Test code after .ident.

2009-08-06  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #5966

	bfd/
	* elf32-arm.c (elf32_arm_size_stubs): Call layout_sections_again
	at least once when fixing cortex-a8.

	ld/testsuite/
	* ld-arm/arm-elf.exp: Add new test.
	* ld-arm/cortex-a8-fix-hdr.d: New.
	* ld-arm/cortex-a8-fix-hdr.s: New.
	* ld-arm/cortex-a8-fix-hdr.t: New.

2009-08-04  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #6004

	Backport from FSF:
	gas/
	* doc/c-mips.texi (MIPS Opts): List 1004K options for -march.
	* config/tc-mips.c (mips_cpu_info_table): Add 1004K cores.

2009-08-04  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gas/
	* config/tc-m68k.c (mcf53017_ctrl): Fix RAMBAR, again, after merge
	from upstream.

2009-08-04  Nathan Sidwell  <nathan@codesourcery.com>

	* release-notes-csl.xml: Document.

	bfd/
	* elf32-qrm.c (elf32_arm_stub_type): Add arm_stub_a8_veneer_lwm.
	(arm_build_one_stub): Build a8 veneers as a separate pass.
	(cortex_a8_erratum_scan): Add prev_num_a8_fixes and stub_changed_p
	parameters.  Use them to check if we create a different a8 fixup
	than the previous pass.
	(elf32_arm_size_stubs): Move scope of stub_changed and
	prev_num_a8_fixes into main loop.
	(elf32_arm_build_stubs): Build a8 veneers in a second pass.

	ld/testsuite/
	* ld-arm/cortex-a8-far-1.s: New.
	* ld-arm/cortex-a8-far-2.s: New.
	* ld-arm/cortex-a8-far.d: New.
	* ld-arm/arm-elf.exp: Add new test.

2009-08-03  Daniel Jacobowitz  <dan@codesourcery.com>

	Backport from mainline:

	2009-07-30  Nick Clifton  <nickc@redhat.com>

	gas/
	* doc/c-arm.texi (ARM-Instruction-Set): New node.  Documents the
	different syntaxes support by the ARM port.
	(ARM Directives): Add entry for .syntax.

	Revert:

	2009-07-17  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5863
	gas/
	* doc/c-arm.texi (ARM Syntax): Note two different mnemonic syntaxes.
	(ARM Directives): Document .syntax.

2009-07-31  Joseph Myers  <joseph@codesourcery.com>

	Issue #4851

	Merge from
	<http://sourceware.org/ml/binutils/2009-07/msg00084.html> (not
	committed upstream):

	ld/
	2009-07-08  Tristan Gingold  <gingold@adacore.com>

	* ld.h (fat_user_section_struct): Add map_symbol_def_count field.
	* ldlang.c (hash_entry_addr_cmp): New function.
	(print_all_symbols): Sort the symbols by address before printing
	them.

2009-07-23  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5998	
	bfd/
	* elf32-arm.c (elf32_arm_relocate_section): Allow ARM_NONE
	relocations against undefined symbols.

2009-07-22  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5998
	gas/
	* config/tc-arm.c (my_get_expression): Detect missing expressions.

	gas/testsuite/
	* gas/arm/missing.s: New.
	* gas/arm/missing.d: New.
	* gas/arm/missing.l: New.

2009-07-21  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #3654
	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Correct handling
	of undefined symbols.

	ld/testsuite/
	* ld-mips-elf/undefined.d: New test.
	* ld-mips-elf/undefined.s: Source for the new test.
	* ld-mips-elf/mips-elf.exp: Run the new test.

2009-07-17  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5998
	bfd/
	* elf32-arm.c (elf32_arm_relocate_section): Allow ARM_V4BX
	relocations against undefined symbols.

2009-07-17  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5863
	gas/
	* doc/c-arm.texi (ARM Syntax): Note two different mnemonic syntaxes.
	(ARM Directives): Document .syntax.

2009-07-16  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5998
	bfd/
	* elf32-arm.c (elf32_arm_size_stubs): Don't die on undefined local
	symbols.
	(elf32_arm_final_link_relocate): Treat local undefined symbols the
	same as global undefined symbols.  Ignore branch_offset for
	undefined weak references.
	(elf32_arm_relocate_section): Give an error for local undefined
	non-weak symbols.

	* release-notes-csl.xml: Document.

2009-07-13  Julian Brown  <julian@codesourcery.com>

	ld/testsuite/
	* ld-selective/selective.exp (cflags): Add -fno-unwind-tables.
	* ld-gc/gc.exp (cflags): Likewise.

2009-07-10  Daniel Gutson  <dgutson@codesourcery.com>

	Issue 5694

	gas/
	* config/tc-arm.c (md_assemble): Added validation.

	gas/testsuite
	* gas/arm/thumb-w-bad.d: New test case.
	* gas/arm/thumb-w-bad.l: New file.
	* gas/arm/thumb-w-bad.s: New file. 
	* gas/arm/thumb-w-good.d: New test case.
	* gas/arm/thumb-w-good.s: New file.

	* release-notes-csl.xml: Document, merging notes.

2009-07-09  Daniel Gutson  <dgutson@codesourcery.com>

	Issue 5965

	gas/
	* config/tc-arm.c (new_automatic_it_block): Added call to
	mapping_state ().
	(md_assemble): moved mapping_state () calls.

	gas/testsuite/
	* gas/arm/insn-error-a.d: New test case.
	* gas/arm/insn-error-a.l: New file.
	* gas/arm/insn-error-a.s: New file.
	* gas/arm/insn-error-t.d: New test case.
	* gas/arm/insn-error-t.l: New file.
	* gas/arm/insn-error-t.s: New file.

2009-07-07  Daniel Gutson  <dgutson@codesourcery.com>

	Issue 4786

	gas/
	* config/tc-arm.c (it_fsm_post_encode): New forward declaration.
	(set_it_insn_type_nonvoid): New macro.
	(emit_thumb32_expr): New function.
	(thumb_insn_size): New function.
	(emit_insn): New function.
	(s_arm_elf_inst): New function.
	(md_pseudo_table): New pseudo-opcode entries added.
	* doc/c-arm.texi: New directive added.

	gas/testsuite/
	* gas/arm/inst-po.d: New testcase.
	* gas/arm/inst-po.s: New file.
	* gas/arm/inst-po-2.d: New testcase.
	* gas/arm/inst-po-2.s: New file.
	* gas/arm/inst-po-2.l: New file.
	* gas/arm/inst-po-3.d: New testcase.
	* gas/arm/inst-po-3.s: New file.
	* gas/arm/inst-po-be.d: New testcase.

	* release-notes-csl.xml: Document.

2009-07-07  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5736
	gas/
	* config/tc-arm.c (md_apply_fix <BFD_RELOC_ARM_TARGET2>): Write
	the offset for REL targets here.

	gas/testsuite/
	* gas/arm/target-reloc-1.s: New.
	* gas/arm/target-reloc-1.d: New.

	ld/testsuite/
	* ld-arm/arm-target2.s: Add addend cases.
	* ld-arm/arm-target2-rel.d: Adjust.
	* ld-arm/arm-target2-abs.d: Adjust.
	* ld-arm/arm-target2-got-rel.d: Adjust.

2009-07-01  Paul Brook <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (MISSING_FNSTART): Define.
	(s_arm_unwind_fnstart): Diagnose duplicate directive.
	(s_arm_unwind_handlerdata, s_arm_unwind_fnend, s_arm_unwind_fnend,
	s_arm_unwind_cantunwind, s_arm_unwind_personalityindex,
	s_arm_unwind_personality, s_arm_unwind_save, s_arm_unwind_movsp,
	s_arm_unwind_pad, s_arm_unwind_setfp, s_arm_unwind_raw): Error if
	not inside function unwinding region.

	gas/testsuite/
	* gas/arm/fp-save.s: Add .fnstart and .fnend directives.

2009-07-01  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5884
	Port 2009-03-31  Nick Clifton  <nickc@redhat.com>
	ld/
	PR 9992
	* configure.in: Import Solaris specific largefile test from
	bfd/configure.in.
	* configure: Regenerate.

	* release-notes-csl.xml: Document.

2009-06-24  Daniel Gutson  <dgutson@codesourcery.com>

	Issue 5797

	gas/
	* config/tc-arm.c (arm_handle_align): Conditionalize ELF code.
	(arm_init_frag): Splitted ELF and non-ELF versions.

2009-06-24  Joseph Myers  <joseph@codesourcery.com>

	* gas/doc/c-arm.texi (vfp3): Don't document deprecated FPU name.

2009-06-19  Daniel Gutson  <dgutson@codesourcery.com>

 	Issue 5796

 	gas/
	* config/tc-arm.h (enum it_state): Moved out of the OBJ_ELF
	conditional code.
	(struct current_it): Likewise.
	* config/tc-arm.c (now_it): New definition for non-OBJ_ELF code.
	(check_it_blocks_finished): Implementation conditionalized on
	OBJ_ELF.

2009-06-17  Julian Brown  <julian@codesourcery.com>

	bfd/
	* elf32-arm.c (arm_build_one_stub): Use the hash entry of the
	symbol a stub entry is derived from, not the entry for the stub
	itself, in call to elf32_arm_final_link_relocate.

2009-06-14  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gas/
	* config/tc-m68k.c (mcf5221x_ctrl): New.
	(m68k_cpu): Add line for MCF5221x.

2006-06-09  Daniel Gutson  <dgutson@codesourcery.com>

	Issue 5695

	gas/
	* config/tc-arm.c (handle_it_state): Added architecture check.

	gas/testsuite/
	* gas/arm/arm-it-bad-3.d: New test case.
	* gas/arm/arm-it-bad-3.l: New file.
	* gas/arm/arm-it-bad-3.s: New file.

	* release-notes-csl.xml: Document.

2006-06-09  Daniel Gutson  <dgutson@codesourcery.com>

	Issue 5592

	gas/
	* config/tc-arm.c (do_it): Use the instruction code to properly
	calculate the mask.
	(check_it_blocks_finished): New function.
	(insns[]): Use the IT Thumb opcodes for ARM too.
	(arm_cleanup): Call check_it_blocks_finished.

	gas/testsuite/
	* gas/arm/arm-it-bad-2.d: New test case.
	* gas/arm/arm-it-bad-2.l: New file.
	* gas/arm/arm-it-bad-2.s: New file.

	* release-notes-csl.xml: Document.

2009-06-04  Daniel Gutson <dgutson@codesourcery.com>

	Issue 3507

	gas/
	* config/tc-arm.c (implicit_it_mode): New enum.
	(implicit_it_mode): New global.
	(do_it): Add IT machinery function calls.
	(handle_it_state): Add handling of ARM mode depending on the new
	option.
	(md_assemble): Call the IT fsm functions for ARM mode.
	(arm_parse_it_mode): New function.
	(arm_long_opts): New option added.
	* doc/c-arm.texi (mimplicit-it): New option documented.

	gas/teststuite/
	* gas/arm/arm-it-auto-2.d: Assembler option updated.
	* gas/arm/arm-it-auto-3.d: Likewise.
	* gas/arm/arm-it-auto.d: Likewise.
	* gas/arm/thumb2_it_auto.d: Likewise.
	* gas/arm/thumb2_it_bad_auto.d: Likewise.
	* gas/arm/arm-it-bad.d: New test case.
	* gas/arm/arm-it-bad.l: New file.
	* gas/arm/arm-it-bad.s: New file.

	* release-notes-csl.xml: Document. 

2009-06-05  Nathan Sidwell  <nathan@codesourcery.com>

	Revert SiCortex-specific local changes

	Revert 2007-03-01  Joseph Myers  <joseph@codesourcery.com>
	gas/
	* configure.in (mips64el-sicortex-linux-gnu): Set
	mips_default_abi=N64_ABI.
	* configure: Regenerate.

	Revert 2007-02-20  Carlos O'Donell  <carlos@codesourcery.com>
	Issue #1271
	ld/
	* configure.tgt (mips64el-sicortex-linux-gnu): Set targ_emul to
	elf64ltsmip, and set targ_extra_emuls appropriately.

	Revert 2008-10-13  Nathan Sidwell  <nathan@codesourcery.com>
	gas/
	* config/tc-mips.c (mips_cpu_info_table): Add ice9.

	Revert 2008-09-25  Maciej W. Rozycki  <macro@codesourcery.com>
	Issue #3634
	gas/testsuite/
	* gas/mips/mips.exp: Move the "ice9a" test to the target
	section.

	Revert 2008-09-13  Maciej W. Rozycki  <macro@codesourcery.com>
            Daniel Gutson  <daniel@codesourcery.com>
	Issue #3634
	gas/
	* config/tc-mips.c (ICE9A_MOVNDS): New macro.
	(MAX_NOPS): Rename to...
	(MAX_HIST_INSNS): ... this.  Adjust references and comments
	accordingly.
	(mips_fix_ice9a): New variable.
	(ice9a_fp_stall_hazard_p): New function.
	(ice9a_fp_round_hazard_p): New function.
	(ice9a_movnd_workaround_p): Likewise.
	(ice9a_insn_accesses_f30_p): Likewise.
	(check_for_ice9a): Likewise.
	(mips_cleanup): Likewise.
	(nops_for_insn): Call check_for_ice9a().
	(OPTION_FIX_ICE9A): New macro.
	(OPTION_NO_FIX_ICE9A): Likewise.
	(OPTION_MISC_BASE): Adjust accordingly.
	(md_longopts): Add "mfix-ice9a" and "mno-fix-ice9a".
	(md_parse_option): Handle OPTION_FIX_ICE9A and
	OPTION_NO_FIX_ICE9A.
	(md_show_usage): Document "-mfix-ice9a".
	* config/tc-mips.h (mips_cleanup): New declaration.
	(md_cleanup): New macro.
	* doc/c-mips.texi (MIPS Opts): Document "-mfix-ice9a" and
	"-mno-fix-ice9a".
	* doc/as.texinfo (Target MIPS options): Likewise.

	gas/testsuite/
	* gas/mips/ice9a.l: New test for the "-mfix-ice9a" option.
	* gas/mips/ice9a.s: Source for the new test.
	* gas/mips/mips.exp: Run the new test.

2009-06-04  Maciej W. Rozycki  <macro@codesourcery.com>

	gas/testsuite/
	* gas/mips/octeon3.s: Add trailing padding.

2009-05-29  Daniel Gutson  <dgutson@codesourcery.com>

	gas/
	* config/tc-arm.c: (now_it): New macro replaces current_it.
	(enum it_state, struct current_it): Moved from here
	* config/tc-arm.h: to here.
	(arm_segment_info_type) Added member current_it.

	gas/testsuite/
	* gas/arm/arm-it-auto-2.d: New test.
	* gas/arm/arm-it-auto-2.s: New file.
	* gas/arm/arm-it-auto-3.d: New test.
	* gas/arm/arm-it-auto-3.s: New file.

2009-05-28  Andrew Jenner  <andrew@codesourcery.com>

	ld/testsuite/
	* ld-scripts/rgn-over7.d: Fix failing test.
	
2009-05-26  Nathan Sidwell  <nathan@codesourcery.com>

	ld/
	Backport 2009-05-26  Alan Modra  <amodra@bigpond.net.au>
	* ldlang.c (lang_check_section_addresses): Ignore non-alloc sections.

2009-05-22  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5403
	* release-notes-csl.xml: Add note.

	ld/
	* ldlang.c (lang_check_section_addresses): Ignore non-loadable
	sections when checking for overlap.  Clarify error message
	concerns load address.

	ld/testsuite/
	* ld-scripts/rgn-at4.t: New.
	* ld-scripts/rgn-at4.d: New.

2009-05-21  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gas/
	* config/tc-m68k.c (mcf52235_ctrl): Remove non-existent CACR, ACR[01].
	(mcf53017_ctrl): Fix RAMBAR.

2009-05-01  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #5116

	gas/
	* config/obj-elf.c (obj_elf_ident): Notify section change to the hook.
	* config/tc-arm.c (mapping_state): fixed state transition.
	(arm_elf_change_section): Always update the mapping symbol FSM state.

	gas/testsuite
	* gas/arm/mapping.d: Adapted to new symbols generation.
	* gas/arm/mapping2.d: New test case.
	* gas/arm/mapping2.s: New file.
	* gas/arm/mapping3.d: New test case.
	* gas/arm/mapping3.s: New file.
	* gas/arm/mapping4.d: New test case.
	* gas/arm/mapping4.s: New file.
	* gas/arm/mapshort-eabi.d: Adapted to new symbols generation.
	* gas/elf/section2.e-armeabi: Adapted to new symbols generation.

	* release-notes-csl.xml: Document. 

2009-04-30  Nathan Sidwell  <nathan@codesourcery.com>

	* release-notes-csl.xml: Add arm* TARGET for -mauto-it note.

2009-04-29  Joseph Myers  <joseph@codesourcery.com>

	Issue #4505

	Backport:

	bfd/
	2009-04-30  Joseph Myers  <joseph@codesourcery.com>
	* elf32-arm.c (elf32_arm_check_relocs): Give errors for absolute
	MOVW and MOVT relocations in a shared library link.

	ld/testsuite/
	2009-04-30  Joseph Myers  <joseph@codesourcery.com>
	* ld-arm/movw-shared-1.d, ld-arm/movw-shared-1.s,
	ld-arm/movw-shared-2.d, ld-arm/movw-shared-2.s,
	ld-arm/movw-shared-3.d, ld-arm/movw-shared-3.s,
	ld-arm/movw-shared-4.d, ld-arm/movw-shared-4.s: New tests.
	* ld-arm/arm-elf.exp: Run these new tests.

2009-04-27  Julian Brown  <julian@codesourcery.com>

	Issue #5167

	libiberty/
	* pex-win32.c (pex_win32_pipe): Add _O_NOINHERIT.    
	(pex_win32_exec_child): Ensure each process has only one handle open
	on pipe endpoints. Close standard input after creating child for
	symmetry with standard output/standard error.

2009-04-23  Andrew Stubbs  <ams@codesourcery.com>

	Issue #5328

	* release-notes-csl.xml: Document bug fix.

	bfd/
	* elf32-arm.c (elf32_arm_fix_exidx_coverage): Don't attempt to
	fix discarded sections.

2009-04-22  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #4502

	* release-notes-csl.xml (Assembler fix for -mauto-it): New note.

	gas/
	* config/tc-arm.c (handle_it_state): Use force_automatic_it_block_close
	to close the previous IT block.  Only close the next IT block if we
	opened a new one for an IT-only instruction.

2009-04-22  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 5271

	Backport 2009-04-22  Nathan Sidwell  <nathan@codesourcery.com>
	ld/testsuite/
	* ld-scripts/rgn-at1.d: Cope with larger padding on sections.
	* ld-scripts/rgn-at2.d: Likewise.
	* ld-scripts/rgn-at3.d: Likewise.

	Backport 2009-04-03  Nathan Sidwell  <nathan@codesourcery.com>
	ld/testuite/
	* ld-scripts/rgn-at.s: Use explicit .section pseudos.

2009-04-21  Andrew Jenner  <andrew@codesourcery.com>

	Issue #5270

	* ld/testsuite/ld-elf/eh5.d: Accept 0b as well as 1b for the 
	personality byte in the augmentation data.
	
2009-04-20  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #5050

	binutils/
	* readelf.c (get_arm_section_type_name): Added support for
	new sections headers.

	include/elf
	* arm.h: (SHT_ARM_DEBUGOVERLAY): New define.
	(SHT_ARM_OVERLAYSECTION): New define.

	* release-notes-csl.xml: Document.

2009-04-15  Nathan Froyd  <froydnj@codesourcery.com>

	* release-notes-csl.xml: Fix typo.

2009-04-15  Kazu Hirata  <kazu@codesourcery.com>

	Revert:
	2009-02-02  Kazu Hirata  <kazu@codesourcery.com>
	ld/
	* gprof.h: Include config.h.

	ld/
	Backport from mainline:
	2009-04-15  Kazu Hirata  <kazu@codesourcery.com>
	* ldlang.c: Do not include limits.h.

2009-04-14  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #1956, #2786, #5144
	* release-notes-csl.xml (Mapping symbols): New note.

	gas/testsuite/
	* gas/arm/mapdir.d, gas/arm/mapdir.s: New files.

	gas/
	* config/tc-arm.c (make_mapping_symbol): New function, from
	mapping_state.  Save mapping symbols in the frag.
	(insert_data_mapping_symbol): New.
	(mapping_state): Use make_mapping_symbol.
	(mapping_state_2): New.  Provide dummy definition.
	(opcode_select): Do not call mapping_state.
	(s_bss): Call md_elf_section_change_hook instead of mapping_state.
	(arm_handle_align): Update use of tc_frag_data.
	Call insert_data_mapping_symbol.
	(arm_init_frag): Update use of tc_frag_data.  Call
	mapping_state_2.
	(check_mapping_symbols): New function.
	(arm_adjust_symtab): Use check_mapping_symbols.
	* config/tc-arm.h (struct arm_frag_type): New.
	(TC_FRAG_TYPE): Change to struct arm_frag_type.
	(TC_FRAG_INIT): Pass max_chars.
	(arm_init_frag): Update prototype.

	ld/testsuite/
	* ld-arm/thumb2-bl-blx-interwork.d: Correct disassembly.
	* ld-arm/script-type.sym: Add an additional $a mapping symbol.

	binutils/testsuite/
	* binutils-all/arm/thumb2-cond.s: Use instructions.

2009-04-12  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #5185

	* release-notes-csl.xml (Incorrect placement of linker-generated
	functions): New note.

	bfd/
	* elf32-arm.c (elf32_arm_next_input_section): Skip flags without
	SEC_CODE.
	(group_sections): Handle empty lists.

2009-04-09  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #4849

	* release-notes-csl.xml (Assembler floating point format): New note.

	gas/testsuite/
	* gas/arm/mapmisc.d: Correct expected output for .double and .dcb.d.

2009-04-09  Daniel Gutson  <dgutson@codesourcery.com>

        Issue #4502

        gas/testsuite/
        * gas/arm/arm-it-auto.d: fixed test case dump.

2009-04-09  Catherine Moore  <clm@codesourcery.com>

	gas/
	* config/tc-mips.c (check_for_24k_errata):  Adjust if block.
	Remove return.

2009-04-09  Daniel Gutson  <dgutson@codesourcery.com>
	Issue #4502

	gas/
	* config/tc-arm.c (do_automatic_it): New variable.
	(it_instruction_type): New enum.
	(arm_it): New field.
	(it_state): New enum.
	(current_it): New struct and global variable.
	(current_it_compatible): New function.
	(conditional_insn): New function.
	(set_it_insn_type): New macro.
	(set_it_insn_type_last): New macro.
	(do_t_add_sub): Call automatic IT machinery functions.
	(do_t_arit3): Likewise.
	(do_t_arit3c): Likewise.
	(do_t_blx): Likewise.
	(do_t_branch): Likewise.
	(do_t_bkpt): Likewise.
	(do_t_branch23): Likewise.
	(do_t_bx): Likewise.
	(do_t_bxj): Likewise.
	(do_t_cps): Likewise.
	(do_t_cpsi): Likewise.
	(do_t_cbz): Likewise.
	(do_t_it): Likewise.
	(encode_thumb2_ldmstm): Likewise.
	(do_t_ldst): Likewise.
	(do_t_mov_cmp): Likewise.
	(do_t_mvn_tst): Likewise.
	(do_t_mul): Likewise.
	(do_t_neg): Likewise.
	(do_t_setend): Likewise.
	(do_t_shift): Likewise.
	(do_t_tb): Likewise.
	(output_it_inst): New function.
	(new_automatic_it_block): New function.
	(close_automatic_it_block): New function.
	(current_it_add_mask): New function.
	(it_fsm_pre_encode): New function.
	(handle_it_state): New function.
	(it_fsm_post_encode): New function.
	(force_automatic_it_block_close): New function.
	(in_it_block): New function.
	(md_assemble): Call automatic IT block machinery functions.
	(arm_frob_label): Likewise.
	(arm_opts): New element.
	* doc/c-arm.texi: New option -mauto-it.

	gas/testsuite/
	* gas/arm/arm-it-auto.d: New test.
	* gas/arm/arm-it-auto.s: New file.
	* gas/arm/thumb2_it_auto.d: New test.
	* gas/arm/thumb2_it_bad.l: Error message updated.
	* gas/arm/thumb2_it_bad_auto.d: New test.
	* gas/arm/thumb2_it.d: Comment added.
	* gas/arm/thumb2_it_bad.d: Comment added.

	* release-notes-csl.xml: Document. 

2009-04-08  Daniel Gutson  <dgutson@codesourcery.com>

	gas/testsuite/
	* gas/arm/thumb2_it.d: Removed obsolete regex.

2009-04-08  Paul Brook  <paul@codesourcery.com>

	Issue #5162
	bfd/
	* elf32-arm.c (make_branch_to_a8_stub): Ignore long branch stubs.

2009-04-08 Catherine Moore <clm@codesourcery.com>

	Issue #4593

	gas/
	* config/tc-mips.c (mips_fix_24k): Declare.
	(check_for_24k_errata): New.
	(mips_cleanup): Call check_for_24k_errata.
	(start_noreorder): Likewise.
	(md_mips_end): Likewise.
	(s_change_sec): Likewise.
	(s_change_section): Likewise.
	(append_insn): Call check_for_24k_errata.  Prevent
	ERET/DERET instructions from being moved into delay
	slots.
	(OPTION_FIX_24K): New.
	(OPTION_NO_FIX_24k): New.
	(md_longopts): Add "mfix-24k" and "mno-fix-24k".
	(md_parse_option): Handle fix-24k options.
	(md_show_usage): Display fix-24k options.
	* doc/c-mips.texi: Document.
	* testsuite/gas/mips/mips.exp: Run new tests.
	* testsuite/gas/mips/eret.s: New test.
	* testsuite/gas/mips/eret.d: New test output.
	* testsuite/gas/mips/eret.l: New test output.

	* release-notes-csl.xml: New note.

2009-04-08  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #5170

	* release-notes-csl.xml (tlbilx encoding fix): New note.

	Backport from mainline:

	gas/
	2009-04-07  Peter Bergner  <bergner@vnet.ibm.com>

	* ppc-opc.c (powerpc_opcodes) <"tlbilxlpid", "tlbilxpid", "tlbilxva",
	"tlbilx">: Use secondary opcode "18" as per the ISA 2.06 documentation.
	Reorder entries so the extended mnemonics are listed before tlbilx.

	opcodes/
	2009-04-07  Peter Bergner  <bergner@vnet.ibm.com>

	* gas/ppc/e500mc.d: Update to match extended mnemonics.

2009-04-06  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #5124

	gas/
	* config/tc-arm.c (arm_frag_align_code): Fixed the string message.
	* config/tc-arm.h (MAX_MEM_ALIGNMENT_BYTES): New macro.
	(MAX_MEM_FOR_RS_ALIGN_CODE): Macro changed to use the above.

	gas/testsuite/
	* gas/arm/align64.d: New file.
	* gas/arm/align64.s: New file.

	* release-notes-csl.xml: Document.

2009-04-06  Andrew Jenner  <andrew@codesourcery.com>

	bfd/
	* elf32-arm.c: Move sysdep.h to start of file.
	
2009-04-06  Kazu Hirata  <kazu@codesourcery.com>

	Backport from FSF:
	ld/
	2009-04-06  Kazu Hirata  <kazu@codesourcery.com>
	* ld.texinfo (-L): Mention that -L options do not affect how ld
	searches for a linker script unless -T option is specified.
	* ldfile.c (ldfile_find_command_file): Append the path obtained
	from the program name to the search path instead of
	prepending. Add a new parameter "default_only". Restrict the
	search to the default script location if the new parameter is
	true.
	(ldfile_open_command_file_1): New.
	(ldfile_open_command_file): Call ldfile_open_command_file_1.
	(ldfile_open_default_command_file): New.

	* ldfile.c (ldfile_find_command_file): Initialize result.

2009-04-05  Kazu Hirata  <kazu@codesourcery.com>

	Issue #5010
	binutils/
	* objcopy.c (maybe_sign_extend_vma): New.
	(setup_section): Call maybe_sign_extend_vma after manipulating
	addresses.

	* release-notes-csl.xml: Mention the bug fix above.

2009-04-03  Julian Brown  <julian@codesourcery.com>

	* release-notes-csl.xml (Cortex-A8 erratum workaround enabled
	for ARMv7-A): Add note.

2009-04-03  Julian Brown  <julian@codesourcery.com>

	ld/
	* emultempl/armelf.em (OPTION_NO_FIX_CORTEX_A8): New.
	(PARSE_AND_LIST_LONGOPTS): Add --no-fix-cortex-a8 option. Remove
	argument from --fix-cortex-a8.
	(PARSE_AND_LIST_OPTIONS): Adjust for --[no-]fix-cortex-a8 syntax.
	(PARSE_FIX_CORTEX_A8, PARSE_NO_FIX_CORTEX_A8): Handle
	--[no-]fix-cortex-a8 syntax.
	* ld.texinfo (--fix-cortex-a8): Document.

	bfd/
	* elf32-arm.c (bfd_elf32_arm_set_cortex_a8_fix): Re-enable fix by
	default on ARM v7-A.

2009-04-03  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #5022
	ld/
	* ldlang.c (lang_leave_output_section_statement): Set lma_region
	if it is not overridden and section is for the same vma region as
	the previous section.

	ld/testsuite/
	* ld-scripts/rgn-at.exp: New.
	* ld-scripts/rgn-at.s: New.
	* ld-scripts/rgn-at1.d: New.
	* ld-scripts/rgn-at1.t: New.
	* ld-scripts/rgn-at2.d: New.
	* ld-scripts/rgn-at2.t: New.
	* ld-scripts/rgn-at3.d: New.
	* ld-scripts/rgn-at3.t: New.

	* release-notes-csl.xml: Add note.

2009-04-02  Nathan Sidwell  <nathan@codesourcery.com>

	Issues #4842, #5076
	gas/
	* config/tc-armlinux-eabi.h (FPU_DEFAULT): Default to plain VFP.
	* config/tc-armeabi.h (FPU_DEFAULT): Likewise.
	* config/tc-arm.c (md_begin): If FPU_DEFAULT is set, don't infer
	the default FPU from the processor.

	gas/testsuite/
	* gas/arm/attr-mcpu.d: Add -mfpu=neon.

	* release-notes-csl.xml: Add note.
	
2009-03-31  Paul Brook  <paul@codesourcery.com>

	Issue #1531

	bfd/
	* bfd-in.h (elf32_arm_fix_exidx_coverage): Add prototype.
	* bfd-in2.h: Regenerate.
	* elf32-arm.c (arm_unwind_edit_type, arm_unwind_table_edit): Define.
	(_arm_elf_section_data): Add text and exidx fields.
	(add_unwind_table_edit, get_arm_elf_section_data, adjust_exidx_size,
	insert_cantunwind_after, elf32_arm_fix_exidx_coverage, offset_prel31,
	copy_exidx_entry): New functions.
	(elf32_arm_write_section): Fixup .ARM.exidx contents.

	ld/
	* emultempl/armelf.em (compare_output_sec_vma): New function.
	(gld${EMULATION_NAME}_finish): Add exidx munging code.

	ld/testsuite/
	* ld-arm/arm.ld: Add .ARM.exidx and .ARM.extab.
	* ld-arm/arm-elf.exp: Add unwind-[1-4].
	* ld-arm/unwind-1.d: New test.
	* ld-arm/unwind-1.s: New test.
	* ld-arm/unwind-2.d: New test.
	* ld-arm/unwind-2.s: New test.
	* ld-arm/unwind-3.d: New test.
	* ld-arm/unwind-3.s: New test.
	* ld-arm/unwind-4.d: New test.
	* ld-arm/unwind-4.s: New test.

2009-03-30  Andrew Jenner  <andrew@codesourcery.com>

	ld/
	* emultempl/octeonelf.em: Source mipself.em.

	gas/
	* config/tc-arm.c: Move as.h to start of file.

2009-03-30  Joseph Myers  <joseph@codesourcery.com>

	Issue #5084

	Backport from FSF:

	gas/testsuite/
	* gas/arm/mapsecs.d, gas/arm/mapsecs.s: New.

	opcodes/
	* arm-dis.c (print_insn): Also check section matches in backwards
	search for mapping symbol.

2009-03-30  Julian Brown  <julian@codesourcery.com>

	bfd/
	* elf32-arm.c (a8_erratum_fix): Add r_type, st_type, sym_name,
	non_a8_stub fields.
	(find_thumb_glue): Add forward declaration.
	(elf32_arm_size_stubs): Improve integration of Cortex-A8 erratum
	workaround and ARM/Thumb interworking.

	ld/testsuite/
	* ld-arm/cortex-a8-fix-b.s: Update for text at 0x8f00.
	* ld-arm/cortex-a8-fix-bl.s: Likewise.
	* ld-arm/cortex-a8-fix-bcc.s: Likewise.
	* ld-arm/cortex-a8-fix-blx.s: Likewise.
	* ld-arm/cortex-a8-fix-b.d: Update.
	* ld-arm/cortex-a8-fix-bl.d: Update.
	* ld-arm/cortex-a8-fix-bcc.d: Update.
	* ld-arm/cortex-a8-fix-blx.d: Update.
	* ld-arm/cortex-a8-arm-target.s: New.
	* ld-arm/cortex-a8-thumb-target.s: New.
	* ld-arm/cortex-a8-fix-b-rel.s: New.
	* ld-arm/cortex-a8-fix-b-rel-arm.d: New.
	* ld-arm/cortex-a8-fix-b-rel-thumb.d: New.
	* ld-arm/cortex-a8-fix-bl-rel.s: New.
	* ld-arm/cortex-a8-fix-bl-rel-arm.d: New.
	* ld-arm/cortex-a8-fix-bl-rel-thumb.d: New.
	* ld-arm/cortex-a8-fix-bcc-rel.s: New.
	* ld-arm/cortex-a8-fix-bcc-rel-thumb.d: New.
	* ld-arm/cortex-a8-fix-blx-rel.s: New.
	* ld-arm/cortex-a8-fix-blx-rel-arm.d: New.
	* ld-arm/cortex-a8-fix-blx-rel-thumb.d: New.
	* ld-arm/arm-elf.exp: Move text section to 0x8f00 in existing
	Cortex-A8 erratum workaround tests, and add above new tests.

2009-03-29  Mark Mitchell  <mark@codesourcery.com>

	Backport: 
	
	2009-03-28  Mark Mitchell  <mark@codesourcery.com>
	bfd/
	* coff-arm.c (coff_arm_merge_private_bfd_data): Use "error:", not
	"ERROR:", in error messages.
	* cpu-arm.c (bfd_arm_merge_machines): Likewise.
	* elf-attrs.c (_bfd_elf_merge_object_attributes): Likewise.
	* elf32-arm.c (tag_cpu_arch_combine): Likewise.
	(elf32_arm_merge_eabi_attributes): Likewise.
	(elf32_arm_merge_private_bfd_data): Likewise.

2009-03-24  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-arm.c (INTERWORK_FLAG): Check BFD_LINKER_CREATED.

2009-03-22  Mark Mitchell  <mark@codesourcery.com>

	ld/testsuite/
	* ld-arm/arm-elf.exp (armelftests): Use -EL for Cortex-A8 tests.

2009-03-20  Julian Brown  <julian@codesourcery.com>

	* release-notes-csl.xml (Erratum workaround for Cortex-A8 processors):
	Add note.

2009-03-20  Julian Brown  <julian@codesourcery.com>

	ld/testsuite/
	* ld-arm/arm-elf.exp (Cortex-A8 erratum fix, b.w)
	(Cortex-A8 erratum fix, bl.w, Cortex-A8 erratum fix, bcc.w)
	(Cortex-A8 erratum fix, blx.w): Pass --fix-cortex-a8 option.

	bfd/
	* elf32-arm.c (bfd_elf32_arm_set_cortex_a8_fix): Disable fix by
	default in all cases.

2009-03-20  Julian Brown  <julian@codesourcery.com>

	gas/
	* config/tc-arm.c (do_t_blx): Always use BFD_RELOC_THUMB_PCREL_BLX.
	(md_pcrel_from_section): Align address for BLX.
	(tc_gen_reloc): Change BFD_RELOC_THUMB_PCREL_BLX relocations to
	BFD_RELOC_THUMB_PCREL_BRANCH23 for EABI v4+.

	ld/testsuite/
	* ld-arm/arm-elf.exp (armeabitests): Add thumb2-bl-blx-interwork test.
	* ld-arm/thumb2-bl-blx-interwork.s: New.
	* ld-arm/thumb2-bl-blx-interwork.d: New.

2009-03-20  Andrew Stubbs  <ams@codesourcery.com>

	* release-note-csl.xml: Document issue #4250 changes.

2009-03-20  Daniel Jacobowitz  <dan@codesourcery.com>

	* release-notes-csl.xml (Incorrect linker-generated functions): New
	note.

2009-03-19  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #4727

	ld/
	* emultempl/armelf.em (bfd_for_interwork, arm_elf_after_open)
	(arm_elf_set_bfd_for_interworking): Delete.
	(arm_elf_before_allocation): Do not set the interworking BFD.
	Move allocation inside not-dynamic block.
	(arm_elf_create_output_section_statements): Create glue sections
	and set the interworking BFD here.
	(LDEMUL_AFTER_OPEN): Delete.

	ld/testsuite/
	* ld-arm/farcall-mix.d, ld-arm/farcall-mix2.d,
	ld-arm/farcall-group-size2.d, ld-arm/farcall-group.d: Update for
	linker changes.

	bfd/
	* elf32-arm.c (elf32_arm_write_section): Declare early.
	(elf32_arm_size_stubs): Skip non-stub sections in the stub BFD.
	(arm_allocate_glue_section_space): Exclude empty sections.
	(ARM_GLUE_SECTION_FLAGS): Add SEC_LINKER_CREATED.
	(bfd_elf32_arm_add_glue_sections_to_bfd): Do not skip the stub
	BFD.
	(elf32_arm_output_glue_section, elf32_arm_final_link): New.
	(elf32_arm_merge_eabi_attributes): Skip the stub BFD.
	(elf32_arm_size_dynamic_sections): Allocate interworking
	sections here.
	(bfd_elf32_bfd_final_link): Define.

2009-03-18  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #4753

	gas/
	* doc/c-arm.texi: Added entries for cpus ARM Cortex-M0 and Cortex-M1.

2009-03-18  Andrew Stubbs  <ams@codesourcery.com>

	Issue #4250

	gas/
	* config/tc-arm.c (md_apply_fix): Check BFD_RELOC_ARM_IMMEDIATE and
	BFD_RELOC_ARM_ADRL_IMMEDIATE value is in the correct section.
	Check BFD_RELOC_ARM_ADRL_IMMEDIATE has a defined symbol.

	gas/testsuites/
	* gas/arm/adr-invalid.d: New file.
	* gas/arm/adr-invalid.l: New file.
	* gas/arm/adr-invalid.s: New file.

2009-03-17  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #4753

	gas/
	* config/tc-arm.c (arm_cpus): Added cortex-m0. 

2009-03-17  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_check_relocs): Correct symbian_p test.

2009-03-16  Daniel Gutson  <dgutson@codesourcery.com>

	Issue #4753

	* gas/config/tc-arm.c (arm_cpus): Added cortex-m0. 

2009-03-16  Julian Brown  <julian@codesourcery.com>

	ld/
	* emultempl/armelf.em (fix_cortex_a8): New.
	(arm_elf_before_allocation): Call bfd_elf32_arm_set_cortex_a8_fix.
	(arm_elf_create_output_section_statements): Add fix_cortex_a8 to
	bfd_elf32_arm_set_target_relocs.
	(OPTION_FIX_CORTEX_A8): New.
	(PARSE_AND_LIST_LONGOPTS): Add fix-cortex-a8 options.
	(PARSE_AND_LIST_OPTIONS): Add fix-cortex-a8 option.
	(PARSE_AND_LIST_ARGS_CASES): Handle OPTION_FIX_CORTEX_A8.

	bfd/
	* elf32-arm.c (stub_reloc_type): Remove.
	(THUMB32_INSN, THUMB32_B_INSN): New macros.
	(insn_sequence): Change type of reloc_type.
	(elf32_arm_stub_a8_veneer_b_cond, elf32_arm_stub_a8_veneer_b)
	(elf32_arm_stub_a8_veneer_blx): New stub sequences.
	(elf32_arm_stub_type): Add arm_stub_a8_veneer_b_cond,
	arm_stub_a8_veneer_b, arm_stub_a8_veneer_bl and
	arm_stub_a8_veneer_blx.
	(_arm_elf_section_data): Add target_addend field.
	(a8_erratum_fix, a8_erratum_reloc): New structs.
	(elf32_arm_link_hash_table): Add a8_erratum_fixes,
	num_a8_erratum_fixes, fix_cortex_a8.
	(elf32_arm_link_hash_table_create): Zero fix_cortex_a8.
	(elf32_arm_final_link_relocate): Add forward declaration.
	(arm_build_one_stub): Add support for THUMB32_TYPE, Thumb-2
	relocations, multiple relocations per stub.
	(find_stub_size_and_template): New.
	(arm_size_one_stub): Use find_stub_size_and_template.
	(a8_reloc_compare): New.
	(elf32_arm_size_stubs): Add Cortex-A8 erratum workaround support.
	(bfd_elf32_arm_set_cortex_a8_fix): New.
	(bfd_elf32_arm_set_target_relocs): Add fix_cortex_a8 argument.
	(arm_map_one_stub): Add THUMB32_TYPE support.
	(a8_branch_to_stub_data): New.
	(make_branch_to_a8_stub): New.
	(elf32_arm_write_section): Add Cortex-A8 erratum workaround support.
	* bfd-in.h (bfd_elf32_arm_set_cortex_a8_fix): New.
	* bfd-in2.h: Regenerate.

	ld/testsuite/
	* ld-arm/cortex-a8-fix-b.s: New.
	* ld-arm/cortex-a8-fix-b.d: New.
	* ld-arm/cortex-a8-fix-bl.s: New.
	* ld-arm/cortex-a8-fix-bl.d: New.
	* ld-arm/cortex-a8-fix-bcc.s: New.
	* ld-arm/cortex-a8-fix-bcc.d: New.
	* ld-arm/cortex-a8-fix-blx.s: New.
	* ld-arm/cortex-a8-fix-blx.d: New.

2009-03-16  Andrew Stubbs  <ams@codesourcery.com>

	* release-notes-csl.xml: Document linker bug fix.

2009-03-16  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* dwarf2.c (read_section): Always use rawsize, if available.

	Backport
	2009-03-16  Alan Modra  <amodra@bigpond.net.au>
	* simple.c (bfd_simple_get_relocated_section_contents): Use larger
	of rawsize and size for buffer.

2009-03-12  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* dwarf2.c (read_section): Always check the offset, even when the
	section has been read before.

2009-03-11  Joseph Myers  <joseph@codesourcery.com>

	binutils/testsuite/
	* binutils-all/objdump.W, binutils-all/objdump.s: Don't match
	literal "tmpdir/" in expected output.

2009-03-09  Catherine Moore  <clm@codesourcery.com>

	Issue #4861

	Backport from FSF:

	2009-03-03  Alan Modra  <amodra@bigpond.net.au>
	  
	* objdump.c (disassemble_section): Mask address before sign
	extending.

2009-03-08  Mark Mitchell  <mark@codesourcery.com>

	ld/testsuite/
	* ld-elfcomm/elfcomm.exp: Compile with -fcommon.

2009-03-06  Catherine Moore  <clm@codesourcery.com>

	Issue # 4861

	Backport from FSF:

	2009-03-05  Nick Clifton  <nickc@redhat.com>

	* objdump.c (disassemble_section): If the computed next offset is
	not beyond the current offset then just continue to the end.

2009-03-05  Joseph Myers  <joseph@codesourcery.com>

	Issue #4808

	Backport from FSF:

	gas/
	2009-03-05  Joseph Myers  <joseph@codesourcery.com>
	* read.c (s_fill, s_space, s_float_space, float_cons, stringer,
	s_incbin): Call md_cons_align (1).

	gas/testsuite/
	2009-03-05  Joseph Myers  <joseph@codesourcery.com>
	* gas/arm/mapmisc.d, gas/arm/mapmisc.dat, gas/arm/mapmisc.s: New.

2009-03-01  Mark Mitchell  <mark@codesourcery.com>

	Issue #4781

	* release-notes-csl.xml: Document change.
	gas/
	* config/tc-arm.c (md_assemble): Allow barrier instructions on
	ARMv6-M cores.
	gas/testsuite/
	* arm/archv6m.s: Add dmb, dsb, and isb.
	* arm/archv6m.d: Likewise.

2009-02-24  Sandra Loosemore  <sandra@codesourcery.com>

	Issue #2369
	Patch applied simultaneously on mainline.

	ld/
	* ld.texinfo (Options): Correct typos in example.  Recommend
	using joined forms of syntax for passing options with arguments 
	from a driver.
	(-a): Use consistent syntax for documenting option arguments.
	Clean up indexing and markup.
	(-A/--architecture): Likewise.
	(-f/--auxiliary): Likewise.
	(-F/--filter): Likewise.
	(-fini): Likewise.
	(-G/--gpsize): Likewise.
	(-h/-soname):Likewise.
	(-init): Likewise.
	(-l/--library): Likewise.
	(-L/--library-path): Likewise.
	(-m): Likewise.
	(--defsym): Likewise.
	(-I/--dynamic-linker): Likewise.
	(-Map): Likewise.
	(--oformat): Likewise.
	(--retain-symbols-file): Likewise.
	(-rpath): Likewise.
	(-rpath-link): Likewise.
	(--sort-common): Likewise.
	(--sort-section): Likewise.
	(--split-by-file): Likewise.
	(--split-by-reloc): Likewise.
	(--sysroot): Likewise.
	(--section-start): Likewise.
	(-Tbss, -Tdata, -Ttext): Likewise.
	(-Ttext-segment): Likewise.
	(--version-script): Likewise.
	(--wrap): Likewise.

2009-02-24  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Revert:
	
	2009-02-19  Maxim Kuvyrkov  <maxim@codesourcery.com>
	Issue #4600

	bfd/
	* elf.c (_bfd_elf_map_sections_to_segments): Fix sanity check.

	2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/

	* elf.c (_bfd_elf_map_sections_to_segments): Check user's
	mapping of section to segments.

2009-02-22  Mark Mitchell  <mark@codesourcery.com>

	* release-notes-csl.xml: Document change.
	gas/
	* config/tc-arm.c (warn_deprecated_sp): New macro.
	(do_t_mov_cmp): Permit R13 as the second
	argument to "cmp.n".
	gas/testsuite/
	* gas/arm/thumb2_bad_reg.s: Update.
	* gas/arm/thumb2_bad_reg.l: Likewise.
	
2009-02-23  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_stub_long_branch_any_any_pic): Rename
	to elf32_arm_stub_long_branch_any_arm_pic.
	(elf32_arm_stub_long_branch_any_thumb_pic): New.
	(enum elf32_arm_stub_type, arm_type_of_stub)
	(arm_size_one_stub): Handle any to ARM PIC and any to Thumb PIC
	separately.

	ld/testsuite/
	* ld-arm/farcall-arm-thumb-blx-pic-veneer.d,
	ld-arm/farcall-arm-thumb-pic-veneer.d,
	ld-arm/farcall-thumb-thumb-blx-pic-veneer.d: Update for fixed
	Thumb PIC stub.

2009-02-23  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elf32-arm.c (PREV_SEC): Update comment.
	(group_sections): Rename argument to stubs_always_after_branch.
	Reverse the list and place stubs at the end of input sections.
	Undefine NEXT_SEC.
	(elf32_arm_size_stubs): Update to use stubs_always_after_branch.

	ld/
	* ld.texinfo (ARM): Document changed meaning of --stub-group-size.
	* emultempl/armelf.em (hook_in_stub): Insert after the input section.
	(elf32_arm_add_stub_section): Update comment.
	(PARSE_AND_LIST_OPTIONS): Update help for --stub-group-size.

2009-02-23  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/testsuite/
	* ld-arm/arm-elf.exp (armeabitests): Update duplicate test names.
	Use normal output files for big-endian.
	* ld-arm/farcall-arm-arm-be.d, ld-arm/farcall-thumb-arm-be.d: Delete.
	* ld-arm/farcall-arm-arm-be8.d, ld-arm/farcall-arm-arm-pic-veneer.d,
	ld-arm/farcall-arm-arm.d, ld-arm/farcall-arm-thumb-blx-pic-veneer.d,
	ld-arm/farcall-arm-thumb-blx.d, ld-arm/farcall-arm-thumb-pic-veneer.d,
	ld-arm/farcall-arm-thumb.d, ld-arm/farcall-group-size2.d,
	ld-arm/farcall-group.d, ld-arm/farcall-mix.d, ld-arm/farcall-mix2.d,
	ld-arm/farcall-thumb-arm-be8.d,
	ld-arm/farcall-thumb-arm-blx-pic-veneer.d,
	ld-arm/farcall-thumb-arm-blx.d, ld-arm/farcall-thumb-arm-short.d,
	ld-arm/farcall-thumb-arm.d,
	ld-arm/farcall-thumb-thumb-blx-pic-veneer.d,
	ld-arm/farcall-thumb-thumb-blx.d, ld-arm/farcall-thumb-thumb-m.d,
	ld-arm/farcall-thumb-thumb.d, ld-arm/thumb2-bl-as-thumb1-bad.d,
	ld-arm/thumb2-bl-bad.d: Update for moved stubs.

2009-02-23  Daniel Jacobowitz  <dan@codesourcery.com>

	Backport:

	2009-02-23  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elf32-arm.c (arm_build_one_stub): Initialize stub_reloc_offset.
	Fix formatting.
	(arm_size_one_stub): Remove unnecessary break.
	(arm_map_one_stub): Fix formatting.  Return after BFD_FAIL.

	2009-02-23  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/testsuite/
	* ld-arm/arm-elf.exp (armeabitests): Run new tests.  Correct BE8 output
	filename.
	* ld-arm/farcall-arm-arm-be.d, ld-arm/farcall-thumb-arm-be.d: New.

	2009-02-23  Christophe Lyon  <christophe.lyon@st.com>

	bfd/
	* elf32-arm.c (stub_insn_type): New type.
	(stub_reloc_type): Likewise.
	(insn_sequence): Likewise.
	(elf32_arm_stub_long_branch_any_any): Encode using insn_sequence.
	(elf32_arm_stub_long_branch_v4t_arm_thumb): Likewise.
	(elf32_arm_stub_long_branch_thumb_only): Likewise.
	(elf32_arm_stub_long_branch_v4t_thumb_arm): Likewise.
	(elf32_arm_stub_short_branch_v4t_thumb_arm): Likewise.
	(elf32_arm_stub_long_branch_any_any_pic): Likewise.
	(elf32_arm_stub_hash_entry): Add new helper fields.
	(stub_hash_newfunc): Initialize these new fields.
	(arm_build_one_stub): Encode Arm and Thumb instructions separately
	to take endianness into account.
	(arm_size_one_stub): Compute size of stubs using insn_sequence.
	(arm_map_one_stub): Code is now more generic, thanks to
	insn_sequence.

	ld/testsuite/
	* ld-arm/arm-elf.exp: Add new farcall-thumb-arm-be8 test.
	* ld-arm/farcall-thumb-arm-be8.d: New expected result.
	* ld-arm/farcall-arm-arm-be8.d: Replace wildcards by instructions.

	2009-02-23  Christophe Lyon  <christophe.lyon@st.com>

	bfd/
	* elf32-arm.c (elf32_arm_stub_long_branch_thumb_only): Fix stub
	code.
	(elf32_arm_stub_long_branch_v4t_thumb_arm): Likewise.
	(arm_type_of_stub): Use Thumb-only long branch stub (non-PIC) when
	BLX is not available. Fix typo in warning message. Add comments
	and improve formatting.
	(arm_build_one_stub): Adjust to new
	elf32_arm_stub_long_branch_v4t_thumb_arm stub.
	(arm_map_one_stub): Likewise.

	ld/testsuite/
	* ld-arm/arm-elf.exp: Rewrite non-EABI variants of
	thumb2-bl-as-thumb1-bad and thumb2-bl-bad tests, which now
	pass. farcall-thumb-thumb now passes in EABI mode.
	* ld-arm/farcall-thumb-arm-pic-veneer.d: Fixed name, source, as
	and ld flags to match intended test.
	* ld-arm/farcall-thumb-arm.d: New expected result.
	* ld-arm/farcall-thumb-thumb-m.d: Likewise.
	* ld-arm/farcall-thumb-thumb-m-pic-veneer.d: Fixed name and ld
	flags.
	* ld-arm/farcall-thumb-thumb-pic-veneer.d: Likewise.
	* ld-arm/farcall-thumb-thumb.d: New expected result, this test is
	now expected to pass.
	* ld-arm/thumb2-bl-as-thumb1-bad-noeabi.d: Likewise.
	* ld-arm/thumb2-bl-bad-noeabi.d: Likewise.
	* ld-arm/thumb2-bl-as-thumb1-bad.d: Update addresses according to
	new use.
	* ld-arm/thumb2-bl-as-thumb1-bad.s: Update comment.

	2009-02-18  Christophe Lyon  <christophe.lyon@st.com>

	bfd/
	* elf32-arm.c (arm_build_one_stub): Fix relocation target for pic
	stub. Catch default case error.
	(arm_map_one_stub): Add missing Thumb mapping symbol.

	ld/testsuite/
	* ld-arm/farcall-arm-arm-pic-veneer.d,
	ld-arm/farcall-arm-thumb-blx-pic-veneer.d,
	ld-arm/farcall-arm-thumb-pic-veneer.d,
	ld-arm/farcall-thumb-arm-blx-pic-veneer.d,
	ld-arm/farcall-thumb-thumb-blx-pic-veneer.d: Fix expected stub
	target.

	2009-02-16  Christophe Lyon  <christophe.lyon@st.com>

	bfd/
	* elf32-arm.c (arm_long_branch_stub,
	arm_thumb_v4t_long_branch_stub,
	arm_thumb_thumb_long_branch_stub,
	arm_thumb_arm_v4t_long_branch_stub,
	arm_thumb_arm_v4t_short_branch_stub,
	arm_pic_long_branch_stub):
	Renamed to elf32_arm_stub_long_branch_any_any,
	elf32_arm_stub_long_branch_v4t_arm_thumb,
	elf32_arm_stub_long_branch_thumb_only,
	elf32_arm_stub_long_branch_v4t_thumb_arm,
	elf32_arm_stub_short_branch_v4t_thumb_arm,
	elf32_arm_stub_long_branch_any_any_pic.
	(arm_stub_long_branch, arm_thumb_v4t_stub_long_branch,
	arm_thumb_thumb_stub_long_branch,
	arm_thumb_arm_v4t_stub_long_branch,
	arm_thumb_arm_v4t_stub_short_branch, arm_stub_pic_long_branch):
	Renamed to arm_stub_long_branch_any_any,
	arm_stub_long_branch_v4t_arm_thumb,
	arm_stub_long_branch_thumb_only,
	arm_stub_long_branch_v4t_thumb_arm,
	arm_stub_short_branch_v4t_thumb_arm,
	arm_stub_long_branch_any_any_pic.

2009-02-22  Mark Mitchell  <mark@codesourcery.com>

	Issue #4694
	* release-notes-csl.xml: Document fix.
	Backport:
	libiberty/
	2009-02-21  Mark Mitchell  <mark@codesourcery.com>
	* make-temp-file.c (<windows.h>): Include on Windows.
	(choose_tmpdir): On Windows, use GetTempPath.

2009-02-19  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Issue #4600

	bfd/
	* elf.c (_bfd_elf_map_sections_to_segments): Fix sanity check.

2009-02-18  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #4577
	gas/
	* config/tc-arm.c (do_nop): Generate v6k nops whenever possible.
	(arm_handle_align): Generate v6k ARM, thumb2 wide & narrow nops
	whenever possible.

	gas/testsuite/
	* gas/arm/align.s, gas/arm/align.d: New.
	* gas/arm/thumb32.d, gas/arm/arch6zk.d, gas/arm/arch6zk.s,
	arm/thumb2_relax.d: Adjust for align changes.

2009-02-05  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elf.c: Revert local version of issue 3598 patch.

2009-02-05  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elflink.c: Resync with upstream.

	binutils/
	* sysdep.h: Resync with upstream.

2009-02-05  Joseph Myers  <joseph@codesourcery.com>

	gas/
	* config/tc-m68k.c: Resync whitespace with upstream.
	* config/tc-mips.c: Remove duplicate 74kf3_2 entry.

	gas/testsuite/
	* gas/arm/backslash-at.d: Resync with upstream.

	include/opcode/
	* mips.h: Remove relics of old Octeon support.

2009-02-05  Joseph Myers  <joseph@codesourcery.com>

	gas/
	* config/tc-mips.c: Remove relics of old Octeon support.  Adjust
	error checking in line with
	<https://intranet.codesourcery.com/ml/gnu-mips-sgxx/2008-08/msg00069.html>.

	gas/testsuite/
	* gas/mips/octeon1.l, gas/mips/octeon3.d, gas/mips/octeon3.s:
	Update for assembler changes.

	opcodes/
	* mips-dis.c: Remove relics of old Octeon support.
	* mips-opc.c: Restore Octeon sync instructions.

2009-02-04  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Clean up m68k TLS implementation after upstream contribution.
	
	ld/testsuite/
	* ld-m68k/tls-gd-ie-1.d: Update.
	* ld-m68k/tls-gd-3.d, ld-m68k/tls-gd-3.s: Move to gas testsuite.
	* ld-m68k/m68k.exp (merge isa-a isa-a:nodiv): Fix test.
	(tls-*): Run only for m68k-*-linux* targets.

	gas/testsuite/
	* gas/m68k/tls-gd-3.d, gas/m68k/tls-gd-3.s: New test.
	* gas/m68k/all.exp: Run it.

	gas/
	* config/tc-m68k.c: Fix whitespace.

	bfd/
	* elf32-m68k.c: Fix formatting.
	(elf_m68k_relocate_section): Remove duplicate code.  Use
	SYMBOL_REFERENCES_LOCAL.
	(elf_m68k_finish_dynamic_symbol): Use SYMBOL_REFERENCES_LOCAL.

2009-02-04  Andrew Jenner  <andrew@codesourcery.com>

        gas/
        * configure.tgt: Handle mips-montavista-elf.

2009-02-03  Kazu Hirata  <kazu@codesourcery.com>

	config/
	* mh-mingw (BOOT_CFLAGS): Remove -D__USE_MINGW_ACCESS.
	(CFLAGS): Comment out.

	libiberty/
	* cygpath.c (msvcrt_dll): Change the return type to HMODULE.
	(msvcrt_fopen): Use HMODULE for the return value from msvcrt_dll.OB

2009-02-03  Joseph Myers  <joseph@codesourcery.com>

	Issue #4540

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_section_processing): Remove special
	.sbss handling.

2009-02-02  Kazu Hirata  <kazu@codesourcery.com>

	gprof/
	* gprof.h: Include gconfig.h.  #undef PACKAGE.

	ld/
	* gprof.h: Include config.h.

2009-01-30  Catherine Moore  <clm@codesourcery.com>

	bfd/
	elf32-m68k.c (elf_m68k_relocate_section): Pass relocation
	type to elf_m68k_init_got_entry_key.

2009-01-29  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elf32-arm.c: Resync whitespace with upstream.

	gas/
	* doc/c-mips.texi: Remove duplicate 74kf3_2 entry.

	ld/
	* configure.in: Replace AC_ERROR with AC_MSG_ERROR.
	* emultempl/m68kelf.em: Resync whitespace with upstream.

2009-01-29  Catherine Moore  <clm@codesourcery.com>

	bfd/
	elfxx-mips.c (mips_elf_calculate_relocation): Add check
	for (h != NULL).

2009-01-28  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_mach_extensions): Remove duplicate Octeon
	entry.

	gas/
	* config/tc-mips.c (CPU_HAS_DROR): Remove Octeon handling.
	(CPU_HAS_INS): Remove.

	gas/testsuite/
	* gas/mips/mips.exp: Resync whitespace with upstream.

	include/elf/
	* mips.h: Resync whitespace with upstream.

	include/opcode/
	* mips.h (OPCODE_IS_MEMBER): Remove duplicate Octeon check.

	opcodes/
	* mips-opc.c (mips_builtin_opcodes): Remove duplicate pop
	instruction.

2009-01-28  Joseph Myers  <joseph@codesourcery.com>

	* config.sub: Remove XLR targets.
	* configure.ac: Move mips*-sde-elf* case to upstream location.
	Don't add target-sdemdi.
	* configure: Regenerate.

	bfd/
	* elf.c: Remove duplicate if conditional.
	* elf32-m68k.c: Remove conflict marker.
	* elfxx-mips.c: Resync whitespace with upstream.  Remove duplicate
	comment.

	config/
	* mt-sde: Revert difference from upstream.

	ld/testsuite/
	* ld-arm/arm-elf.exp: Remove duplicate runs of some tests.

	opcodes/
	* ppc-dis.c: Remove duplicate if conditional.

2009-01-25  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/
	* elf32-m68k.c (elf_m68k_finalize_got_offsets): Fix condition.

2009-01-25  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/
	* elf32-m68k.c (struct elf_m68k_finalize_got_offsets_arg): Remove
	use_neg_got_offsets_p field.
	(elf_m68k_finalize_got_offsets_1, elf_m68k_finalize_got_offsets):
	Update, don't use not initialized data, initialize data before
	using it.

2009-01-21  Andrew Stubbs  <ams@codesourcery.com>

	Issue #4300

	gas/
	* config/tc-arm.c (attributes_set_explicitly): New array.
	(s_arm_eabi_attribute): Check return value from s_vendor_attribute.
	(cpu_arch): Add ARM_ARCH_V5T.
	(aeabi_set_attribute_int): New function.
	(aeabi_set_attribute_string): New function.
	(aeabi_set_public_attributes): Set attributes according to the user's
	intentions, rather than the actual state of the binary.
	Use aeabi_set_attribute_int and aeabi_set_attribute_string instead of
	bfd_elf_add_proc_attr_int and bfd_elf_add_proc_attr_string.
	Support WMMXv2. Use attribute names instead of numbers.
	* read.c (s_vendor_attribute): Change return type to int.
	Return the tag number that was set.
	* read.h (s_vendor_attribute): Change return type to int.

	gas/testsuite/
	* gas/arm/attr-cpu-directive.d: New file.
	* gas/arm/attr-cpu-directive.s: New file.
	* gas/arm/attr-default.d: New file.
	* gas/arm/attr-march-all.d: New file.
	* gas/arm/attr-march-armv1.d: New file.
	* gas/arm/attr-march-armv2.d: New file.
	* gas/arm/attr-march-armv2a.d: New file.
	* gas/arm/attr-march-armv2s.d: New file.
	* gas/arm/attr-march-armv3.d: New file.
	* gas/arm/attr-march-armv3m.d: New file.
	* gas/arm/attr-march-armv4.d: New file.
	* gas/arm/attr-march-armv4t.d: New file.
	* gas/arm/attr-march-armv4txm.d: New file.
	* gas/arm/attr-march-armv4xm.d: New file.
	* gas/arm/attr-march-armv5.d: New file.
	* gas/arm/attr-march-armv5t.d: New file.
	* gas/arm/attr-march-armv5te.d: New file.
	* gas/arm/attr-march-armv5tej.d: New file.
	* gas/arm/attr-march-armv5texp.d: New file.
	* gas/arm/attr-march-armv5txm.d: New file.
	* gas/arm/attr-march-armv6-m.d: New file.
	* gas/arm/attr-march-armv6.d: New file.
	* gas/arm/attr-march-armv6j.d: New file.
	* gas/arm/attr-march-armv6k.d: New file.
	* gas/arm/attr-march-armv6kt2.d: New file.
	* gas/arm/attr-march-armv6t2.d: New file.
	* gas/arm/attr-march-armv6z.d: New file.
	* gas/arm/attr-march-armv6zk.d: New file.
	* gas/arm/attr-march-armv6zkt2.d: New file.
	* gas/arm/attr-march-armv6zt2.d: New file.
	* gas/arm/attr-march-armv7-a.d: New file.
	* gas/arm/attr-march-armv7-m.d: New file.
	* gas/arm/attr-march-armv7-r.d: New file.
	* gas/arm/attr-march-armv7.d: New file.
	* gas/arm/attr-march-armv7a.d: New file.
	* gas/arm/attr-march-armv7m.d: New file.
	* gas/arm/attr-march-armv7r.d: New file.
	* gas/arm/attr-march-iwmmxt.d: New file.
	* gas/arm/attr-march-iwmmxt2.d: New file.
	* gas/arm/attr-march-marvell-f.d: New file.
	* gas/arm/attr-march-xscale.d: New file.
	* gas/arm/attr-mcpu.d: New file.
	* gas/arm/attr-mfpu-arm1020e.d: New file.
	* gas/arm/attr-mfpu-arm1020t.d: New file.
	* gas/arm/attr-mfpu-arm1136jf-s.d: New file.
	* gas/arm/attr-mfpu-arm1136jfs.d: New file.
	* gas/arm/attr-mfpu-arm7500fe.d: New file.
	* gas/arm/attr-mfpu-fpa.d: New file.
	* gas/arm/attr-mfpu-fpa10.d: New file.
	* gas/arm/attr-mfpu-fpa11.d: New file.
	* gas/arm/attr-mfpu-fpe.d: New file.
	* gas/arm/attr-mfpu-fpe2.d: New file.
	* gas/arm/attr-mfpu-fpe3.d: New file.
	* gas/arm/attr-mfpu-maverick.d: New file.
	* gas/arm/attr-mfpu-neon-fp16.d: New file.
	* gas/arm/attr-mfpu-neon.d: New file.
	* gas/arm/attr-mfpu-softfpa.d: New file.
	* gas/arm/attr-mfpu-softvfp+vfp.d: New file.
	* gas/arm/attr-mfpu-softvfp.d: New file.
	* gas/arm/attr-mfpu-vfp.d: New file.
	* gas/arm/attr-mfpu-vfp10-r0.d: New file.
	* gas/arm/attr-mfpu-vfp10.d: New file.
	* gas/arm/attr-mfpu-vfp3.d: New file.
	* gas/arm/attr-mfpu-vfp9.d: New file.
	* gas/arm/attr-mfpu-vfpv2.d: New file.
	* gas/arm/attr-mfpu-vfpv3-d16.d: New file.
	* gas/arm/attr-mfpu-vfpv3.d: New file.
	* gas/arm/attr-mfpu-vfpxd.d: New file.
	* gas/arm/attr-order.d: Update Tag_ARM_ISA_use and Tag_THUMB_ISA_use.
	* gas/arm/attr-override-cpu-directive.d: New file.
	* gas/arm/attr-override-cpu-directive.s: New file.
	* gas/arm/attr-override-mcpu.d: New file.
	* gas/arm/attr-override-mcpu.s: New file.
	* gas/arm/blank.s: New file.
	* gas/arm/eabi_attr_1.d: Update Tag_ARM_ISA_use and Tag_THUMB_ISA_use.

	ld/testsuite/
	* ld-arm/attr-merge-3.attr: Update following gas change.
	* ld-arm/attr-merge-2.attr: Update Tag_ARM_ISA_use and
	Tag_THUMB_ISA_use following gas changes.
	* ld-arm/attr-merge-4.attr: Likewise.
	* ld-arm/attr-merge-5.attr: Likewise.
	* ld-arm/attr-merge-arch-1.attr: Likewise.
	* ld-arm/attr-merge-arch-2.attr: Likewise.
	* ld-arm/attr-merge-unknown-2.d: Likewise.
	* ld-arm/attr-merge-unknown-2r.d: Likewise.
	* ld-arm/attr-merge-unknown-3.d: Likewise.
	* ld-arm/attr-merge-wchar-00-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-00.d: Likewise.
	* ld-arm/attr-merge-wchar-02-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-02.d: Likewise.
	* ld-arm/attr-merge-wchar-04-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-04.d: Likewise.
	* ld-arm/attr-merge-wchar-20-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-20.d: Likewise.
	* ld-arm/attr-merge-wchar-22-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-22.d: Likewise.
	* ld-arm/attr-merge-wchar-24-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-40-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-40.d: Likewise.
	* ld-arm/attr-merge-wchar-42-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-44-nowarn.d: Likewise.
	* ld-arm/attr-merge-wchar-44.d: Likewise.
	* ld-arm/attr-merge.attr: Likewise.

2009-01-21  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf-attrs.c (is_default_attr): Substitute magic numbers with macros.
	(obj_attr_size): Likewise.
	(write_obj_attribute): Likewise.
	(_bfd_elf_copy_obj_attributes): Likewise.
	(_bfd_elf_parse_attributes): Likewise.
	* elf-bfd.h (ATTR_TYPE_FLAG_INT_VAL): New define.
	(ATTR_TYPE_FLAG_STR_VAL, ATTR_TYPE_FLAG_NO_DEFAULT): New defines.
	(ATTR_TYPE_HAS_INT_VAL, ATTR_TYPE_HAS_STR_VAL): New defines.
	(ATTR_TYPE_HAS_NO_DEFAULT): New define.
	* elf32-arm.c (elf32_arm_obj_attrs_arg_type): Replace magic numbers
	with macros.

2009-01-06  Andrew Stubbs   <ams@codesourcery.com>

	* release-notes-csl.xml: Document ARM attributes improvements.

2009-01-01  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	2008-12-23  Nick Clifton  <nickc@redhat.com>
	PR 7093
	* elf32-arm.c (bfd_elf32_arm_init_maps): Only process ARM ELF
	object files.

2008-12-24  Andrew Stubbs  <ams@codesourcery.com>

	ld/testsuite/
	* ld-arm/arm-elf.exp (armeabitests): Add EABI attribute merging 3,
	EABI attribute merging 4, and EABI attribute merging 5,
	EABI attribute arch merging 1, EABI attribute arch merging 1 reversed,
	EABI attribute arch merging 2, EABI attribute arch merging 2 reversed.
	Add attr-merge-unknown-1, attr-merge-unknown-2, attr-merge-unknown-2r,
	and attr-merge-unknown-3 dump tests.
	* ld-arm/arch-v6.s: New file.
	* ld-arm/arch-v6k.s: New file.
	* ld-arm/arch-v6t2.s: New file.
	* ld-arm/attr-merge-3.attr: New file.
	* ld-arm/attr-merge-3a.s: New file.
	* ld-arm/attr-merge-3b.s: New file.
	* ld-arm/attr-merge-4.attr: New file.
	* ld-arm/attr-merge-4a.s: New file.
	* ld-arm/attr-merge-4b.s: New file.
	* ld-arm/attr-merge-5.attr: New file.
	* ld-arm/attr-merge-5.s: New file.
	* ld-arm/attr-merge-arch-1.attr: New file.
	* ld-arm/attr-merge-arch-2.attr: New file.
	* ld-arm/attr-merge-unknown-1.d: New file.
	* ld-arm/attr-merge-unknown-1.s: New file.
	* ld-arm/attr-merge-unknown-2.d: New file.
	* ld-arm/attr-merge-unknown-2.s: New file.
	* ld-arm/attr-merge-unknown-2r.d: New file.
	* ld-arm/attr-merge-unknown-3.d: New file.
	* ld-arm/blank.s: New file.

2008-12-24  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf-attrs.c (vendor_set_obj_attr_contents): Support tag ordering.
	* elf-bfd.h (elf_backend_data): Add obj_attrs_order.
	* elf32-arm.c (elf32_arm_obj_attrs_order): New function.
	(elf_backend_obj_attrs_order): New define.
	* elfxx-target.h (elf_backend_obj_attrs_order): New define.
	(elfNN_bed): Add elf_backend_obj_attrs_order.

	gas/testsuite/
	* gas/arm/attr-order.d: New file.
	* gas/arm/attr-order.s: New file.

2008-12-24  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf-attrs.c (is_default_attr): Support defaultless attributes.
	(bfd_elf_add_obj_attr_int): Get type from _bfd_elf_obj_attrs_arg_type.
	(bfd_elf_add_obj_attr_string): Likewise.
	(bfd_elf_add_obj_attr_int_string): Likewise.
	(_bfd_elf_parse_attributes): Allow for unknown flag bits in type.
	* elf-bfd.h (struct obj_attribute): Document new flag bit.
	* elf32-arm.c (elf32_arm_obj_attrs_arg_type): Specify that
	Tag_nodefaults has no default value.
	(elf32_arm_merge_eabi_attributes): Modify the Tag_nodefaults
	comment to reflect the new state.

	gas/
	* read.c (s_vendor_attribute): Allow for unknown flag bits in type.

2008-12-24  Andrew Stubbs  <ams@codesourcery.com>
	    Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #1581

	gas/
	* config/tc-arm.c (arm_copy_symbol_attributes): New function.
	* config/tc-arm.h (arm_copy_symbol_attributes): New prototype.
	(CONVERT_SYMBOLIC_ATTRIBUTE): New define.
	* read.c (s_vendor_attribute): Add support for symbolic tag names.
	Improve string parser.
	* doc/c-arm.texi (ARM Machine Directives): Document
	.eabi_attribute symbolic tag names.

	gas/testsuite/
	* gas/arm/attr-syntax.d: New file.
	* gas/arm/attr-syntax.s: New file.

2008-12-24  Andrew Stubbs  <ams@codesourcery.com>
	    Julian Brown   <julian@codesourcery.com>

	bfd/
	* elf-bfd.h (NUM_KNOWN_OBJ_ATTRIBUTES): Set to 71 to include all known
	ARM attributes in ABI 2.07.
	* elf32-arm.c (get_secondary_compatible_arch): New function.
	(set_secondary_compatible_arch): New function.
	(tag_cpu_arch_combine): New function.
	(elf32_arm_copy_one_eabi_other_attribute): Delete function.
	(elf32_arm_copy_eabi_other_attribute_list): Delete function.
	(elf32_arm_merge_eabi_attributes): Rename order_312 to order_021 to
	make it fit with order_01243.
	Add support for Tag_also_compatible_with,
	Tag_CPU_unaligned_access, Tag_T2EE_use, Tag_Virtualization_use,
	Tag_MPextension_use, Tag_nodefaults and Tag_conformance.
	Improve/tidy up support for Tag_CPU_raw_name, Tag_CPU_name,
	Tag_CPU_arch, Tag_ABI_HardFP_use, Tag_VFP_HP_extension,
	Tag_ABI_FP_denormal, Tag_ABI_PCS_GOT_use, Tag_ABI_align8_needed,
	Tag_VFP_arch and Tag_ABI_FP_16bit_format.
	Rework the way unknown attributes are handled.
	Defer errors until all attributes have been processed.

	gas/
	* config/tc-arm.c (cpu_arch): Change ARM_ARCH_V6M to 11.

	include/elf/
	* arm.h (TAG_CPU_ARCH_V6_M, TAG_CPU_ARCH_V6S_M): New defines.
	(MAX_TAG_CPU_ARCH, TAG_CPU_ARCH_V4T_PLUS_V6_M): New defines.
	(Tag_NEON_arch): Rename to Tag_Advanced_SIMD_arch to match ARM ABI
	version 2.07.
	(Tag_undefined39, Tag_nodefaults): New enum values.
	(Tag_also_compatible_with, Tag_T2EE_use): Likewise.
	(Tag_conformance, Tag_Virtualization_use): Likewise.
	(Tag_undefined69, Tag_MPextension_use): Likewise.

2008-12-24  Andrew Stubbs  <ams@codesourcery.com>

	bfd/
	* elf-attrs.c (bfd_elf_add_obj_attr_compat): Rename to
	bfd_elf_add_obj_attr_int_string.
	Read Tag_compatibility from its new location in the attribute array,
	rather than the attribute list.
	(_bfd_elf_copy_obj_attributes): bfd_elf_add_obj_attr_compat ->
	bfd_elf_add_obj_attr_int_string.
	(_bfd_elf_parse_attributes): Likewise.
	(_bfd_elf_merge_object_attributes): There's now only one
	Tag_compatibility, and it's in the array, not the list.
	* elf-bfd.h (NUM_KNOWN_OBJ_ATTRIBUTES): Set to 33 to include
	Tag_compatibility.
	(bfd_elf_add_obj_attr_compat): Rename to
	bfd_elf_add_obj_attr_int_string.
	(bfd_elf_add_proc_attr_compat): Rename to
	bfd_elf_add_proc_attr_int_string.
	elf32-arm.c (elf32_arm_merge_eabi_attributes): Explicitly don't handle
	Tag_compatibility.

	gas/
	* read.c (s_vendor_attribute): bfd_elf_add_obj_attr_compat ->
	bfd_elf_add_obj_attr_int_string.

2008-12-11  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (m68k_cpus): Add 51jm.

2008-12-09  Andrew Stubbs  <ams@codesourcery.com>

	binutils/
	* readelf.c (arm_attr_tag_CPU_arch): Add "v6-M" and "v6S-M".
	(arm_attr_tag_WMMX_arch): Add "WMMXv2".
	(arm_attr_tag_NEON_arch): Rename to ...
	(arm_attr_tag_Advanced_SIMD_arch): ... official name.
	(arm_attr_tag_ABI_PCS_config): Rename to ...
	(arm_attr_tag_PCS_config): ... official name.
	(arm_attr_tag_ABI_PCS_RO_DATA): Rename to ...
	(arm_attr_tag_ABI_PCS_RO_data): ... official name.
	(arm_attr_tag_ABI_FP_denormal): Add "Sign only".
	(arm_attr_tag_CPU_unaligned_access): New array.
	(arm_attr_tag_T2EE_use): New array.
	(arm_attr_tag_Virtualization_use): New array.
	(arm_attr_tag_MPextension_use): New array.
	(arm_attr_publ): NEON_arch -> Advanced_SIMD_arch.
	ABI_PCS_config -> PCS_config.
	ABI_PCS_RO_DATA -> ABI_PCS_RO_data.
	Add CPU_unaligned_access, nodefaults, also_compatible_with,
	T2EE_use, conformance, Virtualization_use and MPextension_use.
	(display_arm_attribute): Handle Tag_nodefaults and
	Tag_also_compatible_with.

2008-12-01  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #2968
	* release-notes-csl.xml: Document attribute fix.

	bfd/
	* elf-attrs.c (elf_new_obj_attr, bfd_elf_get_obj_attr_int): Correct
	comments.
	(_bfd_elf_merge_object_attributes): Support final Tag_compatibility.

2008-11-30  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/
	* elf32-m68k.c (elf_m68k_relocate_section): Fix indentation,
	adjust relocation when appropriate.

2008-11-24  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_final_link_relocate): Do not turn
	branches to undefine weak symbols into branches to the next
	instruction if creating PLT entries for those symbols.

	ld/testsuite/
	* ld-arm/thumb2-bl-undefweak.d, ld-arm/thumb2-bl-undefweak.s: New.
	* ld-arm/arm-elf.exp: Run thumb2-bl-undefweak test.

2008-11-14  Catheirne Moore  <clm@codesourcery.com>

	opcodes/
	* mips-opc.c (sync, sync.p, sync.l, synci): Remove duplicates.

2008-11-12  Catherine Moore  <clm@codesourcery.com>

	gas/testsuite/
	* gas/mips/mips.exp (mips32-sync):  Only run for mips targets.

2008-11-09  Catherine Moore  <clm@codesourcery.com>

	Issue #4135

	Backport from mainline:

	2008-11-06  Chao-ying Fu  <fu@mips.com>

	opcodes/
	* mips-opc.c (synciobdma, syncs, syncw, syncws): Move these
	before sync.
	(sync): New instruction with 5-bit sync type.
	* mips-dis.c (print_insn_args: Add case '1' to print 5-bit values.

	gas/
	* config/tc-mips.c (validate_mips_insn): Add case '1'.
	(mips_ip): Add case '1' to process sync type.

	gas/testsuite/
	* gas/mips/mips32-sync.d, gas/mip/mips32-sync.s: New tests.
	* gas/mips/mips.exp: Run them.

	include/opcode/
	* mips.h: Doucument '1' for 5-bit sync type.

2008-11-07  Catherine Moore  <clm@codesourcery.com>

	Issue #3827

	* bfd/elfxx-mips.c (_bfd_mips_elf_always_size_sections): Move
	the sizing of the nonpic to pic stubs prior to the check for
	the presence of a dynamic object.

2008-10-24  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gas/
	* config/tc-m68k.c (md_pseudo_table): Use .long instead of .word
	to handle TLS debug information.
	(m68k_elf_cons): Remove workaround.

2008-10-24  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (m68k_elf_cons): Force used.

2008-10-23  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (md_pseudo_table): Disable .word override for
	now.

2008-10-13  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xsl (Bug fix for assembly listing):
	Conditionalize for windows host.
	(Bug fix for objdump on Windows): Likewise.

2008-10-13  Andrew Stubbs  <ams@codesourcery.com>

	Issue #3536

	Backport from mainline:
	bfd/
	2008-10-08  Alan Modra  <amodra@bigpond.net.au>
	
	* elf.c (assign_file_positions_for_load_sections): When checking
	a segment for contents, don't assume that a non-TLS nobits section
	must only be followed by nobits sections.

2008-10-13  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_cpu_info_table): Add ice9.

2008-10-11  Maxim Kuvyrkov  <maxim@codesourcery.com>

	M68K NPTL support.
	gas/
	* config/tc-m68k.c (m68k_elf_cons): New static function.
	(md_pseudo_table): Use it.
	(md_apply_fix): Fix to set thread local flag.
	(m68k_elf_suffix): New static function; helper for m68k_elf_cons.

	gas/testsuite/
	* gas/m68k/tls-1.s: Remove.

	bfd/
	* elf32-m68k.c: Handle 2-slot GOT entries.  Rename variables and
	fields from n_entries to n_slots where appropriate, update comments.
	(struct elf_m68k_got_entry.type): Move field to ...
	(struct elf_m68k_got_entry_key): ... here.  Update all uses.
	(struct elf_m68k_got): Update comments.
	(elf_m68k_reloc_got_tls_p): Rename to elf_m68k_reloc_tls_p, handle
	all relocations.  Update all uses.
	(elf_m68k_init_got, elf_m68k_init_got_entry_key): Update.
	(elf_m68k_got_entry_hash, elf_m68k_got_entry_eq): Update,
	handle key->type.
	(ELF_M68K_REL_8O_MAX_N_ENTRIES_IN_GOT): Update name, update all uses.
	(ELF_M68K_REL_8O_16O_MAX_N_ENTRIES_IN_GOT): Same.
	(elf_m68k_get_got_entry, elf_m68k_update_got_entry_type): Update.
	(elf_m68k_remove_got_entry_type, elf_m68k_add_entry_to_got): Update.
	(elf_m68k_can_merge_gots_1, elf_m68k_can_merge_gots): Update.
	(elf_m68k_merge_gots_1, elf_m68k_merge_gots): Update.
	(struct elf_m68k_finalize_got_offsets_arg: n_ldm_entries): New field.
	(elf_m68k_finalize_got_offsets_1, elf_m68k_finalize_got_offsets):
	Update, handle TLS_LDM entries.
	(struct elf_m68k_partition_multi_got_arg): Add slots_relas_diff
	field, remove obsoleted local_n_entries field.
	(elf_m68k_partition_multi_got_2): New static function.
	(elf_m68k_partition_multi_got_1, elf_m68k_partition_multi_got): Use it,
	update.
	(elf_m68k_remove_got_entry): Update.
	(elf_m68k_install_rela, dtpoff_base, tpoff): New static functions.
	(elf_m68k_relocate_section, elf_m68k_finish_dynamic_symbol):
	Handle TLS relocations.

	ld/testsuite/
	* ld-m68k/tls-gd-1.d, ld-m68k/tls-gd-2.d, ld-m68k/tls-gd-3.d:
	New tests.
	* ld-m68k/tls-gd-ie-1.d, ld-m68k/tls-ie-1.d: New tests.
	* ld-m68k/tls-ld-1.d, ld-m68k/tls-ld-2.d: New tests.
	* ld-m68k/tls-ld-1.s, ld-m68k/tls-ld-2.s, ld-m68k/tls-le-1.s:
	New test sources.
	* ld-m68k/tls-no-1.s, ld-m68k/tls-gd-ie-1.s, ld-m68k/tls-gd-1.s:
	New test sources.
	* ld-m68k/tls-gd-2.s, ld-m68k/tls-gd-3.s, ld-m68k/tls-ie-1.s:
	New test sources.
	* ld-m68k/m68k.exp: Run new tests.

2008-10-10  Nathan Froyd  <froydnj@codesourcery.com>

	binutils/
	* readelf.c (display_mips_gnu_attribute): Move Power-specific
	block of code...
	(display_power_gnu_attribute): ...here.  Oops.

2008-10-10  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #3928

	Backport:

	include/elf/
	2008-10-10  Nathan Froyd  <froydnj@codesourcery.com>
	* ppc.h: Add Tag_GNU_Power_ABI_Struct_Return.

	bfd/
	2008-10-10  Nathan Froyd  <froydnj@codesourcery.com>
	* elf32-ppc.c (ppc_elf_merge_obj_attributes): Merge
	Tag_GNU_Power_ABI_Struct_Return.

	binutils/
	2008-10-10  Nathan Froyd  <froydnj@codesourcery.com>
	* readelf.c (display_power_gnu_attribute): Decode
	Tag_GNU_Power_ABI_Struct_Return.

	ld/testsuite/
	2008-10-10  Nathan Froyd  <froydnj@codesourcery.com>
	* ld-powerpc/gnu-attr-12-1.s: New file.
	* ld-powerpc/gnu-attr-12-2.s: New file.
	* ld-powerpc/gnu-attr-12-11.d: New file.
	* ld-powerpc/gnu-attr-12-21.d: New file.
	* ld-powerpc/powerpc.exp: Run new dump tests.


2008-10-09  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* coff64-rs6000.c (rs6000coff64_vec, aix5coff64_vec): Add
	copy_link_hash_symbol_type initializers.

2008-10-09  Joseph Myers  <joseph@codesourcery.com>

	Backport:

	bfd/
	2008-02-17  Mark Kettenis  <kettenis@gnu.org>
	* elf.c (swap_out_syms): Avoid preprocessing directive within
	macro arg.

2008-10-03  Kazu Hirata  <kazu@codesourcery.com>

	Issue 1365
	gas/
	* listing.c (buffer_line): Open the source file with FOPEN_RB.
	Manually process line ends.

	* release-notes-csl.xml: Add a release note about the
	assembler bug.

2008-09-26  Julian Brown  <julian@codesourcery.com>

	* release-notes-csl.xml (Mixed-case NEON register aliases): Add note.

2008-09-25  Maciej W. Rozycki  <macro@codesourcery.com>

	Issue #3634
	gas/testsuite/
	* gas/mips/mips.exp: Move the "ice9a" test to the target
	section.

2008-09-25  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* libbfd-in.h (_bfd_nolink_bfd_copy_link_hash_symbol_type):
	Define.
	* libbfd.h: Regenerate.

2008-09-25  Julian Brown  <julian@codesourcery.com>

	Issue #3893

	gas/
	* config/tc-arm.c (create_neon_reg_alias): Fix case-sensitivity for
	Neon register aliases.

2008-09-17  Catherine Moore  <clm@codesourcery.com>

	gas/
	* config/tc-arm.c (aeabi_set_public_attributes): Fix setting
	of attribute 12 for neon fpus.  Set attributes 36 and 38 for
	neon-fp16 fpus.

	binutils/
	* readelf.c (arm_attr_tag_ABI_FP_16bit_format): New.
	(arm_attr_tag_VFP_HP_extension): New.
	(arm_attr_public_tag arm_attr_public_tags): Support new
	attributes.

	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Merge
	half-precision attributes.
	(elf32_arm_copy_one_eabi_other_attribute): New.
	(elf32_arm_copy_other_attribute_list): New.

2008-09-24  Andrew Stubbs  <ams@codesourcery.com>

	Issue #3598

	* release-notes-csl.xml: Document.

	bfd/
	* elf.c (elf_fake_sections): Find the signature symbol for
	SHT_GROUP sections when doing objcopy/strip.

2008-09-24  Joseph Myers  <joseph@codesourcery.com>

	ld/
	* emulparams/elf64ppc.sh (OTHER_GOT_RELOC_SECTIONS): Add .rela.opd
	and .rela.branch_lt.

2008-09-13  Maciej W. Rozycki  <macro@codesourcery.com>
            Daniel Gutson  <daniel@codesourcery.com>

	Issue #3634
	gas/
	* config/tc-mips.c (ICE9A_MOVNDS): New macro.
	(MAX_NOPS): Rename to...
	(MAX_HIST_INSNS): ... this.  Adjust references and comments
	accordingly.
	(mips_fix_ice9a): New variable.
	(ice9a_fp_stall_hazard_p): New function.
	(ice9a_fp_round_hazard_p): New function.
	(ice9a_movnd_workaround_p): Likewise.
	(ice9a_insn_accesses_f30_p): Likewise.
	(check_for_ice9a): Likewise.
	(mips_cleanup): Likewise.
	(nops_for_insn): Call check_for_ice9a().
	(OPTION_FIX_ICE9A): New macro.
	(OPTION_NO_FIX_ICE9A): Likewise.
	(OPTION_MISC_BASE): Adjust accordingly.
	(md_longopts): Add "mfix-ice9a" and "mno-fix-ice9a".
	(md_parse_option): Handle OPTION_FIX_ICE9A and
	OPTION_NO_FIX_ICE9A.
	(md_show_usage): Document "-mfix-ice9a".
	* config/tc-mips.h (mips_cleanup): New declaration.
	(md_cleanup): New macro.
	* doc/c-mips.texi (MIPS Opts): Document "-mfix-ice9a" and
	"-mno-fix-ice9a".
	* doc/as.texinfo (Target MIPS options): Likewise.

	gas/testsuite/
	* gas/mips/ice9a.l: New test for the "-mfix-ice9a" option.
	* gas/mips/ice9a.s: Source for the new test.
	* gas/mips/mips.exp: Run the new test.

2008-09-22  Catherine Moore  <clm@codesourcery.com>

	Issue #3806
	* release-notes-csl.xml: Document.

2008-09-22  Catherine Moore  <clm@codesourcery.com>

	Issue #3806
	bfd/
	* elfxx-mips.c (allocate_dynrelocs): Avoid a copy_reloc if
	dynamic sections have not been created.

2008-09-13  Catherine Moore  <clm@codesourcery.com>

	gas/testsuite/
	* gas/arm/half-prec-neon.d: New.
	* gas/arm/half-prec-neon.s: New.
	* gas/arm/half-prec-vfp3.d: New.
	* gas/arm/half-prec-vfp3.s: New.
	* gas/arm/half-prec-psyntax.d: New.
	* gas/arm/half-prec-psyntax.s: New.

	gas/
	* config/tc-arm.c (neon_type_mask): Renumber.
	(type_chk_of_el_type): Handle F_F16.
	(neon_cvt_flavour): Recognize half-precision conversions.
	(do_neon_cvt): New shapes NS_QD and NS_DQ.  Encode half-precision
	conversions.
	(do_neon_cvtt): Encode the T bit.
	(asm_opcode_insns): vcvt, vcvtt support.
	(arm_option_cpu_value): Add neon-fp16 support.

        include/
	* opcode/arm.h (FPU_NEON_FP16): New.
	(FPU_ARCH_NEON_FP16): New.
	* elf/arm.h (Tag_ABI_FP_16bit_format): Define.

	opcodes/
        * arm-dis.c (coprocessor_opcodes): Add half-precision vcvt
	instructions.
	(neon_opcodes): Likewise.
	(print_insn_coprocessor): Print 't' or 'b' for
	vcvt instructions.

2008-09-10  Mark Mitchell  <mark@codesourcery.com>

	* release-notes-csl.xml: Mention recent improvements.

2008-09-09  Mark Mitchell  <mark@codesourcery.com>

	Issue #2882
	gas/
	* config/tc-arm.c (BAD_SP): Define.
	(s_arm_unwind_fnstart): Use REG_SP.
	(s_arm_unwind_setfp): Likewise.
	(reject_bad_reg): New macro.
	(do_co_reg): Check for bad registers.
	(do_co_reg2c): Likewise.
	(do_srs): Use REG_SP.
	(do_t_add_sub): Check for bad registers.
	(do_t_adr): Likewise.
	(do_t_arit3): Likewise.
	(do_t_arit3c): Likewise.
	(do_t_bfc): Likewise.
	(do_t_bfi): Likewise.
	(do_t_bfx): Likewise.
	(do_t_blx): Likewise.
	(do_t_bx): Likewise.
	(do_t_bxj): Likewise.
	(do_t_clz): Likewise.
	(do_t_div): Likewise.
	(do_t_mla): Likewise.
	(do_t_mlal): Likewise.
	(do_t_mov_cmp): Likewise.
	(do_t_mov16): Likewise.
	(do_t_mvn_tst): Likewise.
	(do_t_mrs): Likewise.
	(do_t_msr): Likewise.
	(do_t_mul): Likewise.
	(do_t_mull): Likewise.
	(do_t_orn): Likewise.
	(do_t_pkhbt): Likewise.
	(do_t_pld): Likewise.
	(do_t_rbit): Likewise.
	(do_t_rev): Likewise.
	(do_t_rrx): Likewise.
	(do_t_rsb): Likewise.
	(do_t_shift): Likewise.
	(do_t_simd): Likewise.
	(do_t_ssat): Likewise.
	(do_t_ssat16): Likewise.
	(do_t_sxtah): Likewise.
	(do_t_sxth): Likewise.
	(do_t_tb): Likewise.
	(do_t_usat): Likewise.
	(do_t_usat16): Likewise.
	(nysn_insert_sp): Use REG_SP.
	gas/testsuite/
	* gas/arm/copro.s: Avoid using r15 where not permitted.
	* gas/arm/copro.d: Adjust accordingly.
	* gas/arm/thumb2_bad_reg.s: New.
	* gas/arm/thumb2_bad_reg.l: Likewise.
	* gas/arm/thumb2_bad_reg.d: Likewise.

2008-09-10  Maxim Kuvyrkov  <maxim@codesourcery.com>

	gas/testsuite/
	* gas/m68k/br-isac.d: Fix whitespace.

2008-09-09  Mark Mitchell  <mark@codesourcery.com>

	gas/
	* config/tc-arm.c (do_t_orn): New function.
	(do_t_rrx): Likewise.
	(insns): Add orn and rrx.
	gas/testsuite/
	* gas/arm/thumb32.s: Add tests for orn and rrx.
	* gas/arm/thumb32.d: Adjust accordingly.
	* gas/arm/thumb32.l: Likewise.
	* gas/arm/thumb2_invert.s: Add tests for orn and orr.
	* gas/arm/thumb2_invert.d: Adjust accordingly.
	* gas/arm/tcompat.s: Add tests for rrx.
	* gas/arm/tcompat.d: Adjust accordingly.

2008-09-09  Mark Mitchell  <mark@codesourcery.com>

	gas/
	* config/tc-arm.c (insns): Add qasx, qsax, shasx, shsax, ssax,
	uasx, uhasx, uhsx, uqasx, uqsax, usax. 
	gas/testsuite/
	* gas/arm/thumb32.s (qadd): Add tests for them.
	* gas/arm/thumb32.d: Adjust accordingly.

2008-09-09  Mark Mitchell  <mark@codesourcery.com>

	gas/
	* config/tc-arm.c (insns): Correct encoding of qadd, qdadd, qsub,
	qdsub in Thumb-2 mode.
	opcodes/
	* arm-dis.c (thumb32_opcodes): Correct decoding for qadd, qdadd,
	qsub, and qdsub.
	gas/testsuite/
	* gas/arm/thumb32.s (qadd): Add qadd, qdadd, qsub, and qdsub.
	* gas/arm/thumb32.d: Likewise.

2008-09-09  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #3318
	ld/testsuite/
	* ld-arm/mixed-lib.d, ld-arm/armthumb-lib.d: Loosen regexp.

2008-09-08  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #2348, #3206

	* release-notes-csl.xml: Add release note for DWARF 3 support.

	Backport from mainline:

	bfd/
	2008-09-08  H.J. Lu  <hongjiu.lu@intel.com>
		    Daniel Jacobowitz  <dan@codesourcery.com>

	PR ld/3191
	* dwarf2.c (struct adjusted_section): Renamed from struct
	loadable_section.
	(struct dwarf2_debug): Adjust for renaming.  Add version field.
	(read_attribute_value): Correctly handle DW_FORM_ref_addr for
	DWARF3.
	(find_abstract_instance_name): Pass a pointer to
	attribute instead of offset.  For DW_FORM_ref_addr, get the
	entry at the offset from the .debug_info section.
	(scan_unit_for_symbols): Update.
	(parse_comp_unit): Allow DWARF3.  Save the version.
	(unset_sections): Update for renaming.
	(place_sections): Likewise.  Set new VMAs for DWARF sections
	also.

2008-09-08  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* doc/c-arm.texi (ARM Directives): Document .2byte, .4byte,
	.8byte, .bss, .even, .extend, .ldouble, .packed, .secrel32
	directives.

2008-09-06  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/m68k-parse.h (CPUCR): New register name.
	* config/tc-m68k.c (mcf51qe_ctrl): Rename to ...
	(mcf51_ctrl): ... here.  Add CPUCR.
	(mcf52259_ctrl, mcf53017_ctrl): New.
	(mcf5307_ctrl): Reorder canonically.
	(m68k_cpus): Add 51, 51ac, 51cn, 51em, 5225x, 5301x.
	(m68k_ip): Add CPUCR case.
	(init_table): Add CPUCR.

	opcodes/
	* m68k-opc.c (m68k_opcodes): Add stldsr insn.

	gas/testsuite/
	* gas/m68k/br-isac.s: Add stldsr test case
	* gas/m68k/br-isac.d: Add stldsr test case

2008-09-05  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #1441
	* release-notes-csl.xml: Copy note for issue #2963.

	Issue #3213
	gprof/
	2004-09-07  David Ung  <davidu@mips.com>
	* hist.c (hist_read_rec):  Load profiling rate into hz_int.
	(hist_write_hist): Write hz_int into file.
	(print_header): Adjust header for total_time >= 100000.
	(print_line): Use wider fields it total_time >= 100000.
	(hist_print): Skip excluded symbols when finding the highest
	execution time in order to calculate the scaling factor. 
	* gprof.h (hz): Now optionally a floating-point variable.
	(hz_int): New variable, always integral.
	* gprof.c (hz): Now optionally a floating-point variable.
	(hz_int): New variable, always integral.
	* gmon_io.c (gmon_out_read): Load profiling rate initially into
	hz_int, not hz. Finally convert hz_int into floating-point hz
	variable, where a negative hz_int is converted to a reciprocal to
	handle cycles/count instead of counts/sec.
	(gmon_out_write): Write hz_int to file, not hz.
	* cg_print.c: (child_max): New variable to store maximum time
	value. 
	(self_wid): New var to hold width of self time field in report.
	(child_wid): New var to hold width of child time field.
	(prec): New var to hold precision of time fields.
	(print_header): Adjust headers for wider fields.
	(print_cycle): Use child_wid, self_wid and prec to format output. 
	(print_members): Similarly.
	(print_parents): Similarly.
	(print_children): Similarly.
	(print_line): Similarly.
	(cg_print): Find maximum child time, then determine child/self
	field widths and precision to cope with times >= 100000.

2008-09-05  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* doc/c-arm.texi (ARM Directives): Alphabetize.

2008-09-05  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #1737
	gas/
	* doc/c-arm.texi (): Document -mwarn-deprecated.
	* config/tc-arm.c (WARN_DEPRECATED): Remove.  Replace with ...
	(warn_on_deprecated): ... this.
	(opcode_lookup, md_assemble): Check it before warning.
	(arm_opts): Add m[no-]warn-deprecated.
	(md_parse_option): Replace WARN_DEPRECATED with
	warn_on_deprecated.

2008-09-05  Daniel Jacobowitz  <dan@codesourcery.com>

	Backport from mainline:

	binutils/
	2008-09-05  Daniel Jacobowitz  <dan@codesourcery.com>

	* readelf.c (load_specific_debug_section): New function, from
	load_debug_section.
	(load_debug_section): Use load_specific_debug_section.
	(display_debug_section): Use load_specific_debug_section.  Check for
	multiple sections with the same name.

2008-09-04  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #3213
	gprof/
	Format changes extracted from David Ung's histogram patch.
	* cg_print.c (print_header, print_line): Fix formatting.
	* hist.c (read_histogram_header, hist_read_rec, hist_print,
	find_histogram_for_pc): Likewise.

2008-09-03  Nathan Froyd  <froydnj@codesourcery.com>

	Issue #3614

	bfd/
	* elf32-ppc.c (ppc_elf_relocate_section): Continue processing
	relocations if the output section is NULL; this guards against
	relocations against global undefined symbols bombing out.

2008-09-02  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #3213
	gprof/
	2005-10-12  Nigel Stephens  <nigel@mips.com>
	* mips.c (mips_find_call): Traverse MIPS16 functions, identifiable
	by an odd address. Indicate in debug message when we're
	traversing a mips16 function.
	(mips_find_call): Use "restore" as end of function marker, not
	"save".
	* corefile.c (core_init): Set min_insn_size to 2 for MIPS.
	(core_create_function_syms): Make the address of MIPS16 symbols
	odd in the gprof symbol table, since after this point we can't
	access the original bfd symbol information.

2008-08-29  Julian Brown  <julian@codesourcery.com>

	ld/
	* ld.texinfo (--fix-janus-2cc): Document new option.

	bfd/
	* elf32-arm.c (bfd_elf32_arm_janus_2cc_erratum_scan): Use correct
	insn when checking for PC operand.

2008-08-28  Julian Brown  <julian@codesourcery.com>

	ld/
	* emultempl/armelf.em (fix_janus_2cc): New variable.
	(arm_elf_before_allocation): Call
	bfd_elf32_arm_validate_janus_2cc_fix and
	bfd_elf32_arm_janus_2cc_erratum_scan.
	(arm_elf_after_allocation): Call bfd_elf32_arm_fix_veneer_locations
	not bfd_elf32_arm_vfp11_fix_veneer_locations.
	(arm_elf_create_output_section_statements): Add fix_janus_2cc
	argument.
	(PARSE_AND_LIST_PROLOGUE): Add OPTION_FIX_JANUS_2CC.
	(PARSE_AND_LIST_LONGOPTS): Add fix-janus-2cc option.
	(PARSE_AND_LIST_OPTIONS): Likewise. (PARSE_AND_LIST_CASES): Add
	OPTION_FIX_JANUS_2CC case.
	* emulparams/armelf.sh (OTHER_TEXT_SECTIONS): Add .janus_2cc_veneer
	section.

	bfd/
	* bfd-in.h (bfd_elf32_arm_validate_janus_2cc_fix): Add prototype.
	(bfd_elf32_arm_janus_2cc_erratum_scan): Add prototype.
	(bfd_elf32_arm_vfp11_fix_veneer_locations): Rename to...
	(bfd_elf32_arm_fix_veneer_locations): This.
	(bfd_elf32_arm_set_target_relocs): Update prototype.
	* bfd-in2.h: Regenerate.
	* elf32-arm.c (VFP11_ERRATUM_VENEER_ENTRY_NAME): Adjust format.
	(JANUS_2CC_ERRATUM_VENEER_SECTION_NAME)
	(JANUS_2CC_ERRATUM_VENEER_ENTRY_NAME, MAX_ERRATUM_SYMBOL_LENGTH):
	New macros.
	(elf32_vfp11_erratum_type): Rename to...
	(elf32_cpu_erratum_type): This. Add Janus 2CC entries.
	(elf32_vfp11_erratum_list): Rename to...
	(elf32_cpu_erratum_list): This. Rename vfp_insn field to orig_insn.
	(_arm_elf_section_data): Update type of erratumlist field.
	(elf32_arm_link_hash_table): Add janus_2cc_erratum_glue_size,
	fix_janus_2cc fields. Rename num_vfp11_fixes to num_errata_fixes.
	(elf32_arm_link_hash_table_create): Initialise above fields.
	(JANUS_2CC_ERRATUM_VENEER_SIZE): New macro.
	(bfd_elf32_arm_allocate_interworking_sections): Initialise Janus
	2CC erratum veneer section.
	(record_vfp11_erratum_veneer): Rename to...
	(record_cpu_erratum_veneer): This. Add argument for type of erratum
	to record. Expand to handle Janus 2CC erratum.
	(bfd_elf32_arm_add_glue_sections_to_bfd): Make Janus 2CC erratum
	veneer section.
	(bfd_elf32_arm_validate_janus_2cc_fix): New.
	(bfd_elf32_arm_vfp11_erratum_scan): Update for new type and field
	names. Call record_cpu_erratum_veneer instead of
	record_vfp11_erratum_veneer.
	(bfd_elf32_arm_vfp11_fix_veneer_locations): Rename to...
	(bfd_elf32_arm_fix_veneer_locations): This. Add Janus 2CC erratum
	support.
	(bfd_elf32_arm_janus_2cc_erratum_scan): New.
	(bfd_elf32_arm_set_target_relocs): Add fix_janus_2cc option. Handle.
	(elf32_arm_size_dynamic_sections): Call
	bfd_elf32_arm_janus_2cc_erratum_scan.
	(elf32_arm_write_section): Add Janus 2CC erratum support.

2008-08-21  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (mcf52277_ctrl): New.
	(m68k_cpus): Add 52274, 52277.

2008-08-17  Catherine Moore  <clm@codesourcery.com>

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_final_link): Write out the
	non-pic to pic stubs. 

2008-08-08  Catherine Moore  <clm@codesourcery.com>

	opcodes/
	* mips-opc.c (jalx): Allow for ISA1 and above.

	gas/
	* testsuite/gas/mips/mips-no-jalx.l: Remove.
	* testsuite/gas/mips/mips-no-jalx.s: Remove.
	* testsuite/gas/mips/mips.exp: Remove invocation of mips-no-jalx.


2008-08-03  Catherine Moore  <clm@codesourcery.com>

	* release-notes-csl.xml:  Add missing "/" to <formalpara>.
	Change csl-target to csl_target.  Change mips*- to mips*-*.

2008-07-31  Kazu Hirata  <kazu@codesourcery.com>

	Backport from mainline:
	binutils/
	2008-04-28  M Thomas  <mthomas@rhrk.uni-kl.de>
		    Nick Clifton  <nickc@redhat.com>

	PR binutils/6449
	* objdump.c (slurp_file): Open the file in binary mode.
	* ar.c: Remove conditional definition of O_BINARY.
	* bin2.c: Likewise.
	* rename.c: Likewise.
	* strings.c: Likewise.
	* sysdep.h: Add conditional definition of O_BINARY.

2008-07-29  Paul Brook  <paul@codesourcery.com>
	    Mark Mitchell  <mark@codesourcery.com>

	gas/
	* config/tc-arm.c (do_t_mul): In Thumb-2 mode, use 16-bit encoding
	of MUL when possible.
	gas/testsuite/
	* gas/arm/thumb2_mul.s: New file.
	* gas/arm/thumb2_mul.d: Likewise.
	* gas/arm/thumb2_mul-bad.s: Likewise.
	* gas/arm/thumb2_mul-bad.d: Likewise.
	* gas/arm/thumb2_mul-bad.l: Likewise.
	* gas/arm/t16-bad.s: Add tests for"mul" with high registers.
	* gas/arm/t16-bad.l: Update accordingly.

	* release-notes-csl.xml: Document.

2008-07-28  Catherine Moore  <clm@codesourcery.com>

	Issue #3380
	* release-notes-csl.xml: Document.
	
	Issue #3166
	* release-notes-csl.xml: Document.

2008-07-28  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #3380
	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Avoid generating
	relocations for undefined weak symbols with non-default visibility.
	(_bfd_mips_elf_check_relocs): Use possibly_dynamic_relocs for
	global symbols in shared libraries.
	(allocate_dynrelocs): New function.
	(_bfd_mips_elf_adjust_dynamic_symbol): Do not handle
	possibly_dynamic_relocs here.
	(_bfd_mips_elf_size_dynamic_sections): Call allocate_dynrelocs.

2008-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>

	ld/testsuite/
	* ld-m68k/got-multigot-12-13-14-34-35-ok.d: Update.
	* ld-m68k/got-multigot-14-ok.d: Update.
	* ld-m68k/m68k.exp: Update.
	* ld-m68k/got-negative-12-13-14-34-ok.d: Update.
	* ld-m68k/got-negative-14-ok.d: Update.

	gas/testsuite/
	* gas/m68k/tls-1.s: New.

	gas/
	* config/m68k-parse.h (enum pic_relocation): Add values for TLS
	relocations.
	* config/m68k-parse.y (yylex): Parse TLS relocations.
	* config/tc-m68k.c (get_reloc_code, tc_m68k_fix_adjustable)
	(tc_gen_reloc): Handle TLS relocations.

	include/elf/
	* m68k.h: Map TLS relocations to numbers.

	bfd/
	* bfd-in2.h: Regenerate.
	* elf32-m68k.c (HOWTO): Add TLS relocations.
	(reloc_map): Map BFD_RELOC_68K_TLS_* to R_68K_TLS_*.
	(enum elf_m68k_got_offset_size): New enum.
	(struct elf_m68k_got_entry: type) Move from nested union up.
	(elf_m68k_reloc_got_type, elf_m68k_reloc_got_offset_size)
	(elf_m68k_reloc_got_n_entries, elf_m68k_reloc_got_tls_p): New static
	functions.
	(struct elf_m68k_got): merge rel_8o_n_entries and rel_8o_16o_n_entries
	fields into n_entries array.
	(elf_m68k_init_got): Simplify, update all uses.
	(elf_m68k_init_got_entry_key): Handle R_68K_TLS_LDM32 reloc.
	(ELF_M68K_REL_8O_MAX_N_ENTRIES_IN_GOT)
	(ELF_M68K_REL_8O_16O_MAX_N_ENTRIES_IN_GOT): Adjust to handle 2-slot
	GOT entries.
	(elf_m68k_get_got_entry): Update.
	(elf_m68k_update_got_entry_type): Rewrite to handle TLS GOT entries,
	simplify.
	(elf_m68k_remove_got_entry_type): Simplify.
	(elf_m68k_add_entry_to_got, elf_m68k_can_merge_gots_1)
	(elf_m68k_can_merge_gots): Update.
	(struct elf_m68k_finalize_got_offsets_arg)
	(elf_m68k_finalize_got_offsets_1, elf_m68k_finalize_got_offsets):
	Rewrite to handle 2-slot GOT entries, simplify.
	(elf_m68k_partition_multi_got_1, elf_m68k_partition_multi_got): Update.
	(elf_m68k_remove_got_entry_type): Update.
	(elf_m68k_check_relocs): Handle TLS relocations.  Remove unnecessary 
	update of sgot->size and srelgot->size.
	(elf_m68k_gc_sweep_hook): Update.
	(elf_m68k_relocate_section): Add dummy handling of TLS relocations.
	* reloc.c (BFD_RELOC_68K_TLS_*): Declare TLS relocations.
	* libbfd.h (bfd_reloc_code_real_names): Add BFD_RELOC_68K_TLS_*.

2008-07-27  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/
	* elf32-m68k.c: Apply cosmetic differences from FSF mainline.

2008-07-26  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Backport:

	ld/testsuite/
	2008-07-11  H.J. Lu  <hongjiu.lu@intel.com>
	
	* ld-m68k/got-12.s: Removed.
	* ld-m68k/got-13.s: Likewise.
	* ld-m68k/got-14.s: Likewise.
	* ld-m68k/got-15.s: Likewise.
	* ld-m68k/got-34.s: Likewise.
	* ld-m68k/got-35.s: Likewise.
	* ld-m68k/xgot-15.s: Likewise.

	* ld-m68k/got-multigot-12-13-14-34-35-ok.d: Remove #source
	and expected relocations.
	* ld-m68k/got-multigot-14-ok.d: Likewise.
	* ld-m68k/got-negative-12-13-14-34-ok.d: Likewise.
	* ld-m68k/got-negative-14-ok.d: Likewise.
	* ld-m68k/got-single-12-ok.d: Likewise.
	* ld-m68k/got-xgot-12-13-14-15-34-35-ok.d: Likewise.
	* ld-m68k/got-xgot-15-ok.d: Likewise.

	* ld-m68k/got-multigot-15-er.d: Remove #source.
	* ld-m68k/got-negative-12-13-14-35-er.d: Likewise.
	* ld-m68k/got-negative-15-er.d: Likewise.
	* ld-m68k/got-single-13-er.d: Likewise.

	* ld-m68k/m68k.exp: Move GOT tests to ...
	* ld-m68k/m68k-got.exp: This.  New.

2008-07-26  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Backport:

	bfd/
	2008-06-29  Andreas Schwab  <schwab@suse.de>
	* elf32-m68k.c (elf_m68k_relocate_section): Don't ignore existing
	addend on _GLOBAL_OFFSET_TABLE_.

	ld/testsuite/
	2008-06-29  Andreas Schwab  <schwab@suse.de>
	* ld-m68k/got-1.s: New file.
	* ld-m68k/got-1.d: New dump test.
	* ld-m68k/m68k.exp: Run it.

2008-07-24  Joseph Myers  <joseph@codesourcery.com>

	* config.sub: Allow mips64octeon* targets.

	NOT ASSIGNED TO FSF
	COPYRIGHT CAVIUM
	bfd/
	* config.bfd: Handle mips64octeon*-*-elf*.

	gas/
	* configure.tgt: Handle mips-wrs-elf*.

	ld/
	* configure.tgt: Handle mips64octeon*-*-elf*.
	* Makefile.am (ALL_EMULATIONS): Add Octeon emulations.
	(eelf32ebocteon.c, eelf32elocteon.c, eelf32ebocteonn32.c,
	eelf32elocteonn32.c, eelf64ebocteon.c, eelf64elocteon.c): New.
	* Makefile.in: Regenerate.
	* scripttempl/elf.sc: Add ${OCTEON_SPECIAL_SECTIONS}.
	* emulparams/elf32ebocteon.sh, emulparams/elf32ebocteonn32.sh,
	emulparams/elf32elocteon.sh, emulparams/elf32elocteonn32.sh,
	emulparams/elf64ebocteon.sh, emulparams/elf64elocteon.sh,
	emultempl/octeonelf.em: New.

2008-07-18  Joseph Myers  <joseph@codesourcery.com>

	Backport:

	bfd/
	2008-07-18  Joseph Myers  <joseph@codesourcery.com>
	* bfd-in.h (bfd_elf32_arm_set_target_relocs): Add new parameter.
	* bfd-in2.h: Regenerate.
	* elf32-arm.c (struct elf_arm_obj_tdata): Add field
	no_wchar_size_warning.
	(bfd_elf32_arm_set_target_relocs): Add new parameter
	no_wchar_warn.
	(elf32_arm_merge_eabi_attributes): Give a warning, not an error,
	for conflicting wchar_t attributes.  Do not warn if
	--no-wchar-size-warning.  Make diagnostic text more specific.

	ld/
	2008-07-18  Joseph Myers  <joseph@codesourcery.com>
	* ld.texinfo (--no-wchar-size-warning): Document new ARM option.
	* emultempl/armelf.em (no_wchar_size_warning): New.
	(arm_elf_create_output_section_statements): Pass
	no_wchar_size_warning to arm_elf_create_output_section_statements.
	(OPTION_NO_WCHAR_SIZE_WARNING): New.
	(PARSE_AND_LIST_LONGOPTS): Add no-wchar-size-warning.
	(PARSE_AND_LIST_OPTIONS): List --no-wchar-size-warning.
	(PARSE_AND_LIST_ARGS_CASES): Handle --no-wchar-size-warning.

	ld/testsuite/
	2008-07-18  Joseph Myers  <joseph@codesourcery.com>
	* ld-arm/attr-merge-wchar-0.s,ld-arm/attr-merge-wchar-2.s,
	ld-arm/attr-merge-wchar-4.s, ld-arm/attr-merge-wchar-00-nowarn.d,
	ld-arm/attr-merge-wchar-00.d, ld-arm/attr-merge-wchar-02-nowarn.d,
	ld-arm/attr-merge-wchar-02.d, ld-arm/attr-merge-wchar-04-nowarn.d,
	ld-arm/attr-merge-wchar-04.d, ld-arm/attr-merge-wchar-20-nowarn.d,
	ld-arm/attr-merge-wchar-20.d, ld-arm/attr-merge-wchar-22-nowarn.d,
	ld-arm/attr-merge-wchar-22.d, ld-arm/attr-merge-wchar-24-nowarn.d,
	ld-arm/attr-merge-wchar-24.d, ld-arm/attr-merge-wchar-40-nowarn.d,
	ld-arm/attr-merge-wchar-40.d, ld-arm/attr-merge-wchar-42-nowarn.d,
	ld-arm/attr-merge-wchar-42.d, ld-arm/attr-merge-wchar-44-nowarn.d,
	ld-arm/attr-merge-wchar-44.d: New.
	* ld-arm/arm-elf.exp: Run new tests.

2008-07-10  Joseph Myers  <joseph@codesourcery.com>

	config/
	* mh-mingw (LDFLAGS): Append to rather than replacing previous
	value.

2008-07-08  Stan Shebs  <stan@codesourcery.com>

	BE8 disassembly.
	include/
        * dis-asm.h (struct disassemble_info): Add endian_code field.
	opcodes/
        * dis-init.c (init_disassemble_info): Init endian_code field.
	* arm-dis.c (print_insn): Disassemble code according to
        setting of endian_code.
	(print_insn_big_arm): Detect when BE8 extension flag has been set.
	ld/testsuite/
        * ld-arm/arm-elf.exp: Use objdump -d for arm-be8 test.
	* ld-arm/arm-be8.d: Change to test disassembly.

2008-07-02  Joseph Myers  <joseph@codesourcery.com>

	ld/
	* ld.h (args_type): Add error_poison_system_directories.
	* ld.texinfo (--error-poison-system-directories): Document.
	* ldfile.c (ldfile_add_library_path): Check
	command_line.error_poison_system_directories.
	* ldmain.c (main): Initialize
	command_line.error_poison_system_directories.
	* lexsup.c (enum option_values): Add
	OPTION_ERROR_POISON_SYSTEM_DIRECTORIES.
	(ld_options): Add --error-poison-system-directories.
	(parse_args): Handle new option.	

2008-06-30  Joseph Myers  <joseph@codesourcery.com>

	config/
	* mh-mingw (BOOT_CFLAGS): Do not use -D__USE_MINGW_ACCESS.

2008-06-14  Catherine Moore  <clm@codesourcery.com>

	Issue #3166
	bfd/
	* elfxx-mips.c (bfd_mips_elf_maybe_create_non_pic_to_pic_stubs_section):
	Set SEC_LINKER_CREATED for the stub section.

2008-06-09  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	bfd/
	* elf32-arm.c (elf32_arm_merge_private_bfd_data): Allow BE8 shared
	libraries.

2008-06-06  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	bfd/
	* elf32-arm.c (elf32_arm_merge_private_bfd_data): Reject BE8 input.

2008-06-03  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (do_t_rbit): Populate both rm fields.
	gas/testsuite/
	* gas/arm/thumb32.d: Update expected output.

2008-06-02  Nathan Froyd  <froydnj@codesourcery.com>

	ld/testsuite/
	* ld-scripts/rgn-over8.s: Use .section .bss instead of .bss.

2008-05-23  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (arm_fix_adjustable): Don't adjust MOVW/MOVT
	relocations.

	gas/testsuite/
	* gas/arm/movw-local.d: New test.
	* gas/arm/movw-local.s: New test.

2008-05-23  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (parse_cond): Covert to lowercase before matching.

2008-05-20  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from mainline:
	
	2008-03-31  Edmar Wienskoski  <edmar@freescale.com>
	bfd/
        * archures.c: Add bfd_mach_ppc_e500mc.
        * bfd-in2.h: Regenerate.

	gas/
        * config/tc-ppc.c (parse_cpu): Handle "e500mc". Extend "e500" to
        accept e500mc instructions.
        (md_show_usage): Document -me500mc.

	gas/testsuite/
        * gas/ppc/e500mc.s, gas/ppc/e500mc.d: New test.
        * gas/ppc/ppc.exp: Run the new test

	include/opcode/
        * ppc.h: (PPC_OPCODE_E500MC): New.

	opcodes/
        * ppc-dis.c (powerpc_dialect): Handle "e500mc". Extend "e500" to
        accept Power E500MC instructions.
        (print_ppc_disassembler_options): Document -Me500mc.
        * ppc-opc.c: (DUIS, DUI, T): New.
        (XRT, XRTRA): Likewise.
        (E500MC): Likewise.
        (powerpc_opcodes): Add new Power E500MC instructions.

2008-05-15  Nathan Sidwell  <nathan@codesourcery.com>

	ld/testsuite/
	Backport 2008-05-02  H.J. Lu  <hongjiu.lu@intel.com>
	PR ld/6475
	* ld-scripts/rgn-over8-ok.d: Accept any alignment.

2008-05-09  Catherine Moore  <clm@codesourcery.com>

	From binutils-mips:
	Issue #2963
	gas/
	* config/tc-mips.c (mips_frob_file): Don't match MIPS16 relocs
	with non-MIPS16 relocs.

	gas/testsuite/
	* gas/mips/mips16-hilo-match.s: New test.
	* gas/mips/mip16-hilo-match.d: New test output.
	* gas/mips/mips.exp: Run mips16-hilo-match.

2008-05-05  Catherine Moore  <clm@codesourcery.com>

	From binutils-mips:
	2008-04-04  Catherine Moore  <clm@codesourcery.com>
	gas/testsuite/
	* gas/mips/mips.exp (ulw2-eb-ilocks, elw2-el-ilocks, uld2-el,
	uld2-eb, mips64): Disable for octeon.

2008-04-29  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #2950
	* release-notes-csl.xml: Document Symbian relocation fix.

	Backport from FSF:
	2008-04-29  Daniel Jacobowitz  <dan@codesourcery.com>
	bfd/
	* elf.c (_bfd_elf_get_dynamic_reloc_upper_bound)
	(_bfd_elf_canonicalize_dynamic_reloc): Find dynamic relocations
	even if they are not loaded.
	* elflink.c (_bfd_elf_init_2_index_sections): Set data_index_section
	first.

	2008-04-29  Daniel Jacobowitz  <dan@codesourcery.com>
	ld/testsuite/
	* ld-arm/symbian-seg1.s, ld-arm/symbian-seg1.d: New files.
	* ld-arm/arm-elf.exp: Run symbian-seg1.

2008-04-28  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #2928
	* release-notes-csl.xml: Document.

	ld/
	* ldlang.c (lang_size_sections_1): Don't check LMA overflow on
	non-load sections.

	ld/testsuite/
	* ld-scripts/rgn-over.exp: Allow -ok file names to pass.
	* ld-scripts/rgn-over8.s: New.
	* ld-scripts/rgn-over8.t: New.
	* ld-scripts/rgn-over8-ok.d: New.

2008-04-24  Maxim Kuvyrkov  <maxim@codesourcery.com>

	* elfxx-mips.c (_bfd_mips_elf_check_relocs): Don't reject R_MIPS_HI16
	relocations when they are a part of compound relocation.

2008-04-07  Andrew Jenner  <andrew@codesourcery.com>

	ld/
	* emultempl/armelf.em: Correct formatting of help text for
	--no-enum-size-warning option.

2008-03-28  Catherine Moore <clm@codesourcery.com>

	Backport:
	2008-03-26  Daniel Jacobowitz  <dan@codesourcery.com>
	ld/testsuite/
	* ld-elf/flags1.d: Adjust for MIPS text alignment.

2008-03-28  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_create_nonpic_dynamic_sections): New.
	(_bfd_mips_elf_create_dynamic_sections): Use it.
	(_bfd_mips_elf_check_relocs): Likewise.  Reject shared libraries with
	non-PIC relocations.
	(_bfd_mips_elf_merge_private_bfd_data): Skip dynamic objects.

2008-03-28  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (parse_neon_mov): Parse register before immediate
	to avoid spurious symbols.

2008-03-27  Joseph Myers  <joseph@codesourcery.com>

	ld/testsuite/
	* ld-elfcomm/elfcomm.exp: Run $READELF not readelf.

2008-03-27  Daniel Jacobowitz  <dan@codesourcery.com>

	gas/
	* config/tc-mips.c (md_begin): Disable -G for abicalls even without
	PIC.

2008-03-27  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #2742
	gas/
	* config/tc-m68k.c (md_convert_frag_1): Replace as_fatal with
	as_bad_where.

2008-03-26  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #2682
	bfd/
	* elfxx-mips.c (mips_elf_record_got_page_entry): Update comment.
	(_bfd_mips_elf_check_relocs): Update comments.  Always call
	mips_elf_record_got_page_entry for R_MIPS_GOT_PAGE.

2008-03-26  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #2691
	config/
	* mt-sde (CFLAGS_FOR_TARGET, CXXFLAGS_FOR_TARGET): Replace
	-minterlink-mips16 with -fno-optimize-sibling-calls.

	convert/
	* Makefile.am (convert.o): Add convert.c.
	* Makefile.in: Rebuilt.

2008-03-25  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/

	* elf.c (_bfd_elf_map_sections_to_segments): Check user's
	mapping of section to segments.

2008-03-24  Kazu Hirata  <kazu@codesourcery.com>

	libiberty/
	* cygpath.c (cygpath): Special-case the empty path.

2008-03-20  Nathan Sidwell  <nathan@codesourcery.com>

	convert/
	* Makefile.am (convert.o): Fix dependency typo.
	* Makefile.in: Rebuilt.

2008-03-18  Daniel Jacobowitz  <dan@codesourcery.com>

	libiberty/
	* cygpath.c (chdir): New function.

2008-03-14  Mark Shinwell  <shinwell@codesourcery.com>
            Daniel Jacobowitz  <dan@codesourcery.com>
            Catherine Moore  <clm@codesourcery.com>

	bfd/
	* bfd-in.h (bfd_mips_elf_set_non_pic): New prototype.
	(bfd_mips_elf_check_non_pic): New prototype.
	* bfd-in2.h: Regenerate.
	* elf32-mips.c (elf_mips_copy_howto): New.
	(elf_mips_jump_slot_howto): New.
	(bfd_elf32_bfd_reloc_type_lookup): Handle BFD_RELOC_MIPS_COPY
	and BFD_RELOC_MIPS_JUMP_SLOT.
	(bfd_elf32_bfd_reloc_name_lookup): Handle new copy and jump slot
	relocations.
	(mips_elf32_rtype_to_howto): Likewise.
	(elf_backend_want_plt_sym): Define.  Remove definition in VxWorks
	clause.
	(elf_backend_plt_readonly): Likewise.
	(elf_backend_write_section): Define.
	(elf_backend_plt_sym_val): Define, except for VxWorks.
	(mips_vxworks_copy_howto_rela): Delete.
	(mips_vxworks_jump_slot_howto_rela): Delete.
	(mips_vxworks_bfd_reloc_type_lookup): Delete.
	(mips_vxworks_bfd_reloc_name_lookup): Delete.
	(mips_vxworks_rtype_to_howto): Delete.
	(elf_backend_got_symbol_offset): Remove legacy definition.
	(elf_backend_want_dynbss): Remove unnecessary definition.
	(bfd_elf32_bfd_reloc_type_lookup): Delete macro definition for
	VxWorks.
	(bfd_elf32_bfd_reloc_name_lookup): Likewise.
	(elf_backend_mips_rtype_to_howto): Likewise.
	(elf_backend_adjust_dynamic_symbol): Define to new function.
	* elfxx-mips.c (mips_elf_link_hash_entry): Add plt_entry_offset and
	has_non_pic_to_pic_stub members.  Delete is_relocation_target
	member.
	(mips_elf_link_hash_table): Add is_non_pic, non_pic_bfd,
	snonpictopic and large_plt_entry_size members.  Update comments.
	(NON_PIC_P): New.
	(NON_PIC_TO_PIC_STUB_SECTION_NAME): New.
	(MIPS_NONPIC_LARGE_PLT_THRESHOLD): New.
	(mips_non_pic_exec_plt0_entry): New.
	(mips_non_pic_exec_plt_entry): New.
	(mips_non_pic_large_exec_plt_entry): New.
	(mips_non_pic_to_pic_stub): New.
	(mips_elf_link_hash_newfunc): Initialize new members.
	(mips_elf_create_got_section): Don't create .got.plt for VxWorks.
	(mips_elf_calculate_relocation): Handle cases for filling in
	references to non-PIC to PIC call stubs and non-PIC PLT entries.
	(_bfd_mips_elf_create_dynamic_sections): Create .plt, .rel.plt,
	.dynbss and .rel.bss sections for non-PIC.  Create .got.plt for
	non-PIC and VxWorks.
	(_bfd_mips_elf_check_relocs): Update comments.  Check if we have
	the first non-PIC file encountered during an executable link.
	Don't add dynamic relocations for non-PIC.  Remove
	is_relocation_target assignment.  Set non_got_ref as appropriate.
	(mips_elf_next_plt_entry_size): New.
	(mips_elf_create_old_style_stub): New.
	(_bfd_mips_elf_adjust_dynamic_symbol): Call worker function to
	handle VxWorks and non-PIC cases.  Move code for creating old-style
	.MIPS.stubs entries to mips_elf_create_old_style_stub.
	(_bfd_mips_vxworks_adjust_dynamic_symbol): Rename to...
	(_bfd_mips_plt_adjust_dynamic_symbol): ...this.  New.  Extend code
	to handle the non-PIC ABI.
	(mips_elf_maybe_create_non_pic_to_pic_stub): New.
	(_bfd_mips_elf_always_size_sections): Identify symbols requiring
	non-PIC to PIC call stubs.  Allocate space for any such stubs.
	(_bfd_mips_elf_size_dynamic_sections): Allocate space for delay slot
	in a PLT section.  Update comments.  Add dynamic tags for non-PIC
	if required.
	(_bfd_mips_elf_finish_dynamic_symbol): Fill in .plt, .got.plt and
	.rel.plt entries for symbols with PLT entries under non-PIC.
	Tighten bound on h->plt.offset for old-style stubs.  Emit copy
	relocations if required.
	(mips_non_pic_finish_plt): New.
	(_bfd_mips_elf_finish_dynamic_sections): Handle DT_MIPS_PLTGOT
	and DT_MIPS_RWPLT dynamic tags.  Rework code handling DT_PLTGOT
	dynamic tag.  Adjust assertions for DT_PLTREL, DT_PLTRELSZ and
	DT_JMPREL.  Call mips_non_pic_finish_plt.
	(_bfd_mips_elf_copy_indirect_symbol): Copy new members.
	(_bfd_mips_elf_link_hash_table_create): Initialize new members.
	(_bfd_mips_elf_merge_private_bfd_data): Remove extraneous
	braces.
	(_bfd_mips_elf_get_target_dtag): Handle DT_MIPS_PLTGOT and
	DT_MIPS_RWPLT cases.
	(_bfd_mips_elf_plt_sym_val): New.
	(mips_elf_nonpic_stub): New.
	(_bfd_mips_elf_begin_write_processing): New.
	(bfd_mips_elf_maybe_create_non_pic_to_pic_stubs_section): New.
	(_bfd_mips_post_process_headers): Set correct ABI version for
	non-PIC.
	* elfxx-mips.h (_bfd_mips_vxworks_adjust_dynamic_symbol): Rename to...
	(_bfd_mips_plt_adjust_dynamic_symbol): ...this.  New prototype.
	(_bfd_mips_nonpic_finish_dynamic_symbol): New.
	(_bfd_mips_elf_plt_sym_val): New prototype.
	(_bfd_mips_elf_begin_write_processing): New prototype.
	(bfd_mips_elf_maybe_create_non_pic_to_pic_stubs_section): New
	prototype.
	(_bfd_mips_post_process_headers): New prototype.
	(elf_backend_post_process_headers): Define.
	(elf_backend_begin_write_processing): Define.
	* elflink.c (_bfd_elf_merge_symbol): Correct typo.
	* reloc.c (MIPS ELF relocation): Add reference to non-PIC.

	binutils/
	* readelf.c (get_mips_dynamic_type): Handle DT_MIPS_PLTGOT
	and DT_MIPS_RWPLT.
	(get_mips_symbol_other): Handle STO_MIPS_PLT.

	gas/
	* config/tc-mips.c (mips_nonpic_option): New.
	(md_longopts): Add mnon-pic-abicalls entry.
	(md_parse_option): Add OPTION_NON_PIC_ABICALLS case.
	(mips_elf_final_processing): Check mips_nonpic_option.

	include/
	* elf/mips.h (DT_MIPS_PLTGOT): New.
	(DT_MIPS_RWPLT): New.
	(STO_MIPS_PLT): New.

	ld/
	* emulparams/elf32btsmip.sh: Update comment.
	(GOT): Define.
	(GOTPLT): Define.
	(DATA_GOTPLT): Define.
	* emulparams/elf32ebmipvxworks.sh (GOT): Unset.
	(GOTPLT): Likewise.
	(DATA_GOTPLT): Likewise.
	* emulparams/elf32elmipvxworks.sh (GOT): Unset.
	(GOTPLT): Likewise.
	(DATA_GOTPLT): Likewise.
	* emultempl/mipself.em: Include elfxx-mips.h.
	(mips_after_open): New.
	(LDEMUL_AFTER_OPEN): Define.
	* scripttempl/elf.sc: Update comments.  Handle DATA_GOT and
	DATA_GOTPLT.

2008-03-12  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (no_mac): New.
	(m68k_extensions): Point to it for mac entry.
	(m68k_set_extension): Allow for disabling different set of flags.

2008-03-11  Catherine Moore  <clm@codesourcery.com>

	bfd/
	* elf.c ( _bfd_elf_print_private_bfd_data): Call
	elf_backend_get_target_dtag if defined.
	* elf32-mips.c (elf_backend_get_target_dtag): Define.
	* elf64-mips.c: Likewise.
	* elfn32-mips.c: Likewise.
	* elfxx-mips.c (_bfd_mips_elf_get_target_dtag): New.
	* elfxx-mips.h (_bfd_mips_elf_get_target_dtag): Declare.
	* elf-bfd.h (elf_backend_get_target_dtag): Add prototype.
	* elfxx-target.h (elf_backend_get_target_dtag): Add default.
	(elf_backend_data): Add elf_backend_get_target_dtag.

2008-03-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	2008-03-11  Thiemo Seufer  <ths@mips.com>

	convert/
	* bin.c, conv.texi, convert.c, elf.h, elfio.c, elfmips.h,
	elfout.c, idtbin.c, lsifast.c, mipsflash.c, srec.c, stagbin.c:
	Update license to GPL v3.

2008-03-07  Julian Brown  <julian@codesourcery.com>

	convert/
	* convert.c (conv-version.h): Include.
	(getopt.h): Include.
	(usage): Add error argument. Print to stdout/stderr depending on
	setting. Exit according to setting. Print bug URL.
	(parselist): Add argument to usage() calls.
	(long_opts): New array.
	(main): Use getopt_long. Add argument to usage() invocations.
	Handle --help, --version options.
	* configure.ac (ACX_PKGVERSION, ACX_BUGURL): Add.
	* Makefile.am (ACLOCAL_AMFLAGS): Add.
	(conv_SOURCES): Add conv-version.h.
	(conv-version.h): Add build rule.
	(convert.c): Add dependency on conv-version.h.
	* version.h: New.
	* Makefile.in: Regenerate.
	* configure.ac: Regenerate.
	* aclocal.m4: Regenerate.

2008-03-07  Julian Brown  <julian@codesourcery.com>

	convert/
	* Makefile.am (install-exec-local): Don't install "conv" binary with
	no target triplet.
	* Makefile.in: Regenerate.

2008-03-06  Joseph Myers  <joseph@codesourcery.com>

	ld/testsuite/
	* lib/ld-lib.exp (check_gc_sections_available): Return 0 for
	*-*-mingw*.

2008-03-06  Maxim Kuvyrkov  <maxim@codesourcery.com>

	bfd/

	* elf32-m68k.c (elf_m68k_get_bfd2got_entry): Handle search mode.
	(elf_m68k_relocate_section): Fix to handle _GLOBAL_OFFSET_TABLE_
	relocations in case of empty local/global GOT.

2008-03-04  Mark Shinwell  <shinwell@codesourcery.com>
	    Sandra Loosemore  <sandra@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_final_link_relocate):  Use correct formula
	for sign-extending 16-bit offsets in MOVW/MOVT relocations.

2008-03-02  Joseph Myers  <joseph@codesourcery.com>

	ld/
	* emulparams/m68kelf.sh (GENERATE_PIE_SCRIPT): Define.

2008-02-29  Paul Brook  <paul@codesourery.com>

	bfd/
	* elf32-arm.c (insert_thumb_branch): Rewrite.  Handle b.w.
	(elf32_thumb_to_arm_stub): Adjust for new insert_thumb_branch.

	ld/testsuite/
	* ld-arm/arm-app.r: Updated expected outpu for new test.
	* ld-arm/arm-elf.exp (armeabitests): Add thumb2-b-interwork.
	* ld-arm/thumb2-b-interwork.d: New test.
	* ld-arm/thumb2-b-interwork.s: New test.

2008-02-29  Julian Brown  <julian@codesourcery.com>

	convert/
	* config.h.in: Regenerate.

2008-02-29  Julian Brown  <julian@codesourcery.com>

	convert/
	* convert.c (xmalloc): Remove (duplicate definition in libiberty).

2008-02-28  Julian Brown  <julian@codesourcery.com>

	* configure.ac (mips*-sde-elf*): Merge duplicated cases into one.
	Test --with-newlib for !yes rather than no.
	* Makefile.def (all-convert): Add dependency on libiberty to fix
	parallel make.
	* configure: Regenerate.
	* Makefile.in: Regenerate.

	convert/
	* Makefile.in: Disable HTML documentation, and HTML and PDF
	documentation installation.
	* Makefile.am: Regenerate.
	* configure: Regenerate.
	* aclocal.m4: Regenerate.

2008-02-28  Julian Brown  <julian@codesourcery.com>

	Revert: (moved to separate module)

	2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	* sdemdi: New directory. SDE/MDI glue.
	* Makefile.def: Add sdemdi target module.

	sdemdi/
	* ChangeLog: New.
	* configure.ac: New.
	* Makefile.am: New.
	* config-ml.in: New.
	* crt0.S: New.
	* fileio.c: New.
	* m32cache.S: New.
	* mdi.h: New.
	* mdilow.S: New.
	* mdisyscall.S: New.
	* mdixcpt.h: New.
	* rtpxlite.c: New.
	* rtpxliteasm.S: New.
	* rtpxstub.c: New.
	* sdemdi32.ld: New.
	* sdemdi32hi.ld: New.
	* sdemdi64.ld: New.
	* sdemdi64hi.ld: New.
	* simlow.S: New.

2008-02-28  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Fix testcase to handle hack for SDElib below.
	Don't push upstream.
	
	gas/testsuite/

	* gas/mips/set-arch.d: Expect ehb.

2008-02-27  Paul Brook  <paul@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_check_relocs): Only set h->needs_plt for
	branch/call relocations.

	ld/testsuite/
	* ld-arm/arm-elf.exp (armelftests): Add arm-app-movw.

2008-02-27  Paul Brook  <paul@codesourcery.com>

	ld/testsuite/
	* ld-arm/arm-elf.exp (armelftests): Use arm.ld in movw-merge.

2008-02-26  Joseph Myers  <joseph@codesourcery.com>

	Backport:

	binutils/testsuite/
	2008-02-26  Joseph Myers  <joseph@codesourcery.com>
	* config/default.exp (gcc_gas_flag, dlltool_gas_flag): Define to
	empty for testing an installed toolchain.

2008-02-25  Sandra Loosemore  <sandra@codesourcery.com>

	binutils/
	Reapply:
	2006-05-17  Carlos O'Donell  <carlos@codesourcery.com>

	* doc/binutils.texi: Use "Binutils Index" for index name.

2008-02-23  Maxim Kuvyrkov  <maxim@codesourcery.com>

	* release-notes-csl.xml (ColdFire multi-GOT support): Fix release
	note to not include uClinux.

2008-02-20  Mark Mitchell  <mark@codesourcery.com>

	ld/testsuite/
	* ld-elf/seg.d: Expect .reginfo section on MIPS.

2008-02-16  Paul Brook  <paul@codesourcery.com>

	Merged from //mirrors/binutils/trunk revision 193546.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	2005-03-21  Maciej W. Rozycki  <macro@mips.com>

	* config/tc-mips.c (append_insn): Disable swapping of MIPS16
	branches as it breaks DWARF-2 line information.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	bfd/
	* elfxx-mips.c (mips_elf_merge_obj_attributes): Add support for
	-mips32r2 -mfp64.
	* readelf.c (display_mips_gnu_attribute): Add 64-bit float tag support.

	include/
	* elf/mips.h (Tag_GNU_MIPS_ABI_FP): Update comment.

	ld/testsuite/
	* ld-mips-elf/mips-elf.exp: Add run-dump-tests for attr-gnu-4-04,
	attr-gnu-4-05, attr-gnu-4-15, attr-gnu-4-24, attr-gnu-4-25,
	attr-gnu-4-34, attr-gnu-4-35, attr-gnu-4-40, attr-gnu-4-42,
	attr-gnu-4-43, attr-gnu-4-44, attr-gnu-4-45, attr-gnu-4-51.
	* ld-mips-elf/attr-gnu-4-14.d: Fix warning.
	* ld-mips-elf/attr-gnu-4-41.d: Likewise.
	* ld-mips-elf/attr-gnu-4-5.s: New.
	* ld-mips-elf/attr-gnu-4-04.d: New.
	* ld-mips-elf/attr-gnu-4-05.d: New.
	* ld-mips-elf/attr-gnu-4-15.d: New.
	* ld-mips-elf/attr-gnu-4-24.d: New.
	* ld-mips-elf/attr-gnu-4-25.d: New.
	* ld-mips-elf/attr-gnu-4-34.d: New.
	* ld-mips-elf/attr-gnu-4-35.d: New.
	* ld-mips-elf/attr-gnu-4-40.d: New.
	* ld-mips-elf/attr-gnu-4-42.d: New.
	* ld-mips-elf/attr-gnu-4-43.d: New.
	* ld-mips-elf/attr-gnu-4-44.d: New.
	* ld-mips-elf/attr-gnu-4-45.d: New.
	* ld-mips-elf/attr-gnu-4-51.d: New.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	2004-09-09  Nigel Stephens  <nigel@mips.com>

	bfd/
	* ihex.c (ihex_write_object_contents): Truncate address to 32 bits
	if the top 32 bits are a simple sign extension of the bottom.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	gas/
	* config/tc-mips.c (OPTION_MIPS16E, OPTION_NOMIPS16E): Add
	backward-compatibility options for SDE.
	(OPTION_COMPAT_ARCH_BASE): Bump to +16.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	* sdemdi: New directory. SDE/MDI glue.
	* Makefile.def: Add sdemdi target module.

	sdemdi/
	* ChangeLog: New.
	* configure.ac: New.
	* Makefile.am: New.
	* config-ml.in: New.
	* crt0.S: New.
	* fileio.c: New.
	* m32cache.S: New.
	* mdi.h: New.
	* mdilow.S: New.
	* mdisyscall.S: New.
	* mdixcpt.h: New.
	* rtpxlite.c: New.
	* rtpxliteasm.S: New.
	* rtpxstub.c: New.
	* sdemdi32.ld: New.
	* sdemdi32hi.ld: New.
	* sdemdi64.ld: New.
	* sdemdi64hi.ld: New.
	* simlow.S: New.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	* convert: New directory. Elf to binary converter.

	convert/
	* ChangeLog: New.
	* Makefile.am: New.
	* Makefile.def: New.
	* acinclude.m4: New.
	* configure.ac: New.
	* convert.c: New.
	* sysdep.h: New.
	* srec.c: New.
	* elf.h: New.
	* stagbin.c: New.
	* elfmips.h: New.
	* alloca.c: New.
	* bin.c: New.
	* mipsflash.c: New.
	* idtbin.c: New.
	* elfout.c: New.
	* lsifast.c: New.
	* elfio.c: New.
	* conv.1: New.
	* conv.texi: New.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS (This patch is a hack to make SDElib happy);
	don't push upstream:

	2004-10-06  David Ung  <davidu@mips.com>

	* mips-opc.c: Change membership to I1 for instructions ssnop and
	ehb.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS:

	* config/mt-sde (CFLAGS_FOR_TARGET): Add -mno-gpopt.
	(CXXFLAGS_FOR_TARGET): Likewise.
	* configure.ac (mips*-sde-elf*): Remove libgloss and libiberty when not
	building Newlib. Add sde-conv host tool and MDI glue library.
	* configure: Regenerate.

2008-02-11  Julian Brown  <julian@codesourcery.com>

	Merge from MIPS/backport from FSF:

	2007-09-14  Alan Modra  <amodra@bigpond.net.au>

	bfd/
	* opncls.c (find_separate_debug_file): Ensure bfd_set_error has
	been called on all error return paths.
	(bfd_fill_in_gnu_debuglink_section): Use bfd_malloc, not malloc.
	Clear padding after filename

	2007-09-14  Alan Modra  <amodra@bigpond.net.au>

	bfd/
	* format.c (bfd_check_format_matches): Record matching targets even
	when "matching" is NULL to allow bfd_associated_vector matches.
	Consolidate error return code.  Consolidate ok return code.  Always
	restore original target and format on error.

2008-02-02  Sandra Loosemore  <sandra@codesourcery.com>
	
	* release-notes-csl.xml: Fix mistaken uses of &csl_prod; to use
	&csl_sgxx; instead.

2008-02-01  Maxim Kuvyrkov  <maxim@codesourcery.com>

	ld/testsuite/

	* ld-m68k/got-12.s: Remove .ident.
	* ld-m68k/got-13.s: Ditto.
	* ld-m68k/got-14.s: Ditto.
	* ld-m68k/got-15.s: Ditto.
	* ld-m68k/got-34.s: Ditto.
	* ld-m68k/got-35.s: Ditto.
	* ld-m68k/xgot-15.s: Ditto.

2008-02-01  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Add -mxgot tests to ld.

	ld/testsuite/

	* ld-m68k/xgot-15.s: New source.
	* ld-m68k/got-xgot-15-ok.d: New test.
	* ld-m68k/got-xgot-12-13-14-15-34-35-ok.d: New test.
	* ld-m68k/m68k.exp: Run new tests.

2008-01-29  Julian Brown  <julian@codesourcery.com>

	gas/
	* read.c (cons_worker): Report error if user tries to specify string
	after .byte, etc. directive.

2008-01-28  Paul Brook  <paul@codesourcery.com>

	ld/
	* emultempl/armelf.em (OPTION_FIX_V4BX_INTERWORKING): Define.
	(PARSE_AND_LIST_LONGOPTS): Add fix-v4bx-interworking.
	(PARSE_AND_LIST_OPTIONS): Ditto.
	(PARSE_AND_LIST_ARGS_CASES): Handle OPTION_FIX_V4BX_INTERWORKING.
	* emulparams/armelf.sh (OTHER_TEXT_SECTIONS): Add .v4_bx.
	* emulparams/armelf_linux.sh (OTHER_TEXT_SECTIONS): Ditto.
	* emulparams/armnto.sh (OTHER_TEXT_SECTIONS): Ditto.
	* ld.texinfo: Document --fix-v4bx-interworking.

	ld/testsuite/
	* ld-arm/armv4-bx.d: New test.
	* ld-arm/armv4-bx.s: New test.
	* ld-arm/arm.ld: Add .v4bx.
	* ld-arm/arm-elf.exp: Add armv4-bx.

	gas/testsuite/
	* gas/arm/thumb.d: Exclude EABI targets.
	* gas/arm/arch4t.d: Exclude EABI targts.
	* gas/arm/v4bx.d: New test.
	* gas/arm/v4bx.s: New test.
	* gas/arm/thumb-eabi.d: New test.
	* gas/arm/arch4t-eabi.d: New test.

	gas/
	* config/tc-arm.c (fix_v4bx): New variable.
	(do_bx): Generate V4BX relocations.
	(md_assemble): Allow bx on v4 codes when fix_v4bx.
	(md_apply_fix): Handle BFD_RELOC_ARM_V4BX.
	(tc_gen_reloc): Ditto.
	(OPTION_FIX_V4BX): Define.
	(md_longopts): Add fix-v4bx.
	(md_parse_option): Handle OPTION_FIX_V4BX.
	(md_show_usage): Document --fix-v4bx.
	* doc/c-arm.texi: Document --fix-v4bx.

	bfd/
	* reloc.c: Add BFD_RELOC_ARM_V4BX.
	* elf32-arm.c (elf32_arm_reloc_map): Add BFD_RELOC_ARM_V4BX.
	(ARM_BX_GLUE_SECTION_NAME, ARM_BX_GLUE_SECTION_NAME): Define.
	(elf32_arm_link_hash_table): Add bx_glue_size and bx_glue_offset.
	Update comment for fix_v4bx.
	(elf32_arm_link_hash_table_create): Zero bx_glue_size and
	bx_glue_offset.
	(ARM_BX_VENEER_SIZE, armbx1_tst_insn, armbx2_moveq_insn,
	armbx3_bx_insn): New.
	(bfd_elf32_arm_allocate_interworking_sections): Allocate BX veneer
	section.
	(bfd_elf32_arm_add_glue_sections_to_bfd): Ditto.
	(bfd_elf32_arm_process_before_allocation): Record BX veneers.
	(record_arm_bx_glue, elf32_arm_bx_glue): New functions.
	(elf32_arm_final_link_relocate): Handle BX veneers.
	(elf32_arm_output_arch_local_syms): Output mapping symbol for .v4_bx.
	* bfd-in2.h: Regenerate.
	* libbfd.h: Regenerate.

2008-01-28  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Handle weakdefs in copy_indirect hook.

	bfd/

	elf32-m68k.c (elf_m68k_copy_indirect_symbol): Handle weakdefs.

2008-01-26  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Multi-GOT support for m68k.

	* release-notes-csl.xml: Document feature.
	
	bfd/

	* elf32-m68k.c (struct elf_m68k_link_hash_entry: got_entry_key,
	glist): New fields.
	(struct elf_m68k_got_entry_key, struct elf_m68k_got_entry,
	struct elf_m68k_got, struct elf_m68k_bfd2got_entry,
	struct elf_m68k_multi_got): New data structures.
	(struct elf_m68k_link_hash_table: local_gp_p, use_neg_got_offsets_p,
	allow_multigot_p, multi_got_): New fields.
	(elf_m68k_multi_got): New macro.
	(elf_m68k_link_hash_newfunc): Initialize new fields of
	struct elf_m68k_link_hash_entry.
	(elf_m68k_link_hash_table_create): Initialize new fields of
	struct elf_m68k_link_hash_table.
	(elf_m68k_link_hash_table_free): New static function implementing hook.
	(elf_m68k_init_got, elf_m68k_clear_got, elf_m68k_create_empty_got): New
	static functions for struct elf_m68k_got.	
	(elf_m68k_init_got_entry_key, elf_m68k_got_entry_hash,
	elf_m68k_got_entry_eq): New static functions for
	struct elf_m68k_got_entry.
	(ELF_M68K_REL_8O_MAX_N_ENTRIES_IN_GOT,
	ELF_M68K_REL_8O_16O_MAX_N_ENTRIES_IN_GOT): New macros.
	(enum elf_m68k_get_entry_howto): New enum.
	(elf_m68k_get_got_entry, elf_m68k_update_got_entry_type,
	elf_m68k_remove_got_entry_type): New static functions for
	struct elf_m68k_got_entry.
	(elf_m68k_add_entry_to_got): New static function.
	(elf_m68k_bfd2got_entry_hash, elf_m68k_bfd2got_entry_eq,
	elf_m68k_bfd2got_entry_del, elf_m68k_get_bfd2got_entry): New static
	functions for struct elf_m68k_bfd2got_entry.
	(struct elf_m68k_can_merge_gots_arg, elf_m68k_can_merge_gots_1,
	elf_m68k_can_merge_gots): New traversal.
	(struct elf_m68k_merge_gots_arg, elf_m68k_merge_gots_1,
	elf_m68k_merge_gots): Ditto.
	(struct elf_m68k_finalize_got_offsets_arg,
	elf_m68k_finalize_got_offsets_1, elf_m68k_finalize_got_offsets): Ditto.
	(struct elf_m68k_partition_multi_got_arg,
	elf_m68k_partition_multi_got_1, elf_m68k_init_symndx2h_1,
	elf_m68k_partition_multi_got): Ditto.
	(elf_m68k_find_got_entry_ptr, elf_m68k_remove_got_entry): New static
	functions.
	(elf_m68k_copy_indirect_symbol): New static function implementing
	a hook.
	(elf_m68k_check_relocs): Update to add entries to multi-GOT.
	(elf_m68k_gc_sweep_hook): Update to remove entries from multi-GOT.
	(elf_m68k_always_size_sections): Assign BFDs to GOTs.
	(elf_m68k_relocate_section): Update to properly handle GOT relocations.
	(elf_m68k_finish_dynamic_symbol): Update to traverse all GOT entries
	of a global symbol.
	(bfd_elf_m68k_set_target_options): New function.
	(bfd_elf32_bfd_link_hash_table_free): Define hook.
	(bfd_elf32_bfd_final_link): Change expansion to bfd_elf_final_link
	to skip generic calculation of GOT offsets.
	(elf_backend_copy_indirect_symbol): Define hook.

	* bfd-in.h (bfd_elf_m68k_set_target_options): Declare function.
	* bfd-in2.h: Regenerate.
	
	ld/

	* configure.in (--enable-got): New option.  Handle it.
	* configure: Regenerate.
	* config.in: Regenerate.

	* emultempl/m68kelf.em: (got_handling_target_default): New shell
	variable.
	(GOT_HANDLING_TARGET_DEFAULT): New macro.
	(GOT_HANDLING_DEFAULT): New macro.  Initialize it from configure
	option if one was given.
	(got_handling): New static variable.
	(elf_m68k_create_output_section_statements): New static function
	implementing hook.
	(PARSE_AND_LIST_PROLOGUE): Define shell variable.
	(OPTION_GOT): New macro.
	(PARSE_AND_LIST_LONGOPTS): Define shell variable.  Specify
	--got option.
	(got): New linker option.
	(PARSE_AND_LIST_OPTIONS): Define shell variable.  Print help string
	for --got option.
	(PARSE_AND_LIST_ARGS_CASES): Define shell variable.  Handle --got
	option.
	
	* ld.texinfo: Document --got=<type> option.
	* gen-doc.texi: Add M68K.

	ld/testsuite/

	* ld-m68k/got-12.s: New file.
	* ld-m68k/got-13.s: New file.
	* ld-m68k/got-14.s: New file.
	* ld-m68k/got-15.s: New file.
	* ld-m68k/got-34.s: New file.
	* ld-m68k/got-35.s: New file.
	* ld-m68k/got-single-12-ok.d: New dump test.
	* ld-m68k/got-single-13-er.d: New dump test.
	* ld-m68k/got-negative-14-ok.d: New dump test.
	* ld-m68k/got-negative-15-er.d: New dump test.
	* ld-m68k/got-negative-12-13-14-34-ok.d: New dump test.
	* ld-m68k/got-negative-12-13-14-35-er.d: New dump test.
	* ld-m68k/got-multigot-14-ok.d: New dump test.
	* ld-m68k/got-multigot-15-er.d: New dump test.
	* ld-m68k/got-multigot-12-13-14-34-35-ok.d: New dump test.
	* ld-m68k/m68k.exp: Run new tests.

2008-01-25  Joseph Myers  <joseph@codesourcery.com>

	include/
	* libiberty.h (cygpath): Declare.

	libiberty/
	* cygpath.c (cygpath): Remove static.  Return int.
	* pex-win32.c (pex_win32_open_read, pex_win32_open_write): Use
	open not _open.

2008-01-22  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (arm_cpu_option_table): Add cortex-a9.

	gas/doc/
	* c-arm.texi: Add cortex-a9.

2008-01-22  Paul Brook  <paul@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_relocate_section): Handle MOVW and MOVT
	relocations.  Improve safety check for other weird relocations.
	* elf32-arm.c (elf32_arm_howto_table): Fix masks for MOVW/MOVT.

	ld/testsuite/
	* ld-arm/arm-elf.exp: Add movw-merge.
	* ld-arm/movw-merge.d: New test.
	* ld-arm/movw-merge.s: New test.

2008-01-09  Joseph Myers  <joseph@codesourcery.com>

	* configure.ac (host_makefile_frag): Use config/mh-mingw on
	*-mingw32*.
	* configure: Regenerate.

	config/
	* config/mh-mingw: New.

2008-01-07  Joseph Myers  <joseph@codesourcery.com>

	NOT ASSIGNED TO FSF
	COPYRIGHT CAVIUM
	Merge from Cavium binutils-2.16.1.diff.gz:

	gas/
	* config/tc-mips.c (macro): Support M_SAA_AB and M_SAAD_AB.

	gas/testsuite/
	* gas/mips/mips.exp: Add octeon_saa_saad test.
	* gas/mips/octeon_saa_saad.d: New.
	* gas/mips/octeon_saa_saad.s: New.

	include/opcode/
	* mips.h (M_SAA_AB, M_SAAD_AB): New.

	opcodes/
	* mips-opc.c (mips_builtin_opcodes): Add saa and saad
	instructions.

2008-01-03  Catherine Moore  <clm@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_ip): Check operands on jalr instruction.

	gas/testsuite
	* gas/mips/jalr.s: New test.
	* gas/mips/jalr.l: New test output.
	* gas/mips/mips.exp: Run new test.

2007-12-19  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #2297
	ld/testsuite/
	* ld-elf/seg.t: New.
	* ld-elf/seg.d: New.
	* ld-elf/seg.s: New.

2007-12-12  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	2007-09-15  Alan Modra  <amodra@bigpond.net.au>
	* configure.ac: Correct makeinfo version check.
	* configure: Regenerate.

2007-12-12  Paul Brook  <paul@codesourcery.com>

	gas/
	* doc/c-arm.texi: Document new VFP -mfpu= options.
	* config/tc-arm.c (arm_option_cpu_value): Rename vfp3-d16 to
	vfpv3-d16.  Add vfpv2 and vfpv3.

	gas/testsuite/
	* gas/arm/vfpv3-d16-bad.d: Rename vfp3-d16 to vfpv3-d16.

2007-12-11  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (fpu_vfp_ext_d32): New vairable.
	(parse_vfp_reg_list, encode_arm_vfp_reg): Use it.
	(arm_option_cpu_value): Add vfpv3-d16.
	(aeabi_set_public_attributes): Handle Tag_VFP_arch=VFPV3-D16.

	gas/testsuite/
	* gas/arm/vfpv3-d16-bad.d: New test.
	* gas/arm/vfpv3-d16-bad.l: New test.

	include/opcode/
	* arm.h (FPU_VFP_EXT_D32, FPU_VFP_V3D16, FPU_ARCH_VFP_V3D16): Define.

	binutils/
	* readelf.c (arm_attr_tag_VFP_arch): Add "VFPv3-D16".
	
	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Handle new
	Tag_VFP_arch values.

2007-12-10  Catherine Moore  <clm@codesourcery.com>

	Issue #2285
	bfd/
	* elf.c (bfd_copy_private_symbol_data): Do not copy if
	the shndx is zero.

	gas/testsuite/
	* elf/elf.exp: Exceute symtab test.
	* elf/symtab.s: New test.
	* elf/symtab.d: New test output file.

	* release-notes-csl.xml: Document fix.

2007-11-29  Mark Shinwell  <shinwell@codesourcery.com>

	include/opcode/
	* mips.h (INSN_LOONGSON_2E, INSN_LOONGSON_2F,
	INSN_OCTEON): Rearrange masks so Loongson flags match
	upstream.

2007-11-28  Nathan Sidwell  <nathan@codesourcery.com>

	Issue #2297
	include/elf/
	* internal.h (ELF_IS_SECTION_IN_SEGMENT): Adjust to cope with
	segments at the end of memory.

2007-11-13  Joseph Myers  <joseph@codesourcery.com>

	Backport:
	bfd/
	2007-11-05  Alan Modra  <amodra@bigpond.net.au>
	* merge.c (sec_merge_hash_lookup): Revert last change.
	(record_section): Likewise.
	(_bfd_merge_sections): Likewise.
	(_bfd_merged_section_offset): Properly handle NULL secinfo.
	(_bfd_add_merge_section): Allocate extra space for a zero
	terminator on SEC_STRINGS sections.

	ld/testsuite/
	2007-11-05  Alan Modra  <amodra@bigpond.net.au>
	* ld-elf/merge3.d, ld-elf/merge3.s: Delete.

2007-11-06  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (do_mull): Allow overlapping Rm for armv6.

	gas/testsuite/
	* gas/arm/mul-overlap.s: Add umull and smlal.
	* gas/arm/mul-overlap.l: Update expected results.

2007-10-30  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* merge.c (sec_merge_hash_lookup): Add parameter sec_end.  Check
	for unterminated strings.  All callers changed.
	(_bfd_write_merged_section, _bfd_merged_section_offset): Handle
	NULL secinfo from merge failures.

	ld/testsuite/
	* ld-elf/merge3.d, ld-elf/merge3.s: New.

2007-10-24  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_modify_segment_map): Do not add
	PT_NULL header when not linking.

2007-10-18  Joseph Myers  <joseph@codesourcery.com>

	NOT ASSIGNED TO FSF
	COPYRIGHT RAZA
	* config.sub (mipsisa64xlr, ipsisa64xlrel): Add new machine names.

	bfd/
	* aoutx.h (NAME (aout, machine_type)): Handle bfd_mach_mips_xlr.
	* archures.c (bfd_mach_mips_xlr): New.
	* cpu-mips.c (I_xlr): New enum value.
	(arch_info_struct): Add XLR entry.
	* elfxx-mips.c (_bfd_elf_mips_mach): Handle E_MIPS_MACH_XLR.
	(mips_set_isa_flags): Handle bfd_mach_mips_xlr.
	(mips_mach_extensions): Add XLR entry.
	* bfd-in2.h: Regenerate.

	binutils/
	* readelf.c (get_machine_flags): Handle E_MIPS_MACH_XLR.

	gas/
	* config/tc-mips.c (macro): Handle XLR instructions.
	(mips_cpu_info_table): Add xlr.
	* doc/c-mips.texi (MIPS architecture options): Add xlr to list of
	-march options.

	gas/testsuite/
	* gas/mips/xlr-ext.d, /gas/mips/xlr-ext.s: New.
	* gas/mips/mips.exp (xlr): New arch.
	(xlr-ext): Run test.

	include/elf/
	* mips.h (E_MIPS_MACH_XLR): Define.

	include/opcode/
	* mips.h (INSN_XLR, CPU_XLR): Define.
	(OPCODE_IS_MEMBER): Handle XLR.
	(M_MSGSND, M_MSGLD, M_MSGLD_T, M_MSGWAIT, M_MSGWAIT_T): Define
	enum values.

	opcodes/
	* mips-dis.c (mips_cp0_names_xlr, mips_cp0sel_names_xlr): New.
	(mips_arch_choices): Add XLR entry.
	* mips-opc.c (XLR): Define.
	(mips_builtin_opcodes): Add XLR opcodes.

2007-10-17  Nathan Sidwell  <nathan@codesourcery.com>

	opcodes/
	* m68k-opc.c (m68k_opcodes): Correct move sr and ccr masks for
	coldfire.

	gas/testsuite/
	* gas/m68k/mcf-movsr.s: New.
	* gas/m68k/mcf-movsr.d: New.
	* gas/m68k/all.exp: Add mcf-movsr test.

2007-10-09  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elfxx-mips.c (mips_elf_sort_hash_table_f): Handle forced
	local symbols specially.
	(mips_elf_set_global_got_offset): Skip forced local symbols.

	Revert:
	2007-10-04  Joseph Myers  <joseph@codesourcery.com>
	bfd/
	* elfxx-mips.c (struct mips_got_info): Add forced_local_count.
	(struct mips_elf_hash_sort_data): Add forced_local and
	prev_forced_local.
	(mips_elf_sort_hash_table): Subtract g->forced_local_count in
	computing hsd.min_got_dynindx.  Initialize hsd.forced_local and
	hsd.prev_forced_local.  Set g->forced_local_count after sorting.
	(mips_elf_sort_hash_table_f): Count forced-local symbols.  Handle
	them as unreferenced where allowed for in calculation of
	min_got_dynindx.
	(mips_elf_make_got_per_bfd, mips_elf_multi_got,
	mips_elf_create_got_section): Initialize forced_local_count.
	(_bfd_mips_elf_always_size_sections): Subtract forced_local_count
	in calculating global_gotno.
	(_bfd_mips_elf_final_link): Subtract forced_local_count in
	assertion.
	(mips_elf_set_global_got_offset): Check for forced-local symbols
	before assigning global GOT offsets.

2007-10-05  Daniel Jacobowitz  <dan@codesourcery.com>

	* release-notes-csl.xml: Add lost </para>.

2007-10-05  Carlos O'Donell  <carlos@codesourcery.com>

	binutils/
	* resrc.c (read_rc_file): Rename e to edit, and c to dir.
	Pass dir to windres_add_include_dir.  Add comments.
	(close_input_stream): Check pclose error, and call fatal if
	the preprocessor failed.
	* windres.c (windres_add_include_dir): Assert that p is non-NULL,
	and not an empty string. 

2007-10-04  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elfxx-mips.c (struct mips_got_info): Add forced_local_count.
	(struct mips_elf_hash_sort_data): Add forced_local and
	prev_forced_local.
	(mips_elf_sort_hash_table): Subtract g->forced_local_count in
	computing hsd.min_got_dynindx.  Initialize hsd.forced_local and
	hsd.prev_forced_local.  Set g->forced_local_count after sorting.
	(mips_elf_sort_hash_table_f): Count forced-local symbols.  Handle
	them as unreferenced where allowed for in calculation of
	min_got_dynindx.
	(mips_elf_make_got_per_bfd, mips_elf_multi_got,
	mips_elf_create_got_section): Initialize forced_local_count.
	(_bfd_mips_elf_always_size_sections): Subtract forced_local_count
	in calculating global_gotno.
	(_bfd_mips_elf_final_link): Subtract forced_local_count in
	assertion.
	(mips_elf_set_global_got_offset): Check for forced-local symbols
	before assigning global GOT offsets.

	ld/testsuite/
	* ld-mips-elf/multi-got-hidden-1.d,
	ld-mips-elf/multi-got-hidden-1.s,
	ld-mips-elf/multi-got-hidden-2.d,
	ld-mips-elf/multi-got-hidden-2.s: New.
	* ld-mips-elf/mips-elf.exp: Run multi-got-hidden tests.

2007-10-01  Carlos O'Donell  <carlos@codesourcery.com>

	Backport:
	binutils/
	2007-09-17  Alon Bar-Lev  <alon.barlev@gmail.com>

        PR binutils/4987
        * resrc.c: (read_rc_file): Move 'filename' default initialization
        to start of function.

2007-09-28  Carlos O'Donell  <carlos@codesourcery.com>

	Backport:
	gas/
	2007-09-24  Carlos O'Donell  <carlos@codesourcery.com>
	* config/tc-mips.c (s_align): Set max_alignment to 28.
	gas/testsuite/
	2007-09-24  Carlos O'Donell  <carlos@codesourcery.com>
	* gas/mips/align.s, gas/mips/align.d: New test.
	* gas/mips/mips.exp: Run it.

2007-09-25  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c: Enforce register constraints on Thumb-1 add.

	gas/testsuite/
	* gas/arm/t16-bad.s: Add low reg non flags setting add.
	* gas/arm/t16-bad.l: Update expected output.
	* gas/arm/archv6m.s: Add low reg non flags setting add.
	* gas/arm/archv6m.d: Update expected output.

2007-09-24  Daniel Jacobowitz  <dan@codesourcery.com>

	Backport:
	bfd/
	2007-09-24  Daniel Jacobowitz  <dan@codesourcery.com>
	* elf.c (assign_file_positions_for_load_sections): Trust
	p_align_valid.
	(copy_elf_program_header): Copy PT_NULL segments.

2007-09-24  Daniel Jacobowitz  <dan@codesourcery.com>

	gas/testsuite/
	* gas/mips/loongson-2f.d: Specify a 64-bit ABI.
	* gas/mips/loongson-2e.d: Likewise.

2007-09-21  Joseph Myers  <joseph@codesourcery.com>

	* release-notes-csl.xml: Add release notes for GOT patch.

	ld/testsuite/
	* ld-mips-elf/got-page-3.d: Assemble with -mips3.

2007-09-21  Joseph Myers  <joseph@codesourcery.com>

	Backport from
	<http://sourceware.org/ml/binutils/2007-09/msg00308.html>:

	bfd/
	2007-09-21  Richard Sandiford  <rsandifo@nildram.co.uk>
	* elfxx-mips.c (mips_got_page_range): New structure.
	(mips_got_page_entry): Likewise.
	(mips_got_info): Add page_gotno and got_page_entries fields.
	(mips_elf_got_per_bfd_arg): Add max_pages field.  Delete
	primary_count and current_count fields.
	(mips_got_page_entry_hash, mips_got_page_entry_eq): New functions.
	(mips_elf_pages_for_range, mips_elf_record_got_page_entry): Likewise.
	(mips_elf_get_got_for_bfd): New function, split out from
	mips_elf_make_got_per_bfd.  Initialize the page_gotno and
	got_page_entries fields when creating a new GOT structure.
	(mips_elf_make_got_pages_per_bfd): New function.
	(mips_elf_merge_got_with): New function, split out from
	mips_elf_make_got_per_bfd.  Merge page entries as well as
	non-page entries.  Use the minimum of max_pages and the sum
	of the page_gotnos to estimate the number of page entries.
	(mips_elf_merge_gots): Use the minimum of max_pages and the
	bfd's page_gotno to estimate the number of page entries.
	Use the above functions.
	(mips_elf_multi_got): Add page entries as well as non-page entries
	to the individual per-bfd GOTs.  Initialize got_per_bfd_arg.max_pages.
	Initialize the page_gotno and got_page_entries fields when creating
	a new primary GOT.  Use the minimum of pages and page_gotno when
	adding the number of pages entries to local_gotno.
	(mips_elf_create_got_section): Initialize the page_gotno and
	got_page_entries fields of the GOT structure.
	(mips_elf_rel_relocation_p, mips_elf_read_rel_addend)
	(mips_elf_add_lo16_rel_addend, mips_elf_get_section_contents): New
	functions, split out from...
	(_bfd_mips_elf_relocate_section): ...here.
	(_bfd_mips_elf_check_relocs): Record GOT page entries too.
	(_bfd_mips_relax_section): Use mips_elf_get_section_contents.
	(_bfd_mips_elf_always_size_sections): Use the smaller of the
	loadable_size- and page_gotno-derived estimates.

	ld/testsuite/
	2007-09-21  Richard Sandiford  <rsandifo@nildram.co.uk>
	            Joseph Myers  <joseph@codesourcery.com>
	* ld-mips-elf/got-page-1.d, ld-mips-elf/got-page-1.s,
	* ld-mips-elf/got-page-2.d, ld-mips-elf/got-page-2.s,
	* ld-mips-elf/got-page-3.d, ld-mips-elf/got-page-3a.s,
	* ld-mips-elf/got-page-3b.s, ld-mips-elf/got-page-3c.s,
	* ld-mips-elf/got-page-1.ld: New tests.
	* ld-mips-elf/mips-elf.exp: Run them.
	* ld-mips-elf/multi-got-1.d, ld-mips-elf/multi-got-no-shared.d,
	* ld-mips-elf/tls-hidden2-got.d, ld-mips-elf/tls-hidden2.d,
	* ld-mips-elf/tls-hidden3.d, ld-mips-elf/tls-hidden3.got,
	* ld-mips-elf/tls-hidden3.r, ld-mips-elf/tls-hidden4.got,
	* ld-mips-elf/tls-hidden4.r, ld-mips-elf/tls-multi-got-1.d,
	* ld-mips-elf/tls-multi-got-1.got, ld-mips-elf/tls-multi-got-1.r,
	* ld-mips-elf/tlsbin-o32.d, ld-mips-elf/tlsbin-o32.got,
	* ld-mips-elf/tlsdyn-o32-1.d, ld-mips-elf/tlsdyn-o32-1.got,
	* ld-mips-elf/tlsdyn-o32-2.d, ld-mips-elf/tlsdyn-o32-2.got,
	* ld-mips-elf/tlsdyn-o32-3.d, ld-mips-elf/tlsdyn-o32-3.got,
	* ld-mips-elf/tlsdyn-o32.d, ld-mips-elf/tlsdyn-o32.got,
	* ld-mips-elf/tlslib-o32-hidden.got, ld-mips-elf/tlslib-o32-ver.got,
	* ld-mips-elf/tlslib-o32.d, ld-mips-elf/tlslib-o32.got: Update for
	GOT allocation changes.

2007-09-19  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/testsuite/
	* ld-scripts/rgn-over.s: Use sections .txt and .dat.
	* ld-scripts/rgn-over1.t, ld-scripts/rgn-over2.t,
	ld-scripts/rgn-over3.t, ld-scripts/rgn-over4.t, ld-scripts/rgn-over5.t,
	ld-scripts/rgn-over6.t, ld-scripts/rgn-over7.t: Discard other
	sections.  Handle changed names.
	* ld-scripts/rgn-over1.d, ld-scripts/rgn-over2.d,
	ld-scripts/rgn-over3.d, ld-scripts/rgn-over4.d, ld-scripts/rgn-over5.d,
	ld-scripts/rgn-over6.d, ld-scripts/rgn-over7.d: Expect discarded
	sections and changed names.

2007-09-19  Daniel Jacobowitz  <dan@codesourcery.com>

	bfd/
	* elfxx-mips.c (_bfd_mips_elf_finish_dynamic_sections): Make sure .got
	will be output.

2007-09-18  Maxim Kuvyrkov  <maxim@codesourcery.com>

	* release-notes-csl.xml (ColdFire 51QE support): New.
	
2007-09-07  Nathan Froyd  <froydnj@codesourcery.com>

	gas/
	* config/tc-ppc.c (parse_cpu): Handle -mpmr option.

2007-08-31  Joseph Myers  <joseph@codesourcery.com>

	Revert:
	2007-06-04  Joseph Myers  <joseph@codesourcery.com>
	bfd/
	* elflink.c (bfd_elf_link_record_dynamic_symbol): Do not set
	dynindx for indirect symbols.

2007-08-30  Brooks Moses  <brooks@codesourcery.com>

	Add files missing from 2007-08-20 merge from FSF trunk:
	* ld/emultempl/cr16elf.em: New.
	* ld/testsuite/ld-elf/dl2a.list: New.
	* ld/testsuite/ld-ia64/merge1.d: New.
	* ld/testsuite/ld-ia64/merge1.s: New.
	* ld/testsuite/ld-ia64/merge2.d: New.
	* ld/testsuite/ld-ia64/merge2.s: New.
	* ld/testsuite/ld-ia64/merge3.d: New.
	* ld/testsuite/ld-ia64/merge3.s: New.
	* ld/testsuite/ld-ia64/merge4.d: New.
	* ld/testsuite/ld-ia64/merge4.s: New.
	* ld/testsuite/ld-ia64/merge5.d: New.
	* ld/testsuite/ld-ia64/merge5.s: New.
	* ld/testsuite/ld-pe/secrel_64.d: New.
	* compile: New.
	* lt~obsolete.m4: New.

2007-08-30  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/testsuite/
	* ld-elf/weak-dyn-1.rd: Resolve merge conflict.

2007-08-29  Daniel Jacobowitz  <dan@codesourcery.com>

	Issue #1771
	Backport:
	2007-08-29  Daniel Jacobowitz  <dan@codesourcery.com>
	gas/
	* dwarf2dbg.c (dwarf2_directive_loc): Emit duplicate .loc directives.

	gas/testsuite/
	* gas/lns/lns-duplicate.d, gas/lns/lns-duplicate.s: New.
	* gas/lns/lns.exp: Run lns-duplicate.

2007-08-28  Mark Shinwell  <shinwell@codesourcery.com>
            Joseph Myers  <joseph@codesourcery.com>

	ld/testsuite/
	* ld-scripts/rgn-over1.d: Disallow space before "ld" at start of
	line, not ":".
	* ld-scripts/rgn-over2.d: Likewise.
	* ld-scripts/rgn-over3.d: Likewise.
	* ld-scripts/rgn-over4.d: Likewise.
	* ld-scripts/rgn-over5.d: Likewise.
	* ld-scripts/rgn-over6.d: Likewise.
	* ld-scripts/rgn-over7.d: Likewise.

	Backport from FSF:

	bfd/
	* elf32-arm.c (elf32_arm_compare_mapping): Compare first on vma,
	then on type.

	binutils/testsuite/
	* binutils-all/ar.exp (long_filenames): Delete temporary files on
	the host.
	* binutils-all/arm/objdump.exp: Only check "which $OBJDUMP" if
	host is local.
	* binutils-all/objcopy.exp: Use ${srecfile} to get the name of the
	srec file to be passed to binutils_run.
	(objcopy_test_readelf): Use remote_exec.
	* binutils-all/readelf.exp (readelf_find_size): Use remote_exec.
	(readelf_test): Likewise.
	(readelf_wi_test): Likewise.
	* lib/utils-lib.exp (run_dump_test): Only check "which $binary" if
	host is local.  Use remote_exec.  Use $tempfile not
	tmpdir/bintest.o.

	gas/
	* as.c (main): Flush stderr before printing listings to ensure
	consistent output order across platforms.

	gas/testsuite/
	* lib/gas-defs.exp (gas_version): Use remote_* functions instead
	of exec.
	(gas_host_run): New.
	(gas_run): Use gas_host_run.
	(gas_start): Likewise.
	(run_dump_test): Likewise.
	(objdump): Use gas_host_run.
	(objdump_start_no_subdir): Likewise.
	* lib/gas-dg.exp (gas-dg-test): Use "remote_file host delete".
	* lib/run: Remove.
	* gas/macros/macros.exp: Download app4b.s to host.
	* gas/i386/i386.exp (gas_64_check): Use gas_host_run.
	(gas_32_check): Likewise.
	* gas/maxq10/maxq10.exp (gas_64_check): Likewise
	(gas_32_check): Likewise.
	* gas/maxq20/maxq20.exp (gas_64_check): Likewise
	(gas_32_check): Likewise.
	* gas/sparc/sparc.exp (gas_64_check): Likewise.
	* gas/cfi/cfi.exp: Likewise.
	* gas/elf/elf.exp (run_list_test): Likewise.  Use temporary file
	for readelf output in place of pipe.
	* gas/all/gas.exp: Download incbin.dat to host.
	(do_comment): Allow \r\r\n.

	ld/
	* ldlang.c (sort_sections_by_lma): Sort by internal id after lma
	for stable sort.

	ld/testsuite/
	* ld-elfcomm/elfcomm.exp: Use run_host_cmd.  Only check "which
	$CC" if host is local.
	* ld-checks/checks.exp: Use run_host_cmd.
	* ld-elf/exclude.exp: Likewise.
	* ld-elf/elf.exp: Download merge.ld if host is remote.
	* ld-elf/binutils.exp (binutils_test): Use remote_exec.
	* ld-elf/tls_common.exp: Use run_host_cmd.
	* lib/ld-lib.exp (ld_version): Only check "which $ld" if host is
	local.  Use remote_exec.
	(run_host_cmd): New.
	(run_host_cmd_yesno): New.
	(default_ld_relocate): Use run_host_cmd_yesno.
	(default_ld_link): Likewise.
	(default_ld_simple_link): Use run_host_cmd.
	(default_ld_compile): Only check "which $ccprog" if host is local.
	Use remote_file and remote_exec.
	(default_ld_assemble): Only check "which $as" if host is local.
	Use run_host_cmd.
	(default_ld_nm): Use remote_exec, remote_upload and remote_file.
	(run_dump_test): Use remote_exec, remote_upload and remote_file.
	Only check "which $binary" if host is local.
	(run_ld_link_tests): Use remote_exec, remote_upload and
	remote_file.
	* ld-selective/selective.exp: Only check "which $CXX" if host is
	local.  Use remote_exec.
	* ld-scripts/phdrs.exp: Only check "which $objdump" if host is
	local.  Use run_host_cmd.
	* ld-scripts/phdrs2.exp: Likewise.
	* ld-scripts/weak.exp: Likewise.
	* ld-undefined/weak-undef.exp: Likewise.
	* ld-scripts/crossref.exp: Only check "which $CC" if host is local.
	Use run_host_cmd.
	* ld-scripts/map-address.exp: Upload map_address.map if host is
	remote.
	* ld-srec/srec.exp (run_srec_tests): Use run_host_cmd.  Only check
	"which $CC" and "which $CXX" if host is local.
	* ld-undefined/undefined.exp: Only check "which $CC" if host is
	local.  Use remote_file and run_host_cmd.
	* config/default.exp: Use remote_exec to create tmpdir.

2007-08-28  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (m68k_ip): Add mcfisa_c case.
	(m68k_elf_final_processing): Add EF_M68K_CF_ISA_C_NODIV.

	include/elf/
	* m68k.h (EF_M68K_CF_ISA_C_NODIV): New.

	bfd/
	* elf32-m68k.c (elf32_m68k_object_p): Add EF_M68K_CF_ISA_C_NODIV.
	(elf32_m68k_print_private_bfd_data): Likewise.

2007-08-25  Mark Shinwell  <shinwell@codesourcery.com>

	Add files missing from previous commit:
	gas/testsuite/
	* gas/mips/loongson-2e.d: New.
	* gas/mips/loongson-2e.s: New.
	* gas/mips/loongson-2f.d: New.
	* gas/mips/loongson-2f.s: New.

2007-08-25  Mark Shinwell  <shinwell@codesourcery.com>

	* release-notes-csl.xml
	(Loongson-2E and Loongson-2F processor support): New.

2007-08-25  Mark Shinwell  <shinwell@codesourcery.com>

        bfd/
	* archures.c (bfd_mach_mips_loongson_2e): New.
	(bfd_mach_mips_loongson_2f): New.
	* bfd-in2.h (bfd_mach_mips_loongson_2e): New.
	(bfd_mach_mips_loongson_2f): New.
	* cpu-mips.c: Add I_loongson_2e and I_loongson_2f to
	anonymous enum.
	(arch_info_struct): Add Loongson-2E and Loongson-2F entries.
	* elfxx-mips.c (_bfd_elf_mips_mach): Handle Loongson-2E
	and Loongson-2F flags.
	(mips_set_isa_flags): Likewise.
	(mips_mach_extensions): Add Loongson-2E and Loongson-2F
	entries.

	binutils/
	* readelf.c (get_machine_flags): Handle Loongson-2E and -2F
	flags.
	
	gas/
	* config/tc-mips.c (mips_cpu_info_table): Add loongson2e
	and loongson2f entries.
	* doc/c-mips.texi: Document -march=loongson{2e,2f} options.

	gas/testsuite/
	* gas/mips/mips.exp: Add loongson-2e and -2f tests.
	* gas/mips/loongson-2e.d: New.
	* gas/mips/loongson-2e.s: New.
	* gas/mips/loongson-2f.d: New.
	* gas/mips/loongson-2f.s: New.

	include/elf/
	* mips.h (E_MIPS_MACH_LS2E): New.
	(E_MIPS_MACH_LS2F): New.

	include/opcode/
	* mips.h (INSN_LOONGSON_2E): New.
	(INSN_LOONGSON_2F): New.
	(CPU_LOONGSON_2E): New.
	(CPU_LOONGSON_2F): New.
	(OPCODE_IS_MEMBER): Update for Loongson-2E and -2F flags.

	opcodes/
	* mips-dis.c (mips_arch_choices): Add Loongson-2E and -2F
	entries.
	* mips-opc.c (IL2E): New.
	(IL2F): New.
	(mips_builtin_opcodes): Add Loongson-2E and -2F instructions.
	Allow movz and movn for Loongson-2E and -2F.  Add movnz entry.
	Move coprocessor encodings to the end of the table.  Allow
	certain MIPS V .ps instructions on the Loongson-2E and -2F.

2007-08-24  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Rename 51QE to 51qe.

	binutils/

	* gas/config/tc-m68k.c (mcf51QE_ctrl): Rename to mcf51qe_ctrl.
	(m68k_cpus): Update.

2007-08-24  Mark Shinwell  <shinwell@codesourcery.com>

	include/opcode/
	* mips.h (INSN_ISA*): Redefine certain values as an
	enumeration.  Update comments.
	(mips_isa_table): New.
	(ISA_MIPS*): Redefine to match enumeration.
	(OPCODE_IS_MEMBER): Modify to correctly test new INSN_ISA*
	values.

	opcodes/
	* mips-opc.c (I3_32, I3_33, I4_32, I4_33, I5_33): New.
	(mips_builtin_opcodes): Use these new I* values.

2007-08-23  Nathan Sidwell  <nathan@codesourcery.com>

	bfd/
	* archures.c: Add bfd_mach_mcf_isa_c_nodiv,
	bfd_mach_mcf_isa_c_nodiv_mac & bfd_mach_mcf_isa_c_nodiv_emac.
	* bfd/ieee.c (ieee_write_processor): Update coldfire architecture
	list.
	* bfd-in2.h: Rebuilt.
	* cpu-m68k.c (arch_info_struct): Add isa_c nodiv architectures.
	(m68k_arch_features): Likewise.

2007-08-22  Daniel Jacobowitz  <dan@codesourcery.com>

	* release-notes-csl.xml: Mention GDB support for MIPS -msoft-float
	tags.

2007-08-21  Maxim Kuvyrkov  <maxim@codesourcery.com>

	Add ColdFire V1 devices.

	binutils/gas

	* config/tc-m68k.c (mcf51QE_ctrl): Define 51QE control registers.
	(m68k_cpus): Define 51QE cpu.

2007-08-20  Brooks Moses  <brooks@codesourcery.com>

        Merged from //mirrors/binutils/trunk revision 179541.

2007-08-16  Daniel Jacobowitz  <dan@codesourcery.com>

	* release-notes-csl.xml: Mention MIPS linker warnings.

2007-08-16  Daniel Jacobowitz  <dan@codesourcery.com>

	ld/testsuite/
	* ld-powerpc/attr-gnu-8-31.d, ld-powerpc/attr-gnu-8-1.s,
	ld-powerpc/attr-gnu-8-11.d, ld-powerpc/attr-gnu-8-3.s: New.

	include/elf/
	* ppc.h (Tag_GNU_Power_ABI_Vector): New.

	binutils/
	* readelf.c (display_power_gnu_attribute): Handle
	Tag_GNU_Power_ABI_Vector.

	bfd/
	* elf32-ppc.c (ppc_elf_merge_obj_attributes): Handle
	Tag_GNU_Power_ABI_Vector.

2007-08-11  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	bfd/
	2007-08-11  Richard Sandiford  <richard@codesourcery.com>

	* config.bfd (sh-*-vxworks): Define targ_underscore to "yes".

2007-08-09  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (relaxed_symbol_addr): Compensate for alignment.

	gas/testsuite/
	* gas/arm/relax_load_align.d: new test.
	* gas/arm/relax_load_align.s: new test.

2007-08-07  Kazu Hirata  <kazu@codesourcery.com>

	Backport from mainline:
	ld/testsuite/
	2007-05-17  Paul Brook  <paul@codesourcery.com>
	* ld-elf/multibss1.s: Use %nobits instead of @nobits.

2007-08-03  Daniel Jacobowitz  <dan@codesourcery.com>

	Backport from mainline:
	ld/testsuite/
	2007-08-03  Daniel Jacobowitz  <dan@codesourcery.com>
	* ld-srec/srec.exp: XFAIL for powerpc*-*-*.

2007-07-23  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	bfd/
	2007-07-23  Richard Sandiford  <richard@codesourcery.com>

	* elflink.c (_bfd_elf_fix_symbol_flags): Only assert the type
	of weakdef->root.type if weakdef has no regular definition.

	ld/testsuite/
	2007-07-23  Richard Sandiford  <richard@codesourcery.com>

	* ld-elf/weak-dyn-1a.s, ld-elf/weak-dyn-1b.s, ld-elf/weak-dyn-1.ld,
	* ld-elf/weak-dyn-1.rd: New test.
	* ld-elf/elf.exp: Run it.

2007-07-18  Zack Weinberg  <zack@codesourcery.com>

	Issue 1494
	ld/
	* ldlang.c (lang_check_section_addresses): Also report size of
	overflow for any overflowed memory regions.
	(os_region_check): Diagnose an overflowed region only once per
	region.  Do not reset region->current on overflow. 

	ld/testsuite/
	* ld-scripts/rgn-over.exp: New driver.
	* ld-scripts/rgn-over.s: New file.
	* ld-scripts/rgn-over1.d, ld-scripts/rgn-over1.t
	* ld-scripts/rgn-over2.d, ld-scripts/rgn-over2.t
	* ld-scripts/rgn-over3.d, ld-scripts/rgn-over3.t
	* ld-scripts/rgn-over4.d, ld-scripts/rgn-over4.t
	* ld-scripts/rgn-over5.d, ld-scripts/rgn-over5.t
	* ld-scripts/rgn-over6.d, ld-scripts/rgn-over6.t
	* ld-scripts/rgn-over7.d, ld-scripts/rgn-over7.t:
	New test cases.

2007-07-13  Nathan Sidwell  <nathan@codesourcery.com>

	ld/testsuite/
	* ld-scripts/assert.t: Tweak to avoid relying on empty's VMA being
	zero.

2007-07-12  Nathan Sidwell  <nathan@codesourcery.com>

	#1765
	ld/
	* scripttempl/pe.sc: Don't include .gcc_except_table and
	.eh_frame on partial links.

2007-07-09  Nathan Sidwell  <nathan@codesourcery.com>

	Issue 1702
	bfd/
	* elf32-ppc.c (ppc_elf_adjust_dynamic_symbol): Don't eliminate
	copy relocs on vxworks.

2007-07-05  Kazu Hirata  <kazu@codesourcery.com>

	Issue 1775
	gas/
	* config/m68k-parse.h (m68k_register): Use MBO instead of MBB.
	(last_movec_reg): Change to MBO.
	* config/tc-m68k.c (fido_ctrl): Use MBO instead of MBB.
	(m68k_ip): Use MBO instead of MBO.
	(init_table): Use MBO instead of MBO.  Add an entry for mbo.

	gas/testsuite/
	* gas/m68k/fido.s: Add tests for %mbo.
	* gas/m68k/fido.d: Update accordingly.

	opcodes/
	* m68k-dis.c (print_insn_arg): Use %mbo instead of %mbb.

	* release-notes-csl.xml: Add a note for the addition of %mbo.

2007-07-05  Nathan Sidwell  <nathan@codesourcery.com>

	* opcodes/ppc-opc (PPC7450): New.
	(powerpc_opcodes): Use it in dcba.

2007-07-04  Richard Sandiford  <richard@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_cpu_info_table): Add 74kf3_2.
	* doc/c-mips.texi: Document it.

2007-07-04  Richard Sandiford  <richard@codesourcery.com>

	gas/
	* config/tc-mips.c (mips_cpu_info_table): Add new entries for
	{24k,24ke,34k,74k}f{2_1,1_1,x}.
	* doc/c-mips.texi: Document them.

2007-07-03  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	* elf32-arm.c (elf32_arm_merge_eabi_attributes): Copy type from
	input attributes if value has been copied.

	ld/testsuite/
	* ld-arm/attr-merge-2a.s, ld-arm/attr-merge-2b.s,
	ld-arm/attr-merge-2.attr: New.
	* ld-arm/arm-elf.exp (armelftests): Add new test.

2007-07-02  Nathan Froyd  <froydnj@codesourcery.com>

	Backport from FSF:

	bfd/
	* elf32-ppc.c (ppc_elf_info_to_howto): Check for invalid relocation
	types.

2007-07-02  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	bfd/
	* elf32-arm.c (bfd_elf32_arm_process_before_allocation): Suppress
	call veneers for call relocations against undefined symbols.
	(elf32_arm_final_link_relocate): Turn call to undefined symbol
	into a jump to the next instruction.

	ld/testuite/
	* ld-arm/arm-elf.exp (armelftests): Add callweak.
	* ld-arm/callweak.d: New test.
	* ld-arm/callweak.s: New test.

2007-07-02  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	* elfxx-mips.c (mips_elf_calculate_relocation): Handle
	R_MIPS_TLS_DTPREL32 and R_MIPS_TLS_DTPREL64.
	* elf64-mips.c (mips_elf64_howto_table_rela): Support
	R_MIPS_TLS_DTPREL64.

	gas/
	* config/tc-mips.c (s_dtprelword, s_dtpreldword,
	s_dtprel_internal): New.
	(mips_pseudo_table): Add .dtprelword and .dtpreldword.
	(md_apply_fix): Handle BFD_RELOC_MIPS_TLS_DTPREL32 and
	BFD_RELOC_MIPS_TLS_DTPREL64.

2007-06-29  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	* elf32-ppc.c (ppc_elf_merge_obj_attributes): New.
	(ppc_elf_merge_private_bfd_data): Call it.

	binutils/
	* readelf.c (display_power_gnu_attribute, process_power_specific):
	New.
	(process_arch_specific): Call process_power_specific.

	include/elf/
	* ppc.h (Tag_GNU_Power_ABI_FP): Define.

	ld/testsuite/
	* ld-powerpc/attr-gnu-4-0.s, ld-powerpc/attr-gnu-4-00.d,
	ld-powerpc/attr-gnu-4-01.d, ld-powerpc/attr-gnu-4-02.d,
	ld-powerpc/attr-gnu-4-1.s, ld-powerpc/attr-gnu-4-10.d,
	ld-powerpc/attr-gnu-4-11.d, ld-powerpc/attr-gnu-4-12.d,
	ld-powerpc/attr-gnu-4-13.d, ld-powerpc/attr-gnu-4-2.s,
	ld-powerpc/attr-gnu-4-20.d, ld-powerpc/attr-gnu-4-21.d,
	ld-powerpc/attr-gnu-4-22.d, ld-powerpc/attr-gnu-4-3.s,
	ld-powerpc/attr-gnu-4-31.d: New.
	* ld-powerpc/powerpc.exp: Run these new tests.

2007-06-29  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	gas/
	* as.c (main): Only call create_obj_attrs_section if IS_ELF.

2007-06-29  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	* elfxx-mips.c (mips_elf_merge_obj_attributes): New.
	(_bfd_mips_elf_merge_private_bfd_data): Call it.

	binutils/
	* readelf.c (display_mips_gnu_attribute): New.
	(process_mips_specific): Call process_attributes.

	include/elf/
	* mips.h (Tag_GNU_MIPS_ABI_FP): Define.

	ld/testsuite/
	* ld-mips-elf/attr-gnu-4-0.s, ld-mips-elf/attr-gnu-4-00.d,
	ld-mips-elf/attr-gnu-4-01.d, ld-mips-elf/attr-gnu-4-02.d,
	ld-mips-elf/attr-gnu-4-03.d, ld-mips-elf/attr-gnu-4-1.s,
	ld-mips-elf/attr-gnu-4-10.d, ld-mips-elf/attr-gnu-4-11.d,
	ld-mips-elf/attr-gnu-4-12.d, ld-mips-elf/attr-gnu-4-13.d,
	ld-mips-elf/attr-gnu-4-14.d, ld-mips-elf/attr-gnu-4-2.s,
	ld-mips-elf/attr-gnu-4-20.d, ld-mips-elf/attr-gnu-4-21.d,
	ld-mips-elf/attr-gnu-4-22.d, ld-mips-elf/attr-gnu-4-23.d,
	ld-mips-elf/attr-gnu-4-3.s, ld-mips-elf/attr-gnu-4-30.d,
	ld-mips-elf/attr-gnu-4-31.d, ld-mips-elf/attr-gnu-4-32.d,
	ld-mips-elf/attr-gnu-4-33.d, ld-mips-elf/attr-gnu-4-4.s,
	ld-mips-elf/attr-gnu-4-41.d: New.
	* ld-mips-elf/mips-elf.exp: Run these new tests.

2007-06-29  Joseph Myers  <joseph@codesourcery.com>

	Backport from FSF:

	bfd/
	* elf-attrs.c: New.
	* Makefile.am (BFD32_BACKENDS): Add elf-attrs.lo.
	(BFD32_BACKENDS_CFILES): Add elf-attrs.c.
	(elf-attrs.lo): Generate dependencies.
	* Makefile.in: Regenerate.
	* configure.in (elf): Add elf-attrs.lo.
	* configure: Regenerate.
	* elf-bfd.h (struct elf_backend_data): Add entries for object
	attributes.
	(NUM_KNOWN_OBJ_ATTRIBUTES, obj_attribute, obj_attribute_list,
	OBJ_ATTR_PROC, OBJ_ATTR_GNU, OBJ_ATTR_FIRST, OBJ_ATTR_LAST,
	Tag_NULL, Tag_File, Tag_Section, Tag_Symbol, Tag_compatibility):
	New.
	(struct elf_obj_tdata): Add entries for object attributes.
	(elf_known_obj_attributes, elf_other_obj_attributes,
	elf_known_obj_attributes_proc, elf_other_obj_attributes_proc):
	New.
	(bfd_elf_obj_attr_size, bfd_elf_set_obj_attr_contents,
	bfd_elf_get_obj_attr_int, bfd_elf_add_obj_attr_int,
	bfd_elf_add_proc_attr_int, bfd_elf_add_obj_attr_string,
	bfd_elf_add_proc_attr_string, bfd_elf_add_obj_attr_compat,
	bfd_elf_add_proc_attr_compat, _bfd_elf_attr_strdup,
	_bfd_elf_copy_obj_attributes, _bfd_elf_obj_attrs_arg_type,
	_bfd_elf_parse_attributes, _bfd_elf_merge_object_attributes): New.
	* elf.c (_bfd_elf_copy_private_bfd_data): Copy object attributes.
	(bfd_section_from_shdr): Handle attributes sections.
	* elflink.c (bfd_elf_final_link): Handle attributes sections.
	* elfxx-target.h (elf_backend_obj_attrs_vendor,
	elf_backend_obj_attrs_section, elf_backend_obj_attrs_arg_type,
	elf_backend_obj_attrs_section_type): New.
	(elfNN_bed): Update.
	* elf32-arm.c (NUM_KNOWN_ATTRIBUTES, aeabi_attribute,
	aeabi_attribute_list): Remove.
	(struct elf32_arm_obj_tdata): Remove object attributes fields.
	(check_use_blx, bfd_elf32_arm_set_vfp11_fix, using_thumb2,
	elf32_arm_copy_private_bfd_data, elf32_arm_merge_eabi_attributes):
	Update for new object attributes interfaces.
	(uleb128_size, is_default_attr, eabi_attr_size,
	elf32_arm_eabi_attr_size, write_uleb128, write_eabi_attribute,
	elf32_arm_set_eabi_attr_contents, elf32_arm_bfd_final_link,
	elf32_arm_new_eabi_attr, elf32_arm_get_eabi_attr_int,
	elf32_arm_add_eabi_attr_int, attr_strdup,
	elf32_arm_add_eabi_attr_string, elf32_arm_add_eabi_attr_compat,
	copy_eabi_attributes, elf32_arm_parse_attributes): Remove.  Moved
	to generic code in elf-attrs.c.
	(elf32_arm_obj_attrs_arg_type): New.
	(elf32_arm_fake_sections): Do not handle .ARM.attributes.
	(elf32_arm_section_from_shdr): Do not handle SHT_ARM_ATTRIBUTES.
	(bfd_elf32_bfd_final_link): Remove.
	(elf_backend_obj_attrs_vendor, elf_backend_obj_attrs_section,
	elf_backend_obj_attrs_arg_type,
	elf_backend_obj_attrs_section_type): New.
	* elf32-bfin.c (bfin_elf_copy_private_bfd_data): Copy object
	attributes.
	* elf32-frv.c (frv_elf_copy_private_bfd_data): Likewise.
	* elf32-iq2000.c (iq2000_elf_copy_private_bfd_data): Likewise.
	* elf32-mep.c (mep_elf_copy_private_bfd_data): Likewise.
	* elf32-mt.c (mt_elf_copy_private_bfd_data): Likewise.
	* elf32-sh.c (sh_elf_copy_private_data): Likewise.
	* elf64-sh64.c (sh_elf64_copy_private_data_internal): Likewise.

	binutils/
	* readelf.c (display_gnu_attribute): New.
	(process_arm_specific): Rearrange as process_attributes.
	(process_arm_specific): Replace by wrapper of process_attributes.

	gas/
	* as.c (create_obj_attrs_section): New.
	(main): Call create_obj_attrs_section for ELF.
	* read.c (s_gnu_attribute, skip_whitespace, skip_past_char,
	skip_past_comma, s_vendor_attribute): New.
	(potable): Add gnu_attribute for ELF.
	* read.h (s_vendor_attribute): Declare.
	* config/tc-arm.c (s_arm_eabi_attribute): Replace by wrapper
	round s_vendor_attribute.
	(aeabi_set_public_attributes): Update for new attributes
	interfaces.
	(arm_md_end): Remove attributes contents setting now done
	generically.

	include/elf/
	* arm.h (elf32_arm_add_eabi_attr_int,
	elf32_arm_add_eabi_attr_string, elf32_arm_add_eabi_attr_compat,
	elf32_arm_get_eabi_attr_int, elf32_arm_set_eabi_attr_contents,
	elf32_arm_eabi_attr_size, Tag_NULL, Tag_File, Tag_Section,
	Tag_Symbol, Tag_compatibility): Remove.
	* common.h (SHT_GNU_ATTRIBUTES): Define.

	ld/
	* emulparams/armelf.sh (OTHER_SECTIONS): Remove .ARM.attributes.
	(ATTRS_SECTIONS): Define.
	* scripttempl/elf.sc, scripttempl/elf32sh-symbian.sc,
	scripttempl/elf_chaos.sc, scripttempl/elfi370.sc,
	scripttempl/elfxtensa.sc: Handle ATTRS_SECTIONS.

2007-06-26  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (parse_operands): Accept generic coprocessor regs
	for OP_RVC.
	(reg_names): Add fpinst, pfinst2, mvfr0 and mvfr1.

	gas/testsuite/
	* gas/arm/vfp1xD.d: Add new fmrx/fmxr tests.
	* gas/arm/vfp1xD.s: Ditto.
	* gas/arm/vfp1xD_t2.d: Ditto.
	* gas/arm/vfp1xD_t2.s: Ditto.

	opcodes/
	* arm-dis.c (coprocessor_opcodes): Add fmxr/fmrx mvfr0/mvfr1.

2007-06-26  Joseph Myers  <joseph@codesourcery.com>

	* release-notes-csl.xml: Add release notes for attribute merging
	fix.

2007-06-26  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elf32-arm.c (copy_eabi_attributes): Copy type of attributes.

	ld/testsuite/
	* ld-arm/attr-merge.s, ld-arm/attr-merge.attr: New.
	* ld-arm/arm-elf.exp (armelftests): Add new test.

2007-06-25  Paul Brook  <paul@codesourcery.com>

	gas/
	* config/tc-arm.c (do_t_mov_cmp): Handle shift by register and
	narrow shift by immediate.

	gas/testsuite/
	* gas/arm/thumb32.s: Add tests for shift instructions.
	* gas/arm/thumb32.d: Ditto.

2007-06-25  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	bfd/
	2007-06-25  Richard Sandiford  <richard@codesourcery.com>

	* elfxx-mips.c (mips_elf_calculate_relocation): Allow local stubs
	to be used for calls from MIPS16 code.

	gas/
	2007-06-25  Richard Sandiford  <richard@codesourcery.com>

	* config/tc-mips.h (TC_SYMFIELD_TYPE): New.
	* config/tc-mips.c (append_insn): Record which symbols have
	R_MIPS16_26 relocations against them.
	(mips_fix_adjustable): Don't reduce relocations against such symbols.

	ld/testsuite/
	2007-06-25  Richard Sandiford  <richard@codesourcery.com>

	* ld-mips-elf/mips16-local-stubs-1.s,
	* ld-mips-elf/mips16-local-stubs-1.d: New tests.
	* ld-mips-elf/mips-elf.exp: Run them.

2007-06-18  Nathan Sidwell  <nathan@codesourcery.com>

	Bug 1722
	gas/testsuite/
	* gas/m68k/mcf-coproc.d: New.
	* gas/m68k/mcf-coproc.s: New.
	* gas/m68k/all.exp: Add it.

	gas/
	* config/tc-m68k.c (m68k_ip): Add j & K operand types.
	(install_operand): Add E encoding.
	(md_begin): Check and skip initial '.' arg character.
	(get_num): Add 0..511 case.

	include/
	* opcode/m68k.h: Document j K & E.

	opcodes/
	* m68k-dis.c (fetch_arg): Add E.  Replace length switch with
	direct masking.
	(print_ins_arg): Add j & K operand types.
	(match_insn_m68k): Check and skip initial '.' arg character.
	(m68k_scan_mask): Likewise.
	* m68k-opc.c (m68k_opcodes): Add coprocessor instructions.

2007-06-14  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (mcf52235_ctrl): Add cache registers.
	(mcf5253_ctrl): Add RAMBAR, MBAR, MBAR2.
	(mcf5407_ctrl): New.
	(m68k_cpus): Adjust 5407 entry.

2007-06-13  Joseph Myers  <joseph@codesourcery.com>

	ld/
	* config.in: Regenerate.
	* ld.h (args_type): Add poison_system_directories.
	* ld.texinfo (--no-poison-system-directories): Document.
	* ldfile.c (ldfile_add_library_path): Check
	command_line.poison_system_directories.
	* ldmain.c (main): Initialize
	command_line.poison_system_directories.
	* lexsup.c (enum option_values): Add
	OPTION_NO_POISON_SYSTEM_DIRECTORIES.
	(ld_options): Add --no-poison-system-directories.
	(parse_args): Handle new option.

2007-06-13  Nathan Sidwell  <nathan@codesourcery.com>

	ld/
	* ldexp.c (foldname): ALIGNOF should not be divided by opb.

2007-06-11  Julian Brown  <julian@codesourcery.com>

	bfd/
	* elf32-arm.c (bfd_elf32_arm_vfp11_erratum_scan): Skip BFDs with
	EXEC_P or DYNAMIC flags, and skip sections which are being linked
	with --just-symbols (-R).

2007-06-11  Nathan Sidwell  <nathan@codesourcery.com>

	binutils/
	* dwarf.c (decode_location_expression): Add DW_OP_form_tls_address.

	ld/
	* ldlex.l, ldgram.y: Add ALIGNOF.
	* ldexp.c (exp_print_token, foldname): Likewise.
	* ld.texinfo: Likewise.

	ld/testsuite/
	* ld-scripts/alignof.s: New.
	* ld-scripts/alignof.t: New
	* ld-scripts/alignof.exp: New.

2007-06-06  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (s_align): Pad code sections appropriately.

	gas/testsuite/
	* gas/arm/thumb.d: Update expected output.
	* gas/arm/thumb2_relax.d: Ditto.

2007-06-06  Joseph Myers  <joseph@codesourcery.com>
            Paul Brook  <paul@codesourcery.com>

	gas/
	* remap.c: New.
	* as.h (remap_debug_filename, add_debug_prefix_map): Declare.
	* as.c (show_usage): Document --debug-prefix-map option.
	(parse_args): Handle --debug-prefix-map.
	* dwarf2dbg.c (out_file_list, out_debug_info): Remap debug paths.
	* stabs.c (stabs_generate_asm_file): Remap debug paths.
	* Makefile.am (GAS_CFILES): Add remap.c
	(GENERIC_OBJS): Add remap.o.
	* Makefile.in: Regenerate.
	* doc/as.texinfo (--debug-prefix-map): Document.

2007-06-05  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (insns): Correct Thumb-2 ldrd/strd opcodes.

	gas/testsuite/
	* gas/arm/thumb32.d: Add writeback addressing mode tests.
	* gas/arm/thumb32.s: Update expected output.

	opcodes/
	* arm-dis.c (thumb32_opcodes): Display writeback ldrd/strd addresses.

2007-06-04  Joseph Myers  <joseph@codesourcery.com>

	bfd/
	* elflink.c (bfd_elf_link_record_dynamic_symbol): Do not set
	dynindx for indirect symbols.

2007-05-31  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (insns): Allow strex on M profile cores.

2007-05-27  Nathan Sidwell  <nathan@codesourcery.com>

	Bug 1652
	gas/
	* app.c (do_scrub_chars): Cope with \ at end of buffer.
	
	* release-notes-csl.xml: Document fix.

2007-03-25  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	gas/
	* config/tc-arm.c (T2_SUBS_PC_LR): Define.
	(do_t_add_sub): Correctly encode subs pc, lr, #const.
	(do_t_mov_cmp): Correctly encode movs pc, lr.

	gas/testsulte/
	* gas/arm/thumb32.s: Add tests for subs pc, lr.
	* gas/arm/thumb32.d: Change error-output: to stderr:.
	Update expected output.

2007-05-24  Nathan Sidwell  <nathan@codesourcery.com>

	ld/
	* ldlex.l: ASSERT is recognized in SCRIPT env.  NAMES cannot
	contain commas in EXP env.
	* ldgram.y (extern_name_list): Push to EXP env, move body to ...
	(extern_name_list_body): ... here.
	(script_file, ifile_list): Reformat.
	(statement): Add ASSERT.

	ld/testsuite/
	* ld/ld-scripts/assert.t: Add additional cases.
	* ld-scripts/extern.t, ld-scripts/extern.s,
	ld-scripts/extern.exp: New.

2007-05-22  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	ld/testsuite/
	* ld-arm/arm-pic-veneer.d: Update expected output.
	* ld-arm/arm-call.d: Ditto.

	bfd/
	* elf32-arm.c (output_arch_syminfo): Replace plt_shndx and plt_offset
	with sec and sec_shndx.
	(elf32_arm_ouput_plt_map_sym): Use them.
	(elf32_arm_output_arch_local_syms): Output mapping symbols for
	interworking glue.

2007-05-22  Paul Brook  <paul@codesourcery.com>

	Backport from FSF.
	bunutils/
	* objdump.c (find_symbol_for_address): Merge section and target
	specific filtering code.

	ld/testsuite/
	* ld-arm-mixed-lib.d: Update expected output.
	* ld-arm/arm-app.d: Ditto.
	* ld-arm/mixed-app.d: Ditto.
	* ld-arm/arm-lib-plt32.d: Ditto.
	* ld-arm/arm-app-abs32.d: Ditto.
	* ld-arm/mixed-app-v5.d: Ditto.
	* ld-arm/armthumb-lib.d: Ditto.
	* ld-arm/arm-lib.d: Ditto.

	gas/testsuite/
	* gas/arm/backslash-at.d: Update expected output.

2007-05-21  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	binutils/
	2007-05-21  Richard Sandiford  <richard@codesourcery.com>

	* objdump.c (disassemble_bytes): Ignore disassembler_needs_relocs
	for executables and shared libraries.

	ld/testsuite/
	2007-05-21  Richard Sandiford  <richard@codesourcery.com>

	* ld-arm/emit-relocs1.d, ld-arm/emit-relocs1.s,
	* ld-arm/emit-relocs1-vxworks.d: New tests.
	* ld-arm/arm-elf.exp: Run them.
	* ld-arm/vxworks1.dd: Expect proper branch targets.

2007-05-18  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (LONG_BRANCH_VIA_COND): New.
	(BRANCHBWPL, FRAG_VAR_SIZE): New.
	(md_relax_table): Add BRANCHBWPL entries.
	(m68k_ip): Choose BRANCHBWPL relaxation if necessary.
	(md_assemble): Use FRAG_VAR_SIZE.
	(md_convert_frag_1): Add BRANCHBWPL cases.
	(md_estimate_size_before_relaz): Likewise.

	gas/testsuite/
	* gas/m68k/br-isaa.d: Dump relocs too.
	* gas/m68k/br-isab.d: Likewise.
	* gas/m68k/br-isac.d: Likewise.  Adjust for long branch relaxation.

2007-05-18  Joseph Myers  <joseph@codesourcery.com>

	* release-notes-csl.xml: Add release notes for .set change.

2007-05-18  Joseph Myers  <joseph@codesourcery.com>

	ld/testsuite/
	* ld-elf/group.ld: Discard .reginfo.

2007-05-18  Joseph Myers  <joseph@codesourcery.com>

	gas/
	* config/tc-mips.c (s_mipsset): Use generic s_set for directives
	containing a comma.

2007-05-18  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	ld/
	2007-05-18  Richard Sandiford  <richard@codesourcery.com>

	* emulparams/elf32ebmipvxworks.sh (OTHER_READONLY_SECTIONS)
	(OTHER_READWRITE_SECTIONS): Define.  Add .rdata sections.

2007-05-18  Paul Brook  <paul@codesourcery.com>

	Backport from FSF:
	bfd/
	* elf32-arm.c (ARM2THUMB_V5_STATIC_GLUE_SIZE): Define.
	(a2t1v5_ldr_insn, a2t1v5_ldr_insn): New.
	(record_arm_to_thumb_glue): Add v5t non-pic glue.
	(elf32_arm_create_thumb_stub): Ditto.

	ld/testsuite/
	* ld-arm/arm-call.d: Update expected output.

2007-05-16  Paul Brook  <paul@codesourcery.com>

	bfd/
	* elf32-arm.c (elf32_arm_link_hash_entry): Add
	plt_maybe_thumb_refcount.
	(elf32_arm_link_hash_newfunc): Set plt_maybe_thumb_refcount.
	(elf32_arm_copy_indirect_symbol): Ditto.
	(elf32_arm_adjust_dynamic_symbol): Ditto.
	(bfd_elf32_arm_process_before_allocation): Handle R_ARM_THM_JUMP24.
	(arm_add_to_rel): Ditto.
	(elf32_arm_final_link_relocate): Merge R_ARM_THM_JUMP24 with
	R_ARM_THM_CALL.  Handle R_ARM_THM_JUMP19 against a PLT stub.
	(elf32_arm_gc_sweep_hook): Call check_use_blx.  Update plt counts
	for R_ARM_THM_JUMP24 and R_ARM_THM_JUMP19.
	(elf32_arm_check_relocs): Update plt counts for R_ARM_THM_JUMP24
	and R_ARM_THM_JUMP19.  
	(allocate_dynrelocs): Use plt_maybe_thumb_refcount.
	(elf32_arm_finish_dynamic_symbol): Ditto.
	(elf32_arm_output_plt_map): Ditto.

2007-05-16  Paul Brook  <paul@codesourcery.com>

	* config/tc-arm.c (v7m_psrs): Add uppercase PSR names and xpsr.

2007-05-16  Joseph Myers  <joseph@codesourcery.com>

	binutils/testsuite/
	* binutils-all/strip-3.d: Strip .pdr section.

2007-05-16  Nathan Sidwell  <nathan@codesourcery.com>

	ld/testsuite/
	* ld-m68k-merge-error-1a.d: Mismatch is an error.
	* ld-m68k-merge-error-1b.d: Likewise.
	* ld-m68k-merge-error-1c.d: Likewise.
	* ld-m68k-merge-error-1d.d: Likewise.
	* ld-m68k-merge-error-1e.d: Likewise.

	gas/
	* config/tc-m68k.c (md_apply_fix): Show value of out of range
	fixups in error message.
	(md_conver_frag_1): Propagate the fix source location and use
	as_bad_where rather than fatal, for better error messages.

2007-05-15  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	ld/testsuite/
	2007-05-15  Richard Sandiford  <richard@codesourcery.com>

	* ld-arm/vxworks1.ld: Swap .bss and .data.
	* ld-arm/vxworks1-lib.rd: Update accordingly.
	* ld-arm/vxworks1-lib.td: New test.
	* ld-arm/arm-elf.exp: Run it.

	* ld-i386/vxworks1.ld: Swap .bss and .data.
	* ld-i386/vxworks1-lib.rd: Update accordingly.
	* ld-i386/vxworks1-lib.td: New test.
	* ld-i386/i386.exp: Run it.

	* ld-mips-elf/vxworks1.ld: Swap .bss and .data.
	* ld-mips-elf/vxworks1-lib.rd: Update accordingly.
	* ld-mips-elf/vxworks1.rd: Likewise.

	* ld-powerpc/vxworks1.ld: Swap .bss and .data.
	* ld-powerpc/vxworks1-lib.rd: Update accordingly.
	* ld-powerpc/vxworks1-lib.td: New test.
	* ld-powerpc/powerpc.exp: Run it.

	* ld-sh/vxworks1.ld: Swap .bss and .data.
	* ld-sh/vxworks1-lib.rd: Update accordingly.
	* ld-sh/vxworks1-lib.td: New test.
	* ld-sh/sh-vxworks.exp: Run it.

	* ld-sparc/vxworks1.ld: Swap .bss and .data.
	* ld-sparc/vxworks1-lib.rd: Update accordingly.
	* ld-sparc/vxworks1-lib.td: New test.
	* ld-sparc/sparc.exp: Run it.

2007-05-15  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	bfd/
	2007-05-15  Richard Sandiford  <richard@codesourcery.com>

	* elfxx-mips.c (mips_elf_create_local_got_entry): Remove
	input_section argument.  Create .rela.dyn relocations against
	symbol 0 rather than the section symbol.
	(mips_elf_local_got_index): Remove input_section argument.
	Update call to mips_elf_create_local_got_entry.
	(mips_elf_got_page, mips_elf_got16_entry): Likewise.
	(mips_elf_calculate_relocation): Update calls to
	mips_elf_local_got_index, mips_elf_got16_entry and mips_elf_got_page.

	ld/testsuite/
	2007-05-15  Richard Sandiford  <richard@codesourcery.com>

	* ld-mips-elf/vxworks1-lib.rd: Expect the GOT relocation to be
	against symbol 0.

2007-05-14  Richard Sandiford  <richard@codesourcery.com>

	bfd/
	* coff-rs6000.c (rs6000coff_vec, pmac_xcoff_vec): Initialize
	_bfd_copy_link_hash_symbol_type.

2007-05-14  Joseph Myers  <joseph@codesourcery.com>

	Backport from mainline:
	bfd/
	2007-05-12  Alan Modra  <amodra@bigpond.net.au>
	PR 4497
	* elf-eh-frame.c (struct cie): Add "local_personality".  Make
	"personality" a union.
	(cie_eq): Compare local_personality too.  Adjust personality
	comparison.
	(_bfd_elf_discard_section_eh_frame): Check binding on personality
	reloc sym to allow for bad symtab.  Use stashed local syms rather
	than reading personality local sym.  Handle discarded sections.

2007-05-14  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	ld/testsuite/
	2007-05-14  Richard Sandiford  <richard@codesourcery.com>

	* ld-sh/vxworks1.dd: Remove hexadecimal prefixes from constant pool
	contents.  Consistently use "!" as the comment character.
	Consistently use _PROCEDURE_LINKAGE_TABLE_ in the first PLT entry.
	* ld-sh/vxworks1-le.dd: Likewise.
	* ld-sh/vxworks1-lib.dd: Likewise.
	* ld-sh/vxworks1-lib-le.dd: Likewise.
	* ld-sh/vxworks3.dd: Likewise.
	* ld-sh/vxworks3-le.dd: Likewise.

2007-05-11  Paul Brook  <paul@codesourcery.com>

	ld/
	* ldexp.c (exp_fold_tree_1): Copy symbol type for simple
	assignments.

	ld/testsuite/
	* ld-arm/script-type.s: New test.
	* ld-arm/arm-elf.exp: New test.
	* ld-arm/script-type.ld: New test.

	bfd/
	* elf-bfd.h (_bfd_elf_copy_link_hash_symbol_type): Add prototype.
	* libbfd-in.h (_bfd_generic_copy_link_hash_symbol_type): Add
	prototype.
	* elflink.c (_bfd_elf_copy_link_hash_symbol_type): New function.
	* linker.c (_bfd_generic_copy_link_hash_symbol_type): New
	function.
	* targets.c (BFD_JUMP_TABLE_LINK, struct bfd_target): Add
	_copy_link_hash_symbol_type.
	* aout-adobe.c (aout_32_bfd_copy_link_hash_symbol_type): Define.
	* aout-target.h (MY_bfd_copy_link_hash_symbol_type): Define.
	* aout-tic30.c (MY_bfd_copy_link_hash_symbol_type): Define.
	* binary.c (binary_bfd_copy_link_hash_symbol_type): Define.
	* bout.c (b_out_bfd_copy_link_hash_symbol_type): Define.
	* coffcode.h (coff_bfd_copy_link_hash_symbol_type): Define.
	* elfxx-target.h (bfd_elfNN_bfd_copy_link_hash_symbol_type): Define.
	* i386msdos.c (msdos_bfd_copy_link_hash_symbol_type): Define.
	* i386os9k.c (os9k_bfd_copy_link_hash_symbol_type): Define.
	* ieee.c (ieee_bfd_copy_link_hash_symbol_type): Define.
	* ihex.c (ihex_bfd_copy_link_hash_symbol_type): Define.
	* libecoff.h (_bfd_ecoff_bfd_copy_link_hash_symbol_type): Define.
	* mach-o.c (bfd_mach_o_bfd_copy_link_hash_symbol_type): Define.
	* mmo.c (mmo_bfd_copy_link_hash_symbol_type): Define.
	* nlm-target.h (nlm_bfd_copy_link_hash_symbol_type): Define.
	* oasys.c (oasys_bfd_copy_link_hash_symbol_type): Define.
	* pef.c (bfd_pef_bfd_copy_link_hash_symbol_type): Define.
	* ppcboot.c (ppcboot_bfd_copy_link_hash_symbol_type): Define.
	* som.c (som_bfd_copy_link_hash_symbol_type): Define.
	* srec.c (srec_bfd_copy_link_hash_symbol_type): Define.
	* tekhex.c (tekhex_bfd_copy_link_hash_symbol_type): Define.
	* versados.c (versados_bfd_copy_link_hash_symbol_type): Define.
	* vms.c (vms_bfd_copy_link_hash_symbol_type): Define.
	* xsym.c (bfd_sym_bfd_copy_link_hash_symbol_type): Define.
	* bfd-in2.h: Regenerate.
	* libbfd.h: Regenerate.

2007-05-11  Joseph Myers  <joseph@codesourcery.com>

	Backport from mainline:
	gas/
	2007-04-30  Alan Modra  <amodra@bigpond.net.au>
	PR 4436
	* config/tc-ppc.c (ppc_insert_operand): Disable range check if
	min > max.

	opcodes/
	2007-04-30  Alan Modra  <amodra@bigpond.net.au>
	PR 4436
	* ppc-opc.c (powerpc_operands): Correct bitm for second entry of MBE.

	gas/
	2007-05-02  Alan Modra  <amodra@bigpond.net.au>
	PR 4448
	* config/tc-ppc.c (ppc_insert_operand): Don't increase min for
	PPC_OPERAND_PLUS1.

	include/opcode/
	2007-05-02  Alan Modra  <amodra@bigpond.net.au>
	* ppc.h (PPC_OPERAND_PLUS1): Update comment.

2007-05-10  Carlos O'Donell  <carlos@codesourcery.com>

	* Makefile.tpl: Add install-pdf to install target deps.
	* Makefile.in: Regenerate.

2007-05-10  Carlos O'Donell  <carlos@codesourcery.com>

	bfd/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am 
	and install-pdf-recursive targets. Define pdfdir.
	* doc/Makefile.am: Define pdf__strip_dir. Add
	install-pdf and install-pdf-am targets.
	* po/Make-in: Add install-pdf target. 
	* configure: Regenerate.
	* Makefile.in: Regenerate
	* doc/Makefile.in: Regenerate.

	binutils/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets.
	* doc/Makefile.am: Define pdf__strip_dir. Add
	install-pdf and install-pdf-am targets.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.
	* doc/Makefile.in: Regenerate.

	etc/
	* configure.in: ACSUBST pdfdir.
	* configure: Regenerate.

	opcodes/
	* Makefile.am: Add install-pdf target.
	* po/Make-in: Add install-pdf target.
	* Makefile.in: Regenerate.

	gas/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets.
	* doc/Makefile.am: Define pdf__strip_dir. Add
	install-pdf and install-pdf-am targets.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.
	* doc/Makefile.in: Regenerate.

	gprof/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets. Define pdf__strip_dir.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.

	ld/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets. Define pdf__strip_dir.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.

2007-05-10  Kazu Hirata  <kazu@codesourcery.com>

	Issue 1569
	Backport from mainline:
	bfd/
	2007-05-11  Alan Modra  <amodra@bigpond.net.au>
	PR 4454
	* elf-eh-frame.c (struct cie): Make "personality" a bfd_vma.
	(_bfd_elf_discard_section_eh_frame): Handle local syms on
	personality relocation.

2007-05-10  Nathan Sidwell  <nathan@codesourcery.com>

	* Makefile.tpl: Add install-pdf to install target deps.
	* Makefile.in: Regenerate.

2007-05-10  Carlos O'Donell  <carlos@codesourcery.com>

	bfd/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am 
	and install-pdf-recursive targets. Define pdfdir.
	* doc/Makefile.am: Define pdf__strip_dir. Add
	install-pdf and install-pdf-am targets.
	* po/Make-in: Add install-pdf target. 
	* configure: Regenerate.
	* Makefile.in: Regenerate
	* doc/Makefile.in: Regenerate.

	binutils/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets.
	* doc/Makefile.am: Define pdf__strip_dir. Add
	install-pdf and install-pdf-am targets.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.
	* doc/Makefile.in: Regenerate.

	etc/
	* configure.in: ACSUBST pdfdir.
	* configure: Regenerate.

	opcodes/
	* Makefile.am: Add install-pdf target.
	* po/Make-in: Add install-pdf target.
	* Makefile.in: Regenerate.

	gas/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets.
	* doc/Makefile.am: Define pdf__strip_dir. Add
	install-pdf and install-pdf-am targets.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.
	* doc/Makefile.in: Regenerate.

	gprof/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets. Define pdf__strip_dir.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.

	ld/
	* configure.in: ACSUBST pdfdir.
	* Makefile.am: Add install-pdf, install-pdf-am,
	and install-pdf-recursive targets. Define pdf__strip_dir.
	* po/Make-in: Add install-pdf target.
	* configure: Regenerate.
	* Makefile.in: Regenerate.

2007-05-10  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	bfd/
	2007-05-10  Richard Sandiford  <richard@codesourcery.com>

	* elf32-arm.c (elf32_arm_check_relocs): Don't create PLT entries
	for R_ARM_ABS12 relocs.
	(elf32_arm_finish_dynamic_symbol): Fix the loop that creates
	non-shared VxWorks PLT entries.

	ld/testsuite/
	2007-05-10  Richard Sandiford  <richard@codesourcery.com>

	* ld-arm/vxworks1-lib.dd: Expect "push" instead of stmdb and
	"pop" instead of ldmia.  Don't require specific symbolic addresses
	for in-text addresses.  Expect data to be rendered as .words rather
	than disassembled.
	* ld-arm/vxworks1.dd: Likewise.

2007-05-10  Richard Sandiford  <richard@codesourcery.com>

	Backport from mainline:

	bfd/
	2007-05-10  Richard Sandiford  <richard@codesourcery.com>

	* elf.c (assign_file_positions_for_load_sections): Use p_memsz
	rather than p_filesz to calculate the LMA of the end of a segment.

	ld/testsuite/
	2007-05-10  Richard Sandiford  <richard@codesourcery.com>

	* ld-elf/multibss1.d, ld-elf/multibss1.s: New test.

2007-05-10  Kazu Hirata  <kazu@codesourcery.com>

	Issue 1569
	Backport from mainline:
	bfd/
	2007-05-11  Alan Modra  <amodra@bigpond.net.au>
	PR 4454
	* elf-eh-frame.c (struct cie): Make "personality" a bfd_vma.
	(_bfd_elf_discard_section_eh_frame): Handle local syms on
	personality relocation.

2007-05-09  Nathan Sidwell  <nathan@codesourcery.com>

	* release-notes-csl.xml: Document fix.

	opcodes/
	* m68k-opc.c (m68k_opcodes): Add wdebugl variants.

2007-05-09  Kazu Hirata  <kazu@codesourcery.com>

	* release-notes-csl.xml: Insert a blank line before the first
	release note fragment.

2007-05-04  Mark Shinwell  <shinwell@codesourcery.com>

	* release-notes-csl.xml (ARM EABI compliance): New.

	gas/
	* config/te-armeabi.h (EABI_DEFAULT): Use EF_ARM_EABI_VER5.
	* config/te-armlinuxeabi.h (EABI_DEFAULT): Likewise.

2007-05-04  Kazu Hirata  <kazu@codesourcery.com>

	Backport from mainline:
	gas/testsuite/
	* gas/m68k/all.exp: Skip fmoveml on fido.

2007-05-04  Mark Shinwell  <shinwell@codesourcery.com>

	binutils/testsuite/
	* binutils-all/strip-3.d: Strip .ARM.attributes section.

2007-05-04  Mark Shinwell  <shinwell@codesourcery.com>

	Merge from Sourcery G++ binutils 2.17:

	2007-04-20  Mark Shinwell  <shinwell@codesourcery.com>

	* release-notes-csl.xml (Conditional Thumb-2 branch
	instructions): New.

	bfd/
	* elf32-arm.c (elf32_arm_final_link_relocate): Correctly
	handle the Thumb-2 JUMP19 relocation.

	ld/testsuite/
	* ld-arm/arm-elf.exp: Add jump19 testcase.
	* ld-arm/jump19.d: New.
	* ld-arm/jump19.s: New.

2007-05-04  Mark Shinwell  <shinwell@codesourcery.com>

	Merge from Sourcery G++ binutils 2.17:

	2007-04-20  Mark Shinwell  <shinwell@codesourcery.com>
 
	* release-notes-csl.xml (Linking of non-ELF images): New.

	bfd/
	* elf32-arm.c (bfd_elf32_arm_vfp11_erratum_scan): Don't
	attempt to scan if the bfd doesn't correspond to an ELF image.
	(bfd_elf32_arm_vfp11_fix_veneer_locations): Likewise.

2007-05-03  Mark Shinwell  <shinwell@codesourcery.com>

	Merge from Sourcery G++ binutils 2.17:

	2007-04-27  Mark Shinwell  <shinwell@codesourcery.com>

	gas/
	* config/tc-arm.c (md_apply_fix): Generate more accurate
	diagnostic when 8-bit immediate range is exceeded for
	BFD_RELOC_ARM_OFFSET_IMM8.

2007-05-03  Sandra Loosemore  <sandra@codesourcery.com>

	bfd/
	* elf32-arm.c (allocate_dynrelocs): Fix typo in comment.

2007-05-03  Paul Brook  <paul@codesourcery.com>

	Merge from CSL-2.17 branch.
	2007-04-17  Paul Brook  <paul@codesourcery.com>
	gas/
	* config/tc-arm.c (arm_ext_msr): New variable.
	(md_assemble): Allow v6-M 32-bit instructions without requiring
	Thumb-2.
	(insns): Use arm_ext_msr for Thumb MSR and MRS.
	(cpu_arch): Add V6M. Fix numbering of V6K and V6T2.
	gas/testsuite/
	* gas/arm/archv6m.d: New test.
	* gas/arm/archv6m.s: New test.
	include/opcode/
	* arm.h (ARM_EXT_THUMB_MSR): Define.
	(ARM_AEXT_V6T2, ARM_AEXT_V6M): Use it.

	2006-12-15  Paul Brook  <paul@codesourcery.com>
	gas/
	* config/tc-arm.c (arm_ext_barrier, arm_ext_m): New.
	(do_t_mrs): Use arm_ext_m.
	(insns): Allow dmb, dsb and isb on ARMv6-M.
	(arm_cpu_option_table): Add cortex-m1.
	(arm_arch_option_table): Add armv6-m.
	(aeabi_set_public_attributes): Use arm_ext_m.
	include/
	* opcode/arm.h (ARM_EXT_V6M, ARM_EXT_BARRIER, ARM_AEXT_V6M,
	ARM_ARCH_V6M): Define.
	(ARM_AEXT_V7_ARM, ARM_AEXT_V7M): Include ARM_EXT_BARRIER.

2007-04-27  Mark Shinwell  <shinwell@codesourcery.com>

	* release-notes-csl.xml (The \@ assembler pseudo-variable):
	New.

	gas/
	* app.c (do_scrub_chars): Don't damage \@ pseudo-variables.

	gas/testsuite/
	* gas/arm/backslash-at.d: New.
	* gas/arm/backslash-at.s: New.

2007-04-25  Mark Mitchell  <mark@codesourcery.com>

	libiberty/
	* cygpath.c (<process.h>): Include it.
	(cygpath_log): New variable.
	(cygpath_log_msg_arg): New function.
	(cygpath_log_msg): Likewise.
	(cygpath_perror): Likewise.
	(cygpath_close): Declare as prototyped function.  Close the log
	file.
	(cygpath): Log interaction with cygpath.  If cygpath dies
	unexpectedly, restart it.
	(set_errno_from_windows_code): Avoid signed/unsigned comparison.

2007-04-23  Joseph Myers  <joseph@codesourcery.com>

	Merge from Sourcery G++ binutils 2.17:

	2007-01-24  Joseph Myers  <joseph@codesourcery.com>
	bfd/
	* config.bfd (mips*el-*-linux*, mips*-*-linux*): Remove
	ecoff_little_vec and ecoff_big_vec.

2007-04-23  Sandra Loosemore  <sandra@codesourcery.com>

	* release-notes-csl.xml (Binutils update): New.

2007-04-23  Richard Sandiford  <richard@codesourcery.com>

	gas/testsuite/
	* gas/mips/ulh3.s, gas/mips/ulh3-el.d, gas/mips/ulh3-eb.d,
	* gas/mips/octeon1.s, gas/mips/octeon1.l, gas/mips/octeon2.s,
	* gas/mips/octeon2-un.d, gas/mips/octeon2-noun.d,
	* gas/mips/octeon2-mix.d, gas/mips/octeon3.s,
	* gas/mips/octeon3.d: New tests.
	* gas/mips/mips.exp: Run them.  Don't run ulh2 on mips32r2 targets.

2007-04-23  Richard Sandiford  <richard@codesourcery.com>

	Adapted from a patch by Cavium Networks.

	include/elf/
	* mips.h (E_MIPS_MACH_OCTEON): New macro.

	include/opcode/
	* mips.h: Document '^', ';' and 'y'.
	(OP_MASK_BITIND, OP_SH_BITIND): New macros.
	(INSN_OCTEON, CPU_OCTEON): Likewise.
	(OPCODE_IS_MEMBER): Handle CPU_OCTEON.

	bfd/
	* archures.c (bfd_mach_mips_octeon): Define.
	* bfd-in2.h: Regenerate.
	* cpu-mips.c (I_mipsocteon): Define.
	(arch_info_struct): Add a "mips:octeon" entry.
	* elfxx-mips.c (_bfd_elf_mips_mach): Handle E_MIPS_MACH_OCTEON.
	(mips_set_isa_flags): Handle bfd_mach_mips_octeon.
	(mips_mach_extensions): List bfd_mach_mips_octeon as an extension
	of bfd_mach_mipsisa64.

	binutils/
	* readelf.c (get_machine_flags): Handle E_MIPS_MACH_OCTEON.

	opcodes/
	* mips-dis.c (octeon_use_unalign): New variable.
	(mips_cp0_names_octeon, mips_cp0sel_names_octeon): New tables.
	(mips_arch_choices): Add an octeon entry.
	(parse_mips_dis_option): Handle octeon-useun and no-octeon-useun.
	(print_insn_args): Handle '^' and 'y'.
	(print_insn_mips): Skip aliases of uld, ulw, usd and usw when
	unaligned octeon instructions are allowed.  Print ldr, lwr,
	sdr and swr as nops in that case.
	(print_mips_disassembler_options): Print help for octeon-useun and
	no-octeon-useun.
	* mips-opc.c (IOCTEON): Define.
	(mips_builtin_opcodes): Add Octeon baddu, bbit032, bbit0, bbit132,
	bbit1, cins32, cins, dmul, dpop, exts32, exts, exts, mtm0, mtm1,
	mtm2, mtp0, mtp1, mtp2, pop, seq, seqi, sne, snei, syncio,
	synciobdma, syncioall, syncs, syncw, syncws, uld, ulw, usd, usw,
	v3mulu, vmm0, vmulu, dmfc2 and dmtc2 instructions.

	gas/
	* config/tc-mips.c (octeon_use_unalign): New variable.
	(ISA_HAS_INS): New macro.
	(CPU_HAS_DROR): Return true for CPU_OCTEON.
	(CPU_HAS_INS): New macro.
	(macro_build): Handle '^' and 'y'.
	(macro2): Try to use "ins" instead of "sll" and "or" in the
	implementation of ulh and ulhu.  Treat uld, ulw, usd and usw
	as normal stores if the Octeon unaligned instructions are allowed.
	(validate_mips_insn): Handle '^', ';' and 'y'.
	(mips_ip): Ignore the uld, ulw, usd and usw hardware instructions
	unless they have been enabled.  Refuse to assemble left/right stores
	when uld, ulw, usd and usw are enabled.  Handle '^', ';' and 'y'.
	(OPTION_OCTEON_UNALIGNED, OPTION_NO_OCTEON_UNALIGNED): New macros.
	(OPTION_ELF_BASE): Bump by two.
	(md_longopts): Add -mocteon-useun and -mno-octeon-useun.
	(md_parse_option): Handle them.
	(mips_cpu_info_table): Add an "octeon" entry.
	(md_show_usage): Mention -mocteon-useun and -mno-octeon-useun.

2007-04-22  Mark Shinwell  <shinwell@codesourcery.com>

	Merge from Sourcery G++ binutils 2.17:

	2007-02-02  Mark Shinwell  <shinwell@codesourcery.com>

	gas/
	* config/tc-arm.c (arm_ext_marvell_f): New.
	(do_marvell_div): New.
	(insns): Add entries for Marvell-specific sdiv and udiv encodings.
	(arm_cpu_option_table): Add marvell-f entry.
	(arm_arch_option_table): Add marvell-f entry.
	* include/opcode/arm.h (ARM_CEXT_MARVELL_F): New.
	(ARM_ARCH_MARVELL_F): New.
	
	gas/testsuite/
	* gas/arm/marvell-f-div.d: New.
	* gas/arm/marvell-f-div.s: New.

	2007-01-03  Mark Shinwell  <shinwell@codesourcery.com>

	NOT ASSIGNED TO FSF
	Port from Marvell compiler:
	gas/
	* config/tc-arm.c (arm_cpus): Add marvell-f entry.

2007-04-20  Nathan Sidwell  <nathan@codesourcery.com>

	gas/testsuite/
	* gas/m68k/br-isaa.s: New.
	* gas/m68k/br-isaa.d: New.
	* gas/m68k/br-isab.s: New.
	* gas/m68k/br-isab.d: New.
	* gas/m68k/br-isac.s: New.
	* gas/m68k/br-isac.d: New.
	* gas/m68k/all.exp: Adjust.

	gas/
	* config/tc-m68k.c (mcf54455_ctrl): New.
	(HAVE_LONG_DISP, HAVE_LONG_CALL, HAVE_LONG_COND): New.
	(m68k_archs): Add isac.
	(m68k_cpus): Add 54455 family.
	(m68k_ip): Split Bg into Bb, Bs, Bg.
	(m68k_elf_final_processing): Add ISA_C.
	* doc/c-m68k.texi (M680x0 Options): Add isac.

	include/opcode/
	* m68k.h (mcfisa_c): New.
	(mcfusp, mcf_mask): Adjust.

	bfd/
	* archures.c (bfd_mach_mcf_isa_c, bfd_mach_mcf_isa_c_mac,
	bfd_mach_mcf_isa_c_emac): New.
	* elf32-m68k.c (ISAC_PLT_ENTRY_SIZE, elf_isac_plt0_entry,
	elf_isac_plt_entry, elf_isac_plt_info): New.
	(elf32_m68k_object_p): Add ISA_C.
	(elf32_m68k_print_private_bfd_data): Print ISA_C.
	(elf32_m68k_get_plt_info): Detect ISA_C.
	* cpu-m68k.c (arch_info): Add ISAC.
	(m68k_arch_features): Likewise,
	(bfd_m68k_compatible): ISAs B & C are not compatible.

	opcodes/
	* m68k-opc.c: Mark mcfisa_c instructions.

2007-04-20  Joseph Myers  <joseph@codesourcery.com>

	Merge from Sourcery G++ binutils 2.17:

	2007-03-20  Joseph Myers  <joseph@codesourcery.com>
	Based on patch by Mark Hatle <mark.hatle@windriver.com>.
	ld/
	* configure.in (--enable-poison-system-directories): New option.
	* configure, config.in: Regenerate.
	* ldfile.c (ldfile_add_library_path): If
	ENABLE_POISON_SYSTEM_DIRECTORIES defined, warn for use of /lib,
	/usr/lib, /usr/local/lib or /usr/X11R6/lib.

	Merge from Sourcery G++ binutils 2.17:

	2007-03-22  Julian Brown  <julian@codesourcery.com>
	bfd/
	* elf32-arm.c (bfd_elf32_arm_set_vfp11_fix): Default to fixing for
	scalar code on pre-ARMv7.
	ld/
	* ld.texinfo: Document this default.

	Merge from Sourcery G++ binutils 2.17:

	2007-03-23  Richard Sandiford  <richard@codesourcery.com>
	bfd/
	From Phil Edwards <phil@codesourcery.com>:
	* cache.c (bfd_cache_delete): Work around ClearCase bug.

	Merge from Sourcery G++ binutils 2.17:

	2006-04-12  Carlos O'Donell  <carlos@codesourcery.com>
	* Makefile.tpl: Add install-html to install target deps.
	* Makefile.in: Regenerate.

2007-04-20  Mark Mitchell  <mark@codesourcery.com>
            Vladimir Prus  <vladimir@codesourcery.com>
            Carlos O'Donell  <carlos@codesourcery.com>
            Joseph Myers  <joseph@codesourcery.com>

	libiberty/
	* configure.ac: Add cygpath for mingw hosts.
	* configure: Rebuilt.
	* Makefile.in: Add cygpath.
	* cygpath.c: New.

2007-04-20  Joseph Myers  <joseph@codesourcery.com>

	Merge from Sourcery G++ binutils 2.17:

	2007-03-01  Joseph Myers  <joseph@codesourcery.com>
	gas/
	* configure.in (mips64el-sicortex-linux-gnu): Set
	mips_default_abi=N64_ABI.
	* configure: Regenerate.

	2007-02-20  Carlos O'Donell  <carlos@codesourcery.com>
	Issue #1271
	ld/
	* configure.tgt (mips64el-sicortex-linux-gnu): Set targ_emul to
	elf64ltsmip, and set targ_extra_emuls appropriately.

2007-04-20  Nathan Sidwell  <nathan@codesourcery.com>

	gas/
	* config/tc-m68k.c (mcf5253_ctrl): New.
	(mcf52223_ctrl): New.
	(m68k_cpus): Add 5253, 52221, 52223.

	gas/
	* config/m68k-parse.h (RAMBAR_ALT): New.
	* config/tc-m68k.c (mcf5206_ctrl, mcf5307_ctrl): New.
	(mcf_ctrl, mcf5208_ctrl, mcf5210a_ctrl, mcf5213_ctrl, mcf52235_ctrl,
	mcf5225_ctrl, mcf5235_ctrl, mcf5271_ctrl, mcf5275_ctrl,
	mcf5282_ctrl, mcf5329_ctrl, mcf5373_ctrl, mcfv4e_ctrl,
	mcf5475_ctrl, mcf5485_ctrl): Add RAMBAR synonym for
	RAMBAR1.
	(mcf5272_ctrl): Add RAMBAR0, replace add RAMBAR with RAMBAR_ALT.
	(m68k_cpus): Adjust 5206, 5206e & 5307 entries.
	(m68k_ip) <Case J>: Detect when RAMBAR_ALT should be used.  Add it
	to control register mapping.

	gas/testsuite/
	* gas/m68k/ctrl-1.d, gas/m68k/ctrl-1.s: New.
	* gas/m68k/ctrl-2.d, gas/m68k/ctrl-2.s: New.
	* gas/m68k/all.exp: Add them.

	opcodes/
	* m68k-dis.c (print_insn_arg): Show c04 as rambar0 and c05 as
	rambar1.


Local Variables:
mode: change-log
change-log-default-name: "ChangeLog.csl"
End:
